"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[619],{2068:function(e,n,o){o.d(n,{A:function(){return s}});var a=o(7165),t=o(7414);async function s(e,n,o){try{try{e=(0,t.l)(e,"CA").number,console.log("phoneNum: ",e)}catch(s){return{message:"Invalid phone number"}}const r="",u=await fetch(`${r}/api/authentication/log_in`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_num:e,password:n,remember_me:o})}),i=await u.json();if(u.ok){const e=(0,a.je)();return e.setMyProfile({token:i.token,role:i.user_role}),!0}return console.log("Failed to log in, message: ",i.message),{message:i.message}}catch(s){return console.error("Unexpected Error: ",s),{message:"Unexpected Error"}}}},7619:function(e,n,o){o.r(n),o.d(n,{default:function(){return E}});var a=o(6768),t=o(144),s=o(5130),r=o(4232),u=o(7414);async function i(e){try{e=(0,u.l)(e,"CA").number;const n="",o=await fetch(`${n}/api/authentication/request_forgot_password`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_num:e})}),a=await o.json(),t=a.code_id,s=a.wait_time,r=a.message;return{codeId:t,message:r,waitTime:s}}catch(n){return console.error("Unexpected Error: ",n),{message:"Unexpected Error"}}}const l={id:"msg"};var d={__name:"PhoneNumInput",props:{onNext:Function},setup(e){const n=e,o=(0,t.KR)(""),u=(0,t.KR)(""),d=(0,t.KR)("");async function c(){const{codeId:e,message:a,waitTime:t}=await i(o.value);e?n.onNext(e,o.value,u.value,t):d.value=a}return(e,n)=>((0,a.uX)(),(0,a.CE)("form",{onSubmit:(0,s.D$)(c,["prevent"])},[(0,a.Lk)("div",null,[(0,a.bo)((0,a.Lk)("input",{type:"tel","onUpdate:modelValue":n[0]||(n[0]=e=>o.value=e),placeholder:"Phone Number",required:""},null,512),[[s.Jo,o.value]])]),(0,a.Lk)("div",null,[(0,a.bo)((0,a.Lk)("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=e=>u.value=e),placeholder:"New Password",required:""},null,512),[[s.Jo,u.value]])]),(0,a.Lk)("div",l,(0,r.v_)(d.value),1),n[2]||(n[2]=(0,a.Lk)("button",{class:"greenBtn"},"Renew Password",-1))],32))}},c=o(1241);const p=(0,c.A)(d,[["__scopeId","data-v-309d18a4"]]);var v=p,m=(o(4114),o(1387)),w=o(2068);async function h(e,n,o,a){try{const t="",s=await fetch(`${t}/api/authentication/renew_password`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({code_id:e,code:n,password:a})});if(!s.ok){const e=await s.json();return console.log("Failed to renew password, message: ",e.message),e.message}await(0,w.A)(o,a)}catch(t){return console.error("Unexpected Error: ",t),t.message}}const f={id:"msg"},g={key:0,class:"disabled"};var y={__name:"OTPverify",props:{codeId:Number,phoneNum:String,password:String,waitTime:Number},setup(e){const n=e,o=(0,t.KR)(n.codeId),u=(0,t.KR)(""),l=(0,t.KR)(""),d=(0,m.rd)(),c=(0,t.KR)(n.waitTime);async function p(){const e=await h(o.value,u.value,n.phoneNum,n.password);if(e)return l.value=e,void(u.value="");d.push("/")}async function v(){const{codeId:e,message:a,waitTime:t}=await i(n.phoneNum);console.log(e),e?(o.value=e,c.value=t):l.value=a}let w;return(0,a.sV)((()=>{w=setInterval((()=>{c.value--}),1e3)})),(0,a.hi)((()=>{clearInterval(w)})),(n,o)=>((0,a.uX)(),(0,a.CE)("form",{onSubmit:(0,s.D$)(p,["prevent"])},[(0,a.Lk)("div",null,"Please enter the one time code sent to "+(0,r.v_)(e.phoneNum),1),(0,a.Lk)("div",null,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e),placeholder:"Verification Code"},null,512),[[s.Jo,u.value]])]),(0,a.Lk)("div",f,(0,r.v_)(l.value),1),o[1]||(o[1]=(0,a.Lk)("button",{class:"greenBtn"},"Verify",-1)),c.value>0?((0,a.uX)(),(0,a.CE)("a",g," Resend Code (Wait "+(0,r.v_)(c.value)+"s)",1)):((0,a.uX)(),(0,a.CE)("a",{key:1,onClick:v}," Resend Code "))],32))}};const _=(0,c.A)(y,[["__scopeId","data-v-3e39b502"]]);var b=_;const k={id:"layout"},C={key:0},N={key:1},R={};var I=Object.assign(R,{__name:"ForgotPassword",setup(e){const n=(0,t.KR)(1),o=(0,t.KR)(),s=(0,t.KR)(""),r=(0,t.KR)(""),u=(0,t.KR)(0);function i(e,a,t,i){o.value=e,s.value=a,r.value=t,u.value=i,n.value++}return(e,t)=>((0,a.uX)(),(0,a.CE)("div",k,[t[0]||(t[0]=(0,a.Lk)("div",{id:"title"},"Forgot password",-1)),1===n.value?((0,a.uX)(),(0,a.CE)("div",C,[(0,a.bF)(v,{onNext:i})])):(0,a.Q3)("",!0),2===n.value?((0,a.uX)(),(0,a.CE)("div",N,[(0,a.bF)(b,{codeId:o.value,phoneNum:s.value,password:r.value,waitTime:u.value},null,8,["codeId","phoneNum","password","waitTime"])])):(0,a.Q3)("",!0)]))}});const T=(0,c.A)(I,[["__scopeId","data-v-7452bfcf"]]);var E=T}}]);
//# sourceMappingURL=619.7b1206db.js.map