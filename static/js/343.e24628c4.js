"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[343],{4714:function(n,e,o){function t(n){if("+1"!==n.slice(0,2))return n;if(console.log("calling"),!n)return;let e="";return n=n.slice(2),e=n.length<=3?n:n.length<=6?`${n.slice(0,3)} ${n.slice(3)}`:`${n.slice(0,3)} ${n.slice(3,6)} ${n.slice(6)}`,e}o.d(e,{A:function(){return t}})},6769:function(n,e,o){o.d(e,{A:function(){return r}});var t=o(4116);function r(n){return console.log("calling"),t.c9.fromObject({hour:0}).plus({seconds:n}).toFormat("h:mm a")}},3519:function(n,e,o){o.d(e,{A:function(){return r}});var t=o(4116);function r(n){if(console.log("calling"),!n)return;const e=t.c9.fromSeconds(n).startOf("day"),o=t.c9.local().startOf("day"),r=e.diff(o,"days").toObject(),a=Math.round(r.days);if(e.equals(o))return"Today";if(1===a)return"Tomorrow";if(-1===a)return"Yesterday";const l=a>0?"next":"last";return Math.abs(a)>=30?`${l} ${Math.abs(Math.round(a/30))}m`:Math.abs(a)>=7?`${l} ${Math.abs(Math.round(a/7))}w`:`${l} ${Math.abs(a)}d`}},1076:function(n,e,o){o.d(e,{A:function(){return a}});var t=o(4116),r=o(6156);function a(n){if(console.log("calling"),!n)return;const e=t.c9.fromMillis(1e3*n).setZone((0,r.A)());return e.toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}},6916:function(n,e,o){o.d(e,{A:function(){return a}});var t=o(8199),r=o(7414);async function a(n,e){try{try{n=(0,r.l)(n,"CA").number,console.log("phoneNum: ",n)}catch(o){throw new Error("Invalid Phone Number")}const a="",l=await fetch(`${a}/api/users/ban_unban_phone_number`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_num:n,boolean:e})});if(l.ok)return!0;{const n=await l.json();(0,t.A)(n.message),console.log("Failed to ban/unban phone number, message: ",n.message)}}catch(o){console.error("Unexpected Error: ",o)}}},7343:function(n,e,o){o.r(e),o.d(e,{default:function(){return nn}});var t=o(6768);function r(n,e,o,r,a,l){const s=(0,t.g2)("UserInfo"),u=(0,t.g2)("UserAppos");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(s,{info:r.info},null,8,["info"]),(0,t.bF)(u,{name:r.info.firstName,appos:r.appos},null,8,["name","appos"])],64)}o(4114);var a=o(8199);async function l(n){try{const e="",o=await fetch(`${e}/api/users/get_user_details/${n}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await o.json();if(o.ok){const[e,o,r,a,l,s,u,i]=t.info,c={role:e,birth:o,phoneNum:r,firstName:a,lastName:l,notes:s,contactName:u,bannedOn:i,userId:n},d=[],p=t.appos;for(let n of p){const[e,o,t,r,a,l,s,u,i,c]=n,p={appoId:e,empId:o,empAlias:t,color:r,serviceId:a,serviceName:l,category:s,date:u,start:i,end:c};d.push(p)}return{info:c,appos:d}}(0,a.A)(t.message),console.log("Failed to fetch users, message: ",t.message)}catch(e){console.error("Unexpected Error: ",e)}}var s=o(1387),u=o(144),i=o(4232);const c={colspan:"2"},d={id:"title"};function p(n,e,o,r,a,l){const s=(0,t.g2)("Drawer");return(0,t.uX)(),(0,t.CE)("table",null,[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",c,[(0,t.Lk)("div",d,[(0,t.Lk)("div",null,(0,i.v_)(o.info.firstName)+" "+(0,i.v_)(o.info.lastName),1),(0,t.Lk)("div",null,[(0,t.bF)(s,{name:o.info.firstName,userId:o.info.userId,phoneNum:o.info.phoneNum,bannedOn:o.info.bannedOn},null,8,["name","userId","phoneNum","bannedOn"])])])])]),(0,t.Lk)("tr",null,[e[0]||(e[0]=(0,t.Lk)("th",null,"Client Name:",-1)),(0,t.Lk)("td",null,(0,i.v_)(o.info.contactName),1)]),(0,t.Lk)("tr",null,[e[1]||(e[1]=(0,t.Lk)("th",null,"Phone Number:",-1)),(0,t.Lk)("td",null,(0,i.v_)(r.formatPhone(o.info.phoneNum)),1)]),(0,t.Lk)("tr",null,[e[2]||(e[2]=(0,t.Lk)("th",null,"Joined on:",-1)),(0,t.Lk)("td",null,(0,i.v_)(r.unixToReadable(o.info.birth)),1)]),(0,t.Lk)("tr",null,[e[3]||(e[3]=(0,t.Lk)("th",null,"Role:",-1)),(0,t.Lk)("td",null,(0,i.v_)(o.info.role),1)]),(0,t.Lk)("tr",null,[e[4]||(e[4]=(0,t.Lk)("th",null,"Note:",-1)),(0,t.Lk)("td",null,(0,i.v_)(o.info.notes),1)])])])}var m=o(1076),f=o(4714);const h={id:"relative"};function b(n,e,o,r,a,l){const s=(0,t.g2)("FontAwesomeIcon"),u=(0,t.g2)("Drawer"),i=(0,t.g2)("ChangeUserRole");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",h,[(0,t.Lk)("button",{onClick:e[0]||(e[0]=(...n)=>r.onToogleDrawer&&r.onToogleDrawer(...n))},[(0,t.bF)(s,{icon:r.faCaretDown},null,8,["icon"])]),r.isDrawerOpen?((0,t.uX)(),(0,t.Wv)(u,{key:0,onToogleDrawer:r.onToogleDrawer,phoneNum:o.phoneNum,bannedOn:o.bannedOn,onChangeRole:r.onChangeRole},null,8,["onToogleDrawer","phoneNum","bannedOn","onChangeRole"])):(0,t.Q3)("",!0)]),r.isChangingRole?((0,t.uX)(),(0,t.Wv)(i,{key:0,name:o.name,userId:o.userId,onCancel:()=>r.onChangeRole(!1)},null,8,["name","userId","onCancel"])):(0,t.Q3)("",!0)],64)}var v=o(8249),g=o(2353);function k(n,e,o,r,a,l){return(0,t.uX)(),(0,t.CE)("div",{id:"drawer",ref:"drawer",onBlur:e[3]||(e[3]=(...n)=>r.onBlur&&r.onBlur(...n)),tabindex:"0"},[(0,t.Lk)("button",{onClick:e[0]||(e[0]=(...n)=>o.onChangeRole&&o.onChangeRole(...n))},"Change user's role"),null==o.bannedOn?((0,t.uX)(),(0,t.CE)("button",{key:0,style:{color:"red"},onClick:e[1]||(e[1]=(...n)=>r.onBanUnban&&r.onBanUnban(...n))}," Ban this account ")):((0,t.uX)(),(0,t.CE)("button",{key:1,style:{color:"green"},onClick:e[2]||(e[2]=(...n)=>r.onBanUnban&&r.onBanUnban(...n))}," Unban this account "))],544)}var C=o(6916),L={name:"Drawer-",props:{onToogleDrawer:Function,phoneNum:String,bannedOn:Number,onChangeRole:Function},setup(n){const e=(0,s.rd)(),o=(0,u.KR)(null),r=e=>{const t=e.relatedTarget;t&&o.value.contains(t)?o.value.focus():n.onToogleDrawer()},a=async()=>{const o=await(0,C.A)(n.phoneNum,null==n.bannedOn);o&&e.push("/refresh")};return(0,t.sV)((()=>{o.value.focus()})),{drawer:o,onBlur:r,onBanUnban:a}}},y=o(1241);const w=(0,y.A)(L,[["render",k],["__scopeId","data-v-66451e6e"]]);var A=w,_=o(5130);async function N(n,e){try{const o="",t=await fetch(`${o}/api/users/update_user_role`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:n,role:e})});if(t.ok)return!0;{const n=await t.json();(0,a.A)(n.message),console.log("Failed to change user's role, message: ",n.message)}}catch(o){console.error("Unexpected Error: ",o)}}const T={id:"parent"},R={id:"window"},I={id:"content"},O={id:"title"},D={};var E=Object.assign(D,{__name:"ChangeUserRole",props:{onCancel:Function,name:String,userId:Number},setup(n){const e=(0,s.rd)(),o=n,r=(0,u.KR)(null);async function a(){const n=await N(o.userId,r.value);n&&e.push("/refresh")}return(e,l)=>((0,t.uX)(),(0,t.CE)("div",T,[(0,t.Lk)("div",{id:"background",onClick:l[0]||(l[0]=(...e)=>n.onCancel&&n.onCancel(...e))}),(0,t.Lk)("div",R,[(0,t.Lk)("button",{onClick:l[1]||(l[1]=(...n)=>o.onCancel&&o.onCancel(...n)),id:"closeBtn",class:"redBtn"},[(0,t.bF)((0,u.R1)(v.gc),{icon:(0,u.R1)(g.Jyw)},null,8,["icon"])]),(0,t.Lk)("div",I,[(0,t.Lk)("form",{onSubmit:(0,_.D$)(a,["prevent"])},[(0,t.Lk)("div",O,"Select "+(0,i.v_)(n.name)+"'s new role",1),(0,t.Lk)("div",null,[(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":l[2]||(l[2]=n=>r.value=n),required:""},l[3]||(l[3]=[(0,t.Lk)("option",{value:"client"},"Client",-1),(0,t.Lk)("option",{value:"admin"},"Admin",-1)]),512),[[_.u1,r.value]])]),l[4]||(l[4]=(0,t.Lk)("button",{id:"confirm",class:"blueBtn"},"Confirm",-1))],32)])])]))}});const F=(0,y.A)(E,[["__scopeId","data-v-46b4f8db"]]);var U=F,$={name:"DrawerParent",props:{onEditName:Function,phoneNum:String,bannedOn:Number,name:String,userId:Number},components:{Drawer:A,FontAwesomeIcon:v.gc,ChangeUserRole:U},setup(){const n=(0,u.KR)(!1),e=(0,u.KR)(!1),o=async()=>{n.value=!n.value},t=(n=!0)=>{e.value=n};return{isDrawerOpen:n,onToogleDrawer:o,faCaretDown:g.xBV,isChangingRole:e,onChangeRole:t}}};const B=(0,y.A)($,[["render",b],["__scopeId","data-v-5661f5ca"]]);var S=B,x={props:{info:Object},components:{Drawer:S},setup(){return{unixToReadable:m.A,formatPhone:f.A}}};const X=(0,y.A)(x,[["render",p],["__scopeId","data-v-49bf25e6"]]);var j=X;const K={id:"title"},M={key:0},P=["onClick"],W={class:"cate"};function J(n,e,o,r,a,l){return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("div",K,(0,i.v_)(o.name)+"'s Appointments",1),(0,t.Lk)("table",null,[(0,t.Lk)("tbody",null,[e[1]||(e[1]=(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"Service"),(0,t.Lk)("th",null,"Employee"),(0,t.Lk)("th",null,"Date & Time")],-1)),0===r.futureAppos.length?((0,t.uX)(),(0,t.CE)("tr",M,e[0]||(e[0]=[(0,t.Lk)("td",{colspan:"3",style:{"text-align":"center"}}," No upcomming appointments ",-1)]))):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.futureAppos,((n,e)=>((0,t.uX)(),(0,t.CE)("tr",{class:"row",key:e,onClick:e=>r.toAppoDetails(n.date,n.appoId)},[(0,t.Lk)("td",null,[(0,t.eW)((0,i.v_)(n.serviceName)+" ",1),(0,t.Lk)("div",W,(0,i.v_)(n.category),1)]),(0,t.Lk)("td",{style:(0,i.Tr)({color:n.color})},(0,i.v_)(n.empAlias),5),(0,t.Lk)("td",null,[(0,t.Lk)("div",null,(0,i.v_)(r.unixToReadable(n.date))+" ("+(0,i.v_)(r.unixTimeToReminder(n.date))+") ",1),(0,t.eW)(" "+(0,i.v_)(r.secsToHours(n.start))+" - "+(0,i.v_)(r.secsToHours(n.end)),1)])],8,P)))),128))])])],64)}o(8992),o(4520);var V=o(3519),q=o(6769),H=o(445),Q={props:{appos:Array,name:String},setup(n){const e=(0,s.rd)(),o=(0,H.A)(),r=(n,o)=>{e.push(`/calendar/${n}/${o}`)},a=(0,t.EW)((()=>n.appos.filter((n=>n.date>=o))));return{today:o,unixTimeToReminder:V.A,unixToReadable:m.A,secsToHours:q.A,toAppoDetails:r,futureAppos:a}}};const G=(0,y.A)(Q,[["render",J],["__scopeId","data-v-18b35e07"]]);var Y=G,Z={name:"User-",components:{UserInfo:j,UserAppos:Y},setup(){const n=(0,s.lq)(),e=(0,u.KR)({}),o=(0,u.KR)([]);return(0,t.sV)((async()=>{const t=Number(n.params.userId),r=await l(t);e.value=r.info,o.value=r.appos})),{info:e,appos:o}}};const z=(0,y.A)(Z,[["render",r]]);var nn=z}}]);
//# sourceMappingURL=343.e24628c4.js.map