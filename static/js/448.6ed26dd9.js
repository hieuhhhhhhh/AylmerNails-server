"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[448],{4714:function(e,n,t){function o(e){if("+1"!==e.slice(0,2))return e;if(console.log("calling"),!e)return;let n="";return e=e.slice(2),n=e.length<=3?e:e.length<=6?`${e.slice(0,3)} ${e.slice(3)}`:`${e.slice(0,3)} ${e.slice(3,6)} ${e.slice(6)}`,n}t.d(n,{A:function(){return o}})},3519:function(e,n,t){t.d(n,{A:function(){return a}});var o=t(4116);function a(e){if(console.log("calling"),!e)return;const n=o.c9.fromSeconds(e).startOf("day"),t=o.c9.local().startOf("day"),a=n.diff(t,"days").toObject(),l=Math.round(a.days);if(n.equals(t))return"Today";if(1===l)return"Tomorrow";if(-1===l)return"Yesterday";const r=l>0?"next":"last";return Math.abs(l)>=30?`${r} ${Math.abs(Math.round(l/30))}m`:Math.abs(l)>=7?`${r} ${Math.abs(Math.round(l/7))}w`:`${r} ${Math.abs(l)}d`}},1076:function(e,n,t){t.d(n,{A:function(){return l}});var o=t(4116),a=t(6156);function l(e){if(console.log("calling"),!e)return;const n=o.c9.fromMillis(1e3*e).setZone((0,a.A)());return n.toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}},8067:function(e,n,t){t.r(n),t.d(n,{default:function(){return R}});var o=t(6768),a=t(5130),l=t(4232);const r={id:"topBox"},u={class:"flex"};function s(e,n,t,s,c,i){const d=(0,o.g2)("AddClientBtn");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",r,[(0,o.bo)((0,o.Lk)("input",{id:"search",type:"text",placeholder:"Search...","onUpdate:modelValue":n[0]||(n[0]=e=>s.query=e),onInput:n[1]||(n[1]=(...e)=>s.onSearch&&s.onSearch(...e))},null,544),[[a.Jo,s.query]]),(0,o.Lk)("div",null,[(0,o.bF)(d)])]),(0,o.Lk)("table",null,[(0,o.Lk)("tbody",null,[n[3]||(n[3]=(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Phone Number"),(0,o.Lk)("th",null,"Client Name"),(0,o.Lk)("th",null,"Account Name"),(0,o.Lk)("th",null,"Last Used")],-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.rows,((e,n)=>((0,o.uX)(),(0,o.CE)("tr",{class:"row",key:n},[(0,o.Lk)("td",null,(0,l.v_)(s.formatPhone(e.phoneNum)),1),(0,o.Lk)("td",null,(0,l.v_)(e.name),1),(0,o.Lk)("td",null,(0,l.v_)(e.firstName)+" "+(0,l.v_)(e.lastName),1),(0,o.Lk)("td",null,[(0,o.eW)((0,l.v_)(s.unixTimeToReminder(e.lastUsed))+" ",1),(0,o.Lk)("div",null,(0,l.v_)(s.unixToReadable(e.lastUsed)),1)])])))),128))])]),(0,o.Lk)("div",u,[s.rows?.length===s.limit?((0,o.uX)(),(0,o.CE)("button",{key:0,id:"show",class:"blueBtn",onClick:n[2]||(n[2]=(...e)=>s.showMore&&s.showMore(...e))}," showMore ")):(0,o.Q3)("",!0)])],64)}var c=t(144),i=t(4714),d=t(3519),h=t(1076),m=t(445),p=(t(4114),t(8199));async function f(e,n){try{const t="",o=await fetch(`${t}/api/appointments/search_contacts`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e.trim(),limit:n})}),a=await o.json();if(o.ok){let e=[];const n=a.contacts;for(let t of n){const[n,,o,a,l,r]=t,u={phoneNum:n,name:o,lastUsed:a,firstName:l,lastName:r};e.push(u)}return e}(0,p.A)(a.message),console.log("Failed to search contacts, message: ",a.message)}catch(t){console.error("Unexpected Error: ",t)}}var k=t(8249),v=t(2353),y=t(7414);async function b(e,n){try{try{e=(0,y.l)(e,"CA").number,console.log("phoneNum: ",e)}catch(t){return void(0,p.A)("Invalid Phone Number")}const o="",a=await fetch(`${o}/api/appointments/update_contact`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNum:e,name:n})}),l=await a.json();if(a.ok)return l.contactId;(0,p.A)(l.message),console.log("Failed to update contact, message: ",l.message)}catch(t){console.error("Unexpected Error: ",t)}}var L=t(1387);const g={key:0,id:"parent"},w={id:"content"},A={};var C=Object.assign(A,{__name:"AddClientBtn",setup(e){const n=(0,L.rd)(),t=(0,c.KR)(""),l=(0,c.KR)(""),r=(0,c.KR)(!1);function u(){r.value=!1}function s(){r.value=!0}async function i(){const e="+1"+t.value.replace(/\D/g,""),o=await b(e,l.value);o&&n.push("/refresh")}return(e,n)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("button",{id:"unsave",class:"greenBtn",onClick:s},[(0,o.bF)((0,c.R1)(k.gc),{icon:(0,c.R1)(v.hpd)},null,8,["icon"]),n[2]||(n[2]=(0,o.eW)(" Add / Update Client "))]),r.value?((0,o.uX)(),(0,o.CE)("div",g,[(0,o.Lk)("div",{id:"background",onClick:u}),(0,o.Lk)("form",{onSubmit:(0,a.D$)(i,["prevent"]),id:"window"},[(0,o.Lk)("button",{type:"button",onClick:u,id:"closeBtn",class:"redBtn"}," X "),(0,o.Lk)("div",w,[(0,o.Lk)("label",null,[n[3]||(n[3]=(0,o.eW)(" Phone Number ")),(0,o.bo)((0,o.Lk)("input",{type:"tel",placeholder:"Enter Phone Number","onUpdate:modelValue":n[0]||(n[0]=e=>t.value=e),required:""},null,512),[[a.Jo,t.value]])]),(0,o.Lk)("label",null,[n[4]||(n[4]=(0,o.eW)(" Name ")),n[5]||(n[5]=(0,o.Lk)("div",null,null,-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",placeholder:"Enter Name","onUpdate:modelValue":n[1]||(n[1]=e=>l.value=e),required:""},null,512),[[a.Jo,l.value]])])]),n[6]||(n[6]=(0,o.Lk)("div",{id:"flexBox"},[(0,o.Lk)("button",{class:"greenBtn"},"Add / Update")],-1))],32)])):(0,o.Q3)("",!0)],64))}}),N=t(1241);const $=(0,N.A)(C,[["__scopeId","data-v-578c9fe7"]]);var _=$,x={name:"CanceledAppos",components:{AddClientBtn:_},setup(){const e=(0,c.KR)(""),n=(0,c.KR)([]),t=(0,c.KR)(25),a=(0,m.A)(),l=async()=>{n.value=await f(e.value,t.value)},r=async()=>{t.value+=25,await l()};return(0,o.sV)((async()=>{await l()})),{today:a,query:e,rows:n,formatPhone:i.A,onSearch:l,unixTimeToReminder:d.A,unixToReadable:h.A,showMore:r,limit:t}}};const M=(0,N.A)(x,[["render",s],["__scopeId","data-v-b3f0449c"]]);var R=M}}]);
//# sourceMappingURL=448.6ed26dd9.js.map