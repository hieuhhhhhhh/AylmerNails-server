{"version":3,"file":"js/364.d9c8c190.js","mappings":"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","sources":["webpack://frontend/./src/lib/formatPhone.js","webpack://frontend/./src/lib/unixToReadable.js","webpack://frontend/./src/views/users/Users.vue","webpack://frontend/./src/views/users/apis/searchUsers.js","webpack://frontend/./src/views/users/apis/fetchLastTracked.js","webpack://frontend/./src/views/users/Users.vue?969b"],"sourcesContent":["export default function formatPhone(rawPhone) {\r\n  if (rawPhone.slice(0, 2) !== \"+1\") return rawPhone;\r\n  console.log(\"calling\");\r\n  if (!rawPhone) return;\r\n  let formatted = \"\";\r\n\r\n  rawPhone = rawPhone.slice(2);\r\n\r\n  if (rawPhone.length <= 3) {\r\n    formatted = rawPhone;\r\n  } else if (rawPhone.length <= 6) {\r\n    formatted = `${rawPhone.slice(0, 3)} ${rawPhone.slice(3)}`;\r\n  } else {\r\n    formatted = `${rawPhone.slice(0, 3)} ${rawPhone.slice(\r\n      3,\r\n      6\r\n    )} ${rawPhone.slice(6)}`;\r\n  }\r\n\r\n  // return result\r\n  return formatted;\r\n}\r\n","import { DateTime } from \"luxon\";\r\nimport getTimezone from \"./getTimeZone\";\r\n\r\nexport default function unixToReadable(unixTimestamp) {\r\n  console.log(\"calling\");\r\n\r\n  if (!unixTimestamp) {\r\n    return;\r\n  }\r\n\r\n  // Convert the Unix timestamp to a Luxon DateTime object in the specified timezone\r\n  const dateTime = DateTime.fromMillis(unixTimestamp * 1000).setZone(\r\n    getTimezone()\r\n  );\r\n\r\n  // Format the date with short weekday and month (e.g., \"Mon, Jan 20, 2025\")\r\n  return dateTime.toLocaleString({\r\n    weekday: \"short\",\r\n    month: \"short\",\r\n    day: \"numeric\",\r\n    year: \"numeric\",\r\n  });\r\n}\r\n","<template>\r\n  <input\r\n    type=\"text\"\r\n    id=\"search\"\r\n    placeholder=\"Search...\"\r\n    v-model=\"query\"\r\n    @input=\"onSearchUsers\"\r\n  />\r\n  <table>\r\n    <tbody>\r\n      <tr>\r\n        <th class=\"newCol\"></th>\r\n        <th>Account Name</th>\r\n        <th>Phone Number</th>\r\n        <th>Role</th>\r\n        <th>Client Name</th>\r\n        <th>Joined on</th>\r\n      </tr>\r\n      <tr\r\n        class=\"row\"\r\n        v-for=\"(user, index) in users\"\r\n        :key=\"index\"\r\n        @click=\"toUser(user.userId)\"\r\n      >\r\n        <td class=\"newCol\">\r\n          <div class=\"flexBox\">\r\n            <div class=\"newCell\" v-if=\"user.joinedOn > lastTracked\">NEW</div>\r\n            <div class=\"todayCell\" v-if=\"user.joinedOn >= today\">TODAY</div>\r\n          </div>\r\n        </td>\r\n\r\n        <td>{{ user.firstName }} {{ user.lastName }}</td>\r\n        <td>{{ formatPhone(user.phoneNum) }}</td>\r\n        <td>{{ user.role }}</td>\r\n        <td>{{ user.contactName }}</td>\r\n        <td>{{ unixToReadable(user.joinedOn) }}</td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n  <div class=\"flex\">\r\n    <button\r\n      id=\"show\"\r\n      class=\"blueBtn\"\r\n      v-if=\"users?.length === limit\"\r\n      @click=\"showMore\"\r\n    >\r\n      showMore\r\n    </button>\r\n  </div>\r\n</template>\r\n<script>\r\n// lib\r\nimport { onMounted, ref } from \"vue\";\r\nimport unixToReadable from \"@/lib/unixToReadable\";\r\nimport formatPhone from \"@/lib/formatPhone\";\r\nimport { onBeforeRouteLeave, useRouter } from \"vue-router\";\r\nimport searchUsers from \"./apis/searchUsers\";\r\nimport fetchLastTracked from \"./apis/fetchLastTracked\";\r\nimport { fetchNewUserCount } from \"@/components/view-shell/drawer-navigation/apis/connectSocket\";\r\nimport getTodayUnixTime from \"@/lib/getTodayUnixTime\";\r\n\r\nexport default {\r\n  name: \"Users-\",\r\n  setup() {\r\n    // lib\r\n    const router = useRouter();\r\n    // resoures\r\n    const query = ref(\"\");\r\n    const users = ref([]);\r\n    const lastTracked = ref(null);\r\n    const limit = ref(25);\r\n    const today = getTodayUnixTime();\r\n    // INPUT\r\n    const toUser = (userId) => {\r\n      router.push(`/users/${userId}`);\r\n    };\r\n\r\n    const onSearchUsers = async () => {\r\n      users.value = await searchUsers(query.value, limit.value);\r\n    };\r\n\r\n    const showMore = async () => {\r\n      limit.value += 25;\r\n      await onSearchUsers();\r\n    };\r\n\r\n    // LIFECYCLE\r\n    onMounted(async () => {\r\n      lastTracked.value = await fetchLastTracked();\r\n      await onSearchUsers();\r\n    });\r\n\r\n    onBeforeRouteLeave((to, from, next) => {\r\n      fetchNewUserCount();\r\n      next();\r\n    });\r\n\r\n    return {\r\n      today,\r\n      query,\r\n      users,\r\n      lastTracked,\r\n      unixToReadable,\r\n      formatPhone,\r\n      toUser,\r\n      onSearchUsers,\r\n      showMore,\r\n      limit,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\ntable {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  font-size: 14px;\r\n}\r\nth,\r\ntd {\r\n  padding-top: 10px;\r\n  padding-bottom: 10px;\r\n\r\n  text-align: center;\r\n}\r\ntr {\r\n  border: 1px solid;\r\n}\r\n.row {\r\n  cursor: pointer;\r\n}\r\n.row:hover {\r\n  background: var(--hover);\r\n}\r\n.row:active {\r\n  background: var(--active);\r\n}\r\n.newCol {\r\n  padding: 0px;\r\n  font-size: 8px;\r\n}\r\n.flexBox {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n.newCell {\r\n  padding: 2px;\r\n  background: var(--trans-red);\r\n  color: white;\r\n  border-radius: 2px;\r\n}\r\n#title {\r\n  font-size: 25px;\r\n  padding: 10px;\r\n}\r\n#search {\r\n  margin-bottom: 10px;\r\n}\r\n.todayCell {\r\n  padding: 2px;\r\n  background: var(--trans-blue);\r\n  color: white;\r\n  border-radius: 2px;\r\n}\r\n#show {\r\n  padding: 10px 30px;\r\n  margin: 10px;\r\n  border-radius: 20px;\r\n}\r\n.flex {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n</style>","import notifyReqError from \"@/stores/notifyReqError\";\r\n\r\nexport default async function searchUsers(query, limit) {\r\n  try {\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(`${baseURL}/api/users/search_users`, {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        query: query.trim(),\r\n        limit,\r\n      }),\r\n    });\r\n    // fetch json\r\n    const json = await res.json();\r\n\r\n    // read status and process response\r\n    if (res.ok) {\r\n      // res holder\r\n      const users = [];\r\n\r\n      // unpack\r\n      const tables = json.users;\r\n      for (let row of tables) {\r\n        const [\r\n          userId,\r\n          phoneNumId,\r\n          phoneNum,\r\n          role,\r\n          firstName,\r\n          lastName,\r\n          joinedOn,\r\n          contactName,\r\n        ] = row;\r\n\r\n        const user = {\r\n          userId,\r\n          phoneNumId,\r\n          phoneNum,\r\n          role,\r\n          firstName,\r\n          lastName,\r\n          joinedOn,\r\n          contactName,\r\n        };\r\n\r\n        // append user\r\n        users.push(user);\r\n      }\r\n\r\n      //  return results\r\n      return users;\r\n    } else {\r\n      notifyReqError(json.message);\r\n      console.log(\"Failed to search users, message: \", json.message);\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n  }\r\n}\r\n","export default async function fetchLastTracked() {\r\n  try {\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(`${baseURL}/api/users/get_last_tracked`, {\r\n      method: \"GET\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n    // fetch json\r\n    const json = await res.json();\r\n\r\n    // read status and process response\r\n    if (res.ok) {\r\n      // res holder\r\n      const lastTracked = json.last_tracked;\r\n      console.log(\"last: \", lastTracked);\r\n\r\n      return lastTracked;\r\n    } else {\r\n      // notifyReqError(json.message);\r\n      console.log(\"Failed to last tracked on users, message: \", json.message);\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n  }\r\n}\r\n","import { render } from \"./Users.vue?vue&type=template&id=247a0efa&scoped=true\"\nimport script from \"./Users.vue?vue&type=script&lang=js\"\nexport * from \"./Users.vue?vue&type=script&lang=js\"\n\nimport \"./Users.vue?vue&type=style&index=0&id=247a0efa&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-247a0efa\"]])\n\nexport default __exports__"],"names":["formatPhone","rawPhone","slice","console","log","formatted","length","unixToReadable","unixTimestamp","dateTime","DateTime","fromMillis","setZone","getTimezone","toLocaleString","weekday","month","day","year","class","key","_createElementBlock","_Fragment","_createElementVNode","type","id","placeholder","_cache","$event","$setup","query","onInput","args","onSearchUsers","_renderList","users","user","index","onClick","toUser","userId","_hoisted_2","_hoisted_3","joinedOn","lastTracked","_hoisted_4","_createCommentVNode","today","_hoisted_5","_toDisplayString","firstName","lastName","phoneNum","role","contactName","_hoisted_1","_hoisted_6","limit","showMore","async","searchUsers","baseURL","process","res","fetch","method","credentials","headers","body","JSON","stringify","trim","json","ok","tables","row","phoneNumId","push","notifyReqError","message","e","error","fetchLastTracked","last_tracked","name","setup","router","useRouter","ref","getTodayUnixTime","value","onMounted","onBeforeRouteLeave","to","from","next","fetchNewUserCount","__exports__","render"],"sourceRoot":""}