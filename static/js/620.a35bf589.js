"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[620],{4714:function(e,o,n){function t(e){if("+1"!==e.slice(0,2))return e;if(console.log("calling"),!e)return;let o="";return e=e.slice(2),o=e.length<=3?e:e.length<=6?`${e.slice(0,3)} ${e.slice(3)}`:`${e.slice(0,3)} ${e.slice(3,6)} ${e.slice(6)}`,o}n.d(o,{A:function(){return t}})},6769:function(e,o,n){n.d(o,{A:function(){return a}});var t=n(4116);function a(e){return console.log("calling"),t.c9.fromObject({hour:0}).plus({seconds:e}).toFormat("h:mm a")}},3519:function(e,o,n){n.d(o,{A:function(){return a}});var t=n(4116);function a(e){if(console.log("calling"),!e)return;const o=t.c9.fromSeconds(e).startOf("day"),n=t.c9.local().startOf("day"),a=o.diff(n,"days").toObject(),l=Math.round(a.days);if(o.equals(n))return"Today";if(1===l)return"Tomorrow";if(-1===l)return"Yesterday";const r=l>0?"next":"last";return Math.abs(l)>=30?`${r} ${Math.abs(Math.round(l/30))}m`:Math.abs(l)>=7?`${r} ${Math.abs(Math.round(l/7))}w`:`${r} ${Math.abs(l)}d`}},8297:function(e,o,n){n.d(o,{A:function(){return l}});var t=n(4116),a=n(6156);function l(e){console.log("calling");const o=t.c9.fromSeconds(e),n=o.setZone((0,a.A)());return n.toFormat("h:mm a")}},1076:function(e,o,n){n.d(o,{A:function(){return l}});var t=n(4116),a=n(6156);function l(e){if(console.log("calling"),!e)return;const o=t.c9.fromMillis(1e3*e).setZone((0,a.A)());return o.toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}},9620:function(e,o,n){n.r(o),n.d(o,{default:function(){return E}});var t=n(6768),a=n(5130),l=n(4232);const r=["onClick"],s={class:"newCol"},c={class:"flexBox"},i={key:0,class:"newCell"},u={key:1,class:"todayCell"},d={key:0},k={key:1},m={class:"flex"};function p(e,o,n,p,h,f){return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bo)((0,t.Lk)("input",{id:"search",placeholder:"Search...",type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>p.query=e),onInput:o[1]||(o[1]=(...e)=>p.onSearchBookings&&p.onSearchBookings(...e))},null,544),[[a.Jo,p.query]]),(0,t.Lk)("table",null,[o[4]||(o[4]=(0,t.Lk)("colgroup",null,[(0,t.Lk)("col",{style:{width:"auto"}}),(0,t.Lk)("col",{style:{width:"auto"}})],-1)),(0,t.Lk)("tbody",null,[o[3]||(o[3]=(0,t.Lk)("tr",null,[(0,t.Lk)("th",{class:"newCol"}),(0,t.Lk)("th",null,"Client"),(0,t.Lk)("th",null,"Booked on"),(0,t.Lk)("th",null,"Service"),(0,t.Lk)("th",null,"Employee"),(0,t.Lk)("th",null,"Booked for")],-1)),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.appos,((e,o)=>((0,t.uX)(),(0,t.CE)("tr",{class:"row",key:o,onClick:o=>p.toAppoDetails(e.date,e.appoId)},[(0,t.Lk)("td",s,[(0,t.Lk)("div",c,[e.bookedTime>p.lastTracked?((0,t.uX)(),(0,t.CE)("div",i,"NEW")):(0,t.Q3)("",!0),e.bookedTime>=p.today?((0,t.uX)(),(0,t.CE)("div",u,"TODAY")):(0,t.Q3)("",!0)])]),(0,t.Lk)("td",null,[(0,t.eW)((0,l.v_)(p.formatPhone(e.phoneNum))+" ",1),e.contactName?((0,t.uX)(),(0,t.CE)("div",d,(0,l.v_)(e.contactName),1)):(0,t.Q3)("",!0),e.profileName&&e.profileName!=e.contactName?((0,t.uX)(),(0,t.CE)("div",k," ("+(0,l.v_)(e.profileName)+") ",1)):(0,t.Q3)("",!0)]),(0,t.Lk)("td",null,[(0,t.eW)((0,l.v_)(p.unixTimeToReminder(e.bookedTime))+" ",1),(0,t.Lk)("div",null,(0,l.v_)(p.unixToReadable(e.bookedTime)),1),(0,t.Lk)("div",null,(0,l.v_)(p.unixToHours(e.bookedTime)),1)]),(0,t.Lk)("td",null,[(0,t.eW)((0,l.v_)(e.serviceName)+" ",1),(0,t.Lk)("div",null,(0,l.v_)(e.category),1)]),(0,t.Lk)("td",{style:(0,l.Tr)({color:e.color})},(0,l.v_)(e.empAlias),5),(0,t.Lk)("td",null,[(0,t.Lk)("div",null,(0,l.v_)(p.unixTimeToReminder(e.date)),1),(0,t.eW)(" "+(0,l.v_)(p.unixToReadable(e.date))+" ",1),(0,t.Lk)("div",null,(0,l.v_)(p.secsToHours(e.start))+" - "+(0,l.v_)(p.secsToHours(e.end)),1)])],8,r)))),128))])]),(0,t.Lk)("div",m,[p.appos?.length===p.limit?((0,t.uX)(),(0,t.CE)("button",{key:0,id:"show",class:"blueBtn",onClick:o[2]||(o[2]=(...e)=>p.showMore&&p.showMore(...e))}," Show More ")):(0,t.Q3)("",!0)])],64)}n(4114);var h=n(1387),f=n(144),v=n(1076),y=n(3519),g=n(6769),T=n(8297),b=n(4714),L=n(445),w=n(8199);async function A(e,o){try{const n="",t=await fetch(`${n}/api/appointments/search_bookings`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e.trim(),limit:o})}),a=await t.json();if(t.ok){const e=[],o=a.appos;for(let n of o){const[o,t,a,l,r,s,c,i,u,d,k,m,p,h,f]=n,v={appoId:o,bookedTime:t,empId:a,empAlias:l,color:r,serviceId:s,serviceName:c,category:i,phoneNumId:u,phoneNum:d,contactName:k,profileName:m,date:p,start:h,end:f};e.push(v)}return e}(0,w.A)(a.message),console.log("Failed to search booking history, message: ",a.message)}catch(n){console.error("Unexpected Error: ",n)}}async function C(){try{const e="",o=await fetch(`${e}/api/appointments/get_last_tracked`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),n=await o.json();if(o.ok){const e=n.last_tracked;return console.log("last: ",e),e}console.log("Failed to last tracked on bookings, message: ",n.message)}catch(e){console.error("Unexpected Error: ",e)}}var _=n(2405),x={name:"Booking-",setup(){const e=(0,f.KR)(""),o=(0,f.KR)([]),n=(0,f.KR)(25),a=(0,f.KR)(null),l=(0,L.A)(),r=(0,h.rd)(),s=async()=>{o.value=await A(e.value,n.value)},c=(e,o)=>{console.log("date, appoId",e,o),r.push(`/calendar/${e}/${o}`)},i=async()=>{n.value+=25,await s()};return(0,t.sV)((async()=>{a.value=await C(),await s()})),(0,h.JZ)(((e,o,n)=>{(0,_.SB)(),n()})),{today:l,query:e,appos:o,lastTracked:a,unixToReadable:v.A,unixTimeToReminder:y.A,secsToHours:g.A,unixToHours:T.A,formatPhone:b.A,toAppoDetails:c,onSearchBookings:s,showMore:i,limit:n}}},N=n(1241);const $=(0,N.A)(x,[["render",p],["__scopeId","data-v-189bcebe"]]);var E=$}}]);
//# sourceMappingURL=620.a35bf589.js.map