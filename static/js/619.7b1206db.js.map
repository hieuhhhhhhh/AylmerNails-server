{"version":3,"file":"js/619.7b1206db.js","mappings":"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","sources":["webpack://frontend/./src/views/book_now/comps/welcome_modal/apis/logIn.js","webpack://frontend/./src/views/authentication/apis/requestForgotPW.js","webpack://frontend/./src/views/authentication/forgot_password/PhoneNumInput.vue","webpack://frontend/./src/views/authentication/forgot_password/PhoneNumInput.vue?8bf4","webpack://frontend/./src/views/authentication/apis/renewPassword.js","webpack://frontend/./src/views/authentication/forgot_password/OTPverify.vue","webpack://frontend/./src/views/authentication/forgot_password/OTPverify.vue?c548","webpack://frontend/./src/views/authentication/forgot_password/ForgotPassword.vue","webpack://frontend/./src/views/authentication/forgot_password/ForgotPassword.vue?c1f8"],"sourcesContent":["import { useMyProfile } from \"@/stores/myProfile\";\r\nimport { parsePhoneNumberFromString } from \"libphonenumber-js\";\r\n\r\nexport default async function logIn(phoneNum, password, rememberMe) {\r\n  try {\r\n    try {\r\n      // parse phone number to E.164\r\n      phoneNum = parsePhoneNumberFromString(phoneNum, \"CA\").number; // E.164 format\r\n      console.log(\"phoneNum: \", phoneNum);\r\n    } catch (e) {\r\n      return { message: \"Invalid phone number\" };\r\n    }\r\n\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(`${baseURL}/api/authentication/log_in`, {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        phone_num: phoneNum,\r\n        password,\r\n        remember_me: rememberMe,\r\n      }),\r\n    });\r\n\r\n    // fetch json\r\n    const json = await res.json();\r\n\r\n    // read status and process response\r\n    if (res.ok) {\r\n      // update pinia states\r\n      const store = useMyProfile();\r\n\r\n      store.setMyProfile({\r\n        token: json.token,\r\n        role: json.user_role,\r\n      });\r\n\r\n      return true;\r\n    } else {\r\n      console.log(\"Failed to log in, message: \", json.message);\r\n      return { message: json.message };\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n    return { message: \"Unexpected Error\" };\r\n  }\r\n}\r\n","import { parsePhoneNumberFromString } from \"libphonenumber-js\";\r\n\r\nexport default async function requestForgotPW(phoneNum) {\r\n  try {\r\n    // parse phone number to E.164\r\n    phoneNum = parsePhoneNumberFromString(phoneNum, \"CA\").number; // E.164 format\r\n\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(\r\n      `${baseURL}/api/authentication/request_forgot_password`,\r\n      {\r\n        method: \"POST\",\r\n        credentials: \"include\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          phone_num: phoneNum,\r\n        }),\r\n      }\r\n    );\r\n\r\n    // fetch json return message\r\n    const json = await res.json();\r\n    const codeId = json.code_id;\r\n    const waitTime = json.wait_time;\r\n    const message = json.message;\r\n\r\n    // return results\r\n    return { codeId, message, waitTime };\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n    return { message: \"Unexpected Error\" };\r\n  }\r\n}\r\n","<template>\r\n  <form @submit.prevent=\"onSubmit\">\r\n    <div>\r\n      <input\r\n        type=\"tel\"\r\n        v-model=\"phoneNum\"\r\n        placeholder=\"Phone Number\"\r\n        required\r\n      />\r\n    </div>\r\n    <div>\r\n      <input\r\n        type=\"password\"\r\n        v-model=\"password\"\r\n        placeholder=\"New Password\"\r\n        required\r\n      />\r\n    </div>\r\n    <div id=\"msg\">{{ msg }}</div>\r\n    <button class=\"greenBtn\">Renew Password</button>\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\n// apis\r\nimport requestForgotPW from \"../apis/requestForgotPW\";\r\n\r\n// PROPS\r\nconst props = defineProps({\r\n  onNext: Function,\r\n});\r\n\r\n// PAYLOAD\r\nconst phoneNum = ref(\"\");\r\nconst password = ref(\"\");\r\n\r\n// OUTPUT\r\nconst msg = ref(\"\");\r\n\r\n// APIS\r\nasync function onSubmit() {\r\n  const { codeId, message, waitTime } = await requestForgotPW(phoneNum.value);\r\n\r\n  //   if fail\r\n  if (!codeId) {\r\n    msg.value = message;\r\n    return;\r\n  }\r\n\r\n  // if succesful\r\n  props.onNext(codeId, phoneNum.value, password.value, waitTime);\r\n}\r\n</script>\r\n\r\n\r\n<style scoped>\r\nform {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\nbutton {\r\n  font-size: 20px;\r\n  padding-inline: 50px;\r\n  border-radius: 20px;\r\n  margin-bottom: 50px;\r\n}\r\n\r\ninput {\r\n  padding: 6px 10px;\r\n  width: 280px;\r\n}\r\n\r\n#msg {\r\n  color: red;\r\n  font-size: 15px;\r\n}\r\n</style>","import script from \"./PhoneNumInput.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PhoneNumInput.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PhoneNumInput.vue?vue&type=style&index=0&id=309d18a4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-309d18a4\"]])\n\nexport default __exports__","import logIn from \"@/views/book_now/comps/welcome_modal/apis/logIn\";\r\n\r\nexport default async function renewPassword(codeId, code, phoneNum, password) {\r\n  try {\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(`${baseURL}/api/authentication/renew_password`, {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        code_id: codeId,\r\n        code,\r\n        password,\r\n      }),\r\n    });\r\n\r\n    // read status and process response\r\n    if (res.ok) {\r\n      // if sign up succesful, log in\r\n      await logIn(phoneNum, password);\r\n    } else {\r\n      // fetch json\r\n      const json = await res.json();\r\n      console.log(\"Failed to renew password, message: \", json.message);\r\n\r\n      // return the message upon failure\r\n      return json.message;\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n    return e.message;\r\n  }\r\n}\r\n","<template>\r\n  <form @submit.prevent=\"onSubmit\">\r\n    <div>Please enter the one time code sent to {{ phoneNum }}</div>\r\n\r\n    <div>\r\n      <input type=\"text\" v-model=\"code\" placeholder=\"Verification Code\" />\r\n    </div>\r\n    <div id=\"msg\">{{ msg }}</div>\r\n    <button class=\"greenBtn\">Verify</button>\r\n    <a v-if=\"wait > 0\" class=\"disabled\"> Resend Code (Wait {{ wait }}s)</a>\r\n    <a v-else @click=\"onResend\"> Resend Code </a>\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, onUnmounted, ref } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\n// apis\r\nimport requestForgotPW from \"../apis/requestForgotPW\";\r\nimport renewPassword from \"../apis/renewPassword\";\r\n\r\n// params\r\nconst props = defineProps({\r\n  codeId: Number,\r\n  phoneNum: String,\r\n  password: String,\r\n  waitTime: Number,\r\n});\r\n\r\n// payload\r\nconst codeId = ref(props.codeId);\r\nconst code = ref(\"\");\r\nconst msg = ref(\"\");\r\nconst router = useRouter();\r\nconst wait = ref(props.waitTime);\r\n\r\n// APIS\r\nasync function onSubmit() {\r\n  const message = await renewPassword(\r\n    codeId.value,\r\n    code.value,\r\n    props.phoneNum,\r\n    props.password\r\n  );\r\n\r\n  //   if fail\r\n  if (message) {\r\n    msg.value = message;\r\n    code.value = \"\";\r\n    return;\r\n  }\r\n\r\n  // if succesful\r\n  router.push(\"/\");\r\n}\r\n\r\nasync function onResend() {\r\n  const {\r\n    codeId: _codeId,\r\n    message,\r\n    waitTime,\r\n  } = await requestForgotPW(props.phoneNum);\r\n  console.log(_codeId);\r\n\r\n  //   if fail\r\n  if (!_codeId) {\r\n    msg.value = message;\r\n    return;\r\n  }\r\n\r\n  // if succesful\r\n  codeId.value = _codeId;\r\n  wait.value = waitTime;\r\n}\r\n\r\n// LIFECYCLE\r\nlet interval;\r\n\r\nonMounted(() => {\r\n  interval = setInterval(() => {\r\n    wait.value--;\r\n  }, 1000); // count down every 1 second\r\n});\r\n\r\nonUnmounted(() => {\r\n  clearInterval(interval);\r\n});\r\n</script>\r\n\r\n<style scoped>\r\nform {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\nbutton {\r\n  font-size: 20px;\r\n  padding-inline: 50px;\r\n  border-radius: 20px;\r\n  margin-bottom: 50px;\r\n}\r\ninput {\r\n  padding: 6px 10px;\r\n  width: 250px;\r\n}\r\n.disabled {\r\n  color: gray;\r\n  pointer-events: none;\r\n}\r\n#msg {\r\n  color: red;\r\n  font-size: 15px;\r\n}\r\na {\r\n  font-size: 15px;\r\n  text-decoration: none;\r\n  color: rgb(0, 153, 255);\r\n  cursor: pointer;\r\n}\r\n\r\na:hover,\r\na:active {\r\n  text-decoration: underline;\r\n}\r\n</style>","import script from \"./OTPverify.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./OTPverify.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./OTPverify.vue?vue&type=style&index=0&id=3e39b502&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3e39b502\"]])\n\nexport default __exports__","<template>\r\n  <div id=\"layout\">\r\n    <div id=\"title\">Forgot password</div>\r\n    <div v-if=\"page === 1\"><PhoneNumInput :onNext=\"onRequestCode\" /></div>\r\n    <div v-if=\"page === 2\">\r\n      <OTPverify\r\n        :codeId=\"codeId\"\r\n        :phoneNum=\"phoneNum\"\r\n        :password=\"password\"\r\n        :waitTime=\"waitTime\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\n// comps\r\nimport PhoneNumInput from \"./PhoneNumInput.vue\";\r\nimport OTPverify from \"./OTPverify.vue\";\r\n\r\n// RESOURCES\r\nconst page = ref(1);\r\n// PAYLOAD\r\nconst codeId = ref();\r\nconst phoneNum = ref(\"\");\r\nconst password = ref(\"\");\r\nconst waitTime = ref(0);\r\n\r\n// HANDLERS\r\nfunction onRequestCode(_codeId, _phoneNum, _password, _waitTime) {\r\n  codeId.value = _codeId;\r\n  phoneNum.value = _phoneNum;\r\n  password.value = _password;\r\n  waitTime.value = _waitTime;\r\n\r\n  // to next page\r\n  page.value++;\r\n}\r\n</script>\r\n\r\n<script>\r\nexport default {};\r\n</script>\r\n\r\n<style scoped>\r\n#layout {\r\n  background-color: var(--background-i1);\r\n  padding: 10px;\r\n  width: 900px;\r\n  max-width: 100vw;\r\n  margin-inline: auto;\r\n  flex-grow: 1;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n}\r\n#title {\r\n  text-align: center;\r\n  margin: 10px;\r\n  font-size: 25px;\r\n  margin-bottom: 20px;\r\n}\r\n</style>","import script from \"./ForgotPassword.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ForgotPassword.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ForgotPassword.vue?vue&type=style&index=0&id=7452bfcf&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7452bfcf\"]])\n\nexport default __exports__"],"names":["async","logIn","phoneNum","password","rememberMe","parsePhoneNumberFromString","number","console","log","e","message","baseURL","process","res","fetch","method","credentials","headers","body","JSON","stringify","phone_num","remember_me","json","ok","store","useMyProfile","setMyProfile","token","role","user_role","error","requestForgotPW","codeId","code_id","waitTime","wait_time","props","__props","ref","msg","onSubmit","value","onNext","__exports__","renewPassword","code","router","useRouter","wait","push","onResend","_codeId","interval","onMounted","setInterval","onUnmounted","clearInterval","__default__","page","onRequestCode","_phoneNum","_password","_waitTime"],"sourceRoot":""}