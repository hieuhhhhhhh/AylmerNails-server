"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[753],{4714:function(n,e,o){function t(n){if("+1"!==n.slice(0,2))return n;if(console.log("calling"),!n)return;let e="";return n=n.slice(2),e=n.length<=3?n:n.length<=6?`${n.slice(0,3)} ${n.slice(3)}`:`${n.slice(0,3)} ${n.slice(3,6)} ${n.slice(6)}`,e}o.d(e,{A:function(){return t}})},6769:function(n,e,o){o.d(e,{A:function(){return a}});var t=o(4116);function a(n){return console.log("calling"),t.c9.fromObject({hour:0}).plus({seconds:n}).toFormat("h:mm a")}},3519:function(n,e,o){o.d(e,{A:function(){return a}});var t=o(4116);function a(n){if(console.log("calling"),!n)return;const e=t.c9.fromSeconds(n).startOf("day"),o=t.c9.local().startOf("day"),a=e.diff(o,"days").toObject(),l=Math.round(a.days);if(e.equals(o))return"Today";if(1===l)return"Tomorrow";if(-1===l)return"Yesterday";const r=l>0?"next":"last";return Math.abs(l)>=30?`${r} ${Math.abs(Math.round(l/30))}m`:Math.abs(l)>=7?`${r} ${Math.abs(Math.round(l/7))}w`:`${r} ${Math.abs(l)}d`}},1076:function(n,e,o){o.d(e,{A:function(){return l}});var t=o(4116),a=o(6156);function l(n){if(console.log("calling"),!n)return;const e=t.c9.fromMillis(1e3*n).setZone((0,a.A)());return e.toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}},5753:function(n,e,o){o.r(e),o.d(e,{default:function(){return Kn}});var t=o(6768);const a={id:"layout"};function l(n,e,o,l,r,s){const u=(0,t.g2)("Profile");return(0,t.uX)(),(0,t.CE)("div",a,[(0,t.bF)(u)])}function r(n,e,o,a,l,r){const s=(0,t.g2)("ProfileInfo"),u=(0,t.g2)("UserAppos");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(s,{userInfo:a.userInfo},null,8,["userInfo"]),(0,t.bF)(u,{appos:a.appos},null,8,["appos"])],64)}var s=o(144),u=(o(4114),o(8199));async function i(){try{const n="",e=await fetch(`${n}/api/users/get_my_profile`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await e.json();if(e.ok){const[n,e,t,a,l,r,s]=o.info,u={role:n,birth:e,phoneNum:t,firstName:a,lastName:l,notes:r,contactName:s},i=[],c=o.appos;for(let o of c){const[n,e,t,a,l,r,s,u,c,d]=o,p={appoId:n,empId:e,empAlias:t,color:a,serviceId:l,serviceName:r,category:s,date:u,start:c,end:d};i.push(p)}return{userInfo:u,appos:i}}(0,u.A)(o.message),console.log("Failed to fetch my profile, message: ",o.message)}catch(n){console.error("Unexpected Error: ",n)}}var c=o(4232);const d={colspan:"2"},p={id:"title"},m={key:0};function f(n,e,o,a,l,r){const s=(0,t.g2)("Drawer"),u=(0,t.g2)("NameEdit");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.Lk)("table",null,[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",d,[(0,t.Lk)("div",p,[(0,t.Lk)("div",null,(0,c.v_)(o.userInfo.firstName)+" "+(0,c.v_)(o.userInfo.lastName),1),(0,t.Lk)("div",null,[(0,t.bF)(s,{onEditName:a.onEditName},null,8,["onEditName"])])])])]),(0,t.Lk)("tr",null,[e[0]||(e[0]=(0,t.Lk)("th",null,"Client Name:",-1)),(0,t.Lk)("td",null,(0,c.v_)(o.userInfo.contactName),1)]),(0,t.Lk)("tr",null,[e[1]||(e[1]=(0,t.Lk)("th",null,"Phone Number:",-1)),(0,t.Lk)("td",null,(0,c.v_)(a.formatPhone(o.userInfo.phoneNum)),1)]),(0,t.Lk)("tr",null,[e[2]||(e[2]=(0,t.Lk)("th",null,"Joined on:",-1)),(0,t.Lk)("td",null,(0,c.v_)(a.unixToReadable(o.userInfo.birth)),1)]),"client"!==o.userInfo.role?((0,t.uX)(),(0,t.CE)("tr",m,[e[3]||(e[3]=(0,t.Lk)("th",null,"Role:",-1)),(0,t.Lk)("td",null,(0,c.v_)(o.userInfo.role),1)])):(0,t.Q3)("",!0)])]),a.isEditingName?((0,t.uX)(),(0,t.Wv)(u,{key:0,userInfo:o.userInfo,onCancel:a.onNotEditName,onFinish:a.onNameUpdated},null,8,["userInfo","onCancel","onFinish"])):(0,t.Q3)("",!0)],64)}var v=o(1076),k=o(4714);const g={id:"relative"};function L(n,e,o,a,l,r){const s=(0,t.g2)("FontAwesomeIcon"),u=(0,t.g2)("Drawer"),i=(0,t.g2)("ChangePassword"),c=(0,t.g2)("LogOutEverywhere");return(0,t.uX)(),(0,t.CE)("div",g,[(0,t.Lk)("button",{onClick:e[0]||(e[0]=(...n)=>a.onToogleDrawer&&a.onToogleDrawer(...n))},[(0,t.bF)(s,{icon:a.faCaretDown},null,8,["icon"])]),a.isDrawerOpen?((0,t.uX)(),(0,t.Wv)(u,{key:0,onEditName:o.onEditName,onToogleDrawer:a.onToogleDrawer,onChangePassword:a.onChangePassword,onLogOutAll:a.onLogOutAll},null,8,["onEditName","onToogleDrawer","onChangePassword","onLogOutAll"])):(0,t.Q3)("",!0),a.isChangingPW?((0,t.uX)(),(0,t.Wv)(i,{key:1,onCancel:()=>a.onChangePassword(!1)},null,8,["onCancel"])):(0,t.Q3)("",!0),a.isLoggingOutAll?((0,t.uX)(),(0,t.Wv)(c,{key:2,onCancel:()=>a.onLogOutAll(!1)},null,8,["onCancel"])):(0,t.Q3)("",!0)])}var C=o(8249),h=o(2353);function w(n,e,o,a,l,r){return(0,t.uX)(),(0,t.CE)("div",{id:"drawer",ref:"drawer",onBlur:e[3]||(e[3]=(...n)=>a.onBlur&&a.onBlur(...n)),tabindex:"0"},[(0,t.Lk)("button",{onClick:e[0]||(e[0]=(...n)=>o.onEditName&&o.onEditName(...n))},"Edit my name"),(0,t.Lk)("button",{onClick:e[1]||(e[1]=(...n)=>o.onChangePassword&&o.onChangePassword(...n))},"Change my password"),(0,t.Lk)("button",{onClick:e[2]||(e[2]=(...n)=>o.onLogOutAll&&o.onLogOutAll(...n))},"Log out everywhere")],544)}var y={name:"Drawer-",props:{onEditName:Function,onToogleDrawer:Function,onChangePassword:Function,onLogOutAll:Function},setup(n){const e=(0,s.KR)(null),o=o=>{const t=o.relatedTarget;t&&e.value.contains(t)?e.value.focus():n.onToogleDrawer()};return(0,t.sV)((()=>{e.value.focus()})),{drawer:e,onBlur:o}}},b=o(1241);const A=(0,b.A)(y,[["render",w],["__scopeId","data-v-58381b8c"]]);var _=A,I=o(5130);async function E(n,e){try{const o="",t=await fetch(`${o}/api/authentication/change_password`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:n,new_password:e})});if(t.ok)return!0;{const n=await t.json();(0,u.A)(n.message),console.log("Failed to change password, message: ",n.message)}}catch(o){console.error("Unexpected Error: ",o)}}const N={id:"parent"},T={id:"window"},F={id:"content"},O={};var R=Object.assign(O,{__name:"ChangePassword",props:{onCancel:Function},setup(n){const e=n,o=(0,s.KR)(""),a=(0,s.KR)("");async function l(){const n=await E(o.value,a.value);n&&e.onCancel()}return(r,u)=>((0,t.uX)(),(0,t.CE)("div",N,[(0,t.Lk)("div",{id:"background",onClick:u[0]||(u[0]=(...e)=>n.onCancel&&n.onCancel(...e))}),(0,t.Lk)("div",T,[(0,t.Lk)("button",{onClick:u[1]||(u[1]=(...n)=>e.onCancel&&e.onCancel(...n)),id:"closeBtn",class:"redBtn"},[(0,t.bF)((0,s.R1)(C.gc),{icon:(0,s.R1)(h.Jyw)},null,8,["icon"])]),(0,t.Lk)("form",{onSubmit:(0,I.D$)(l,["prevent"])},[(0,t.Lk)("div",F,[(0,t.bo)((0,t.Lk)("input",{type:"password","onUpdate:modelValue":u[2]||(u[2]=n=>o.value=n),placeholder:"Enter Current Password",required:""},null,512),[[I.Jo,o.value]]),u[4]||(u[4]=(0,t.Lk)("br",null,null,-1)),(0,t.bo)((0,t.Lk)("input",{type:"password","onUpdate:modelValue":u[3]||(u[3]=n=>a.value=n),placeholder:"Enter New Password",required:""},null,512),[[I.Jo,a.value]])]),u[5]||(u[5]=(0,t.Lk)("div",{class:"flexBox"},[(0,t.Lk)("button",{class:"blueBtn"},"Change Password")],-1))],32)])]))}});const x=(0,b.A)(R,[["__scopeId","data-v-b619ddc8"]]);var P=x,D=o(1387),X=o(7165);async function $(){try{const n="",e=await fetch(`${n}/api/authentication/log_out_everywhere`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){const n=(0,X.je)();n.clearMyProfile()}}catch(n){console.error("Unexpected Error: ",n)}}const B={id:"parent"},j={id:"window"},K={id:"content"},S={};var M=Object.assign(S,{__name:"LogOutEverywhere",props:{onCancel:Function},setup(n){const e=n,o=(0,D.rd)();async function a(){await $(),o.push("/")}return(n,o)=>((0,t.uX)(),(0,t.CE)("div",B,[(0,t.Lk)("div",{id:"background",onClick:o[0]||(o[0]=(...n)=>e.onCancel&&e.onCancel(...n))}),(0,t.Lk)("div",j,[(0,t.Lk)("button",{onClick:o[1]||(o[1]=(...n)=>e.onCancel&&e.onCancel(...n)),id:"closeBtn",class:"redBtn"},[(0,t.bF)((0,s.R1)(C.gc),{icon:(0,s.R1)(h.Jyw)},null,8,["icon"])]),(0,t.Lk)("div",K,[(0,t.Lk)("form",{onSubmit:(0,I.D$)(a,["prevent"])},o[2]||(o[2]=[(0,t.Lk)("div",null,"Log out your account in all devices?",-1),(0,t.Lk)("div",{id:"flex"},[(0,t.Lk)("button",{id:"yes",class:"blueBtn"},"Yes")],-1)]),32)])])]))}});const U=(0,b.A)(M,[["__scopeId","data-v-e497f4d2"]]);var W=U,J={name:"DrawerParent",props:{onEditName:Function},components:{Drawer:_,FontAwesomeIcon:C.gc,ChangePassword:P,LogOutEverywhere:W},setup(){const n=(0,s.KR)(!1),e=(0,s.KR)(!1),o=(0,s.KR)(!1),t=async()=>{n.value=!n.value},a=(n=!0)=>{e.value=n},l=(n=!0)=>{o.value=n};return{isDrawerOpen:n,onToogleDrawer:t,faCaretDown:h.xBV,isChangingPW:e,onChangePassword:a,isLoggingOutAll:o,onLogOutAll:l}}};const V=(0,b.A)(J,[["render",L],["__scopeId","data-v-40efc916"]]);var Q=V;const q={id:"parent"},H={id:"window"},G={id:"content"};function Y(n,e,o,a,l,r){const s=(0,t.g2)("FontAwesomeIcon");return(0,t.uX)(),(0,t.CE)("div",q,[(0,t.Lk)("div",{id:"background",onClick:e[0]||(e[0]=(...n)=>o.onCancel&&o.onCancel(...n))}),(0,t.Lk)("div",H,[(0,t.Lk)("button",{onClick:e[1]||(e[1]=(...n)=>o.onCancel&&o.onCancel(...n)),id:"closeBtn",class:"redBtn"},[(0,t.bF)(s,{icon:a.faXmark},null,8,["icon"])]),(0,t.Lk)("div",G,[(0,t.Lk)("form",{onSubmit:e[4]||(e[4]=(0,I.D$)(((...n)=>a.onSubmit&&a.onSubmit(...n)),["prevent"]))},[e[5]||(e[5]=(0,t.Lk)("label",null,"First Name",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=n=>a.firstName=n),placeholder:"Enter First Name",required:""},null,512),[[I.Jo,a.firstName]]),e[6]||(e[6]=(0,t.Lk)("br",null,null,-1)),e[7]||(e[7]=(0,t.Lk)("br",null,null,-1)),e[8]||(e[8]=(0,t.Lk)("label",null,"Last Name",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>a.lastName=n),placeholder:"Enter Last Name",required:""},null,512),[[I.Jo,a.lastName]]),e[9]||(e[9]=(0,t.Lk)("div",{class:"flexBox"},[(0,t.Lk)("button",{class:"blueBtn"},"Save")],-1))],32)])])])}async function Z(n,e){try{const o="",t=await fetch(`${o}/api/users/update_my_profile`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:n,last_name:e})});if(t.ok)return!0;{const n=await t.json();(0,u.A)(n.message),console.log("Failed to update my profile, message: ",n.message)}}catch(o){console.error("Unexpected Error: ",o)}}var z={props:{userInfo:Object,onCancel:Function,onFinish:Function},components:{FontAwesomeIcon:C.gc},setup(n){const e=(0,s.KR)(null),o=(0,s.KR)(null),a=async()=>{const t=await Z(e.value,o.value);t&&n.onFinish()};return(0,t.sV)((()=>{e.value=n.userInfo.firstName,o.value=n.userInfo.lastName})),{firstName:e,lastName:o,onSubmit:a,faXmark:h.Jyw}}};const nn=(0,b.A)(z,[["render",Y],["__scopeId","data-v-d2a6af94"]]);var en=nn,on={props:{userInfo:Object},components:{Drawer:Q,NameEdit:en},setup(){const n=(0,D.rd)(),e=(0,s.KR)(!1),o=()=>{e.value=!0},t=()=>{e.value=!1,n.push("/refresh")},a=()=>{e.value=!1};return{isEditingName:e,onEditName:o,onNotEditName:a,onNameUpdated:t,unixToReadable:v.A,formatPhone:k.A}}};const tn=(0,b.A)(on,[["render",f],["__scopeId","data-v-3985dfea"]]);var an=tn;const ln={key:0},rn=["onClick"],sn={class:"cate"};function un(n,e,o,a,l,r){const s=(0,t.g2)("AppoModal");return(0,t.uX)(),(0,t.CE)(t.FK,null,[e[2]||(e[2]=(0,t.Lk)("div",{id:"title"},"My Appointments",-1)),a.appo?((0,t.uX)(),(0,t.Wv)(s,{key:0,appo:a.appo,onCancel:a.onCancel},null,8,["appo","onCancel"])):(0,t.Q3)("",!0),(0,t.Lk)("table",null,[(0,t.Lk)("tbody",null,[e[1]||(e[1]=(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"Service"),(0,t.Lk)("th",null,"Date"),(0,t.Lk)("th",null,"Time"),(0,t.Lk)("th",null,"Duration")],-1)),0===a.futureAppos.length?((0,t.uX)(),(0,t.CE)("tr",ln,e[0]||(e[0]=[(0,t.Lk)("td",{colspan:"4",style:{"text-align":"center"}}," No upcomming appointments ",-1)]))):(0,t.Q3)("",!0),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(a.futureAppos,((n,e)=>((0,t.uX)(),(0,t.CE)("tr",{class:"row",key:e,onClick:e=>a.onOpenAppo(n)},[(0,t.Lk)("td",null,[(0,t.eW)((0,c.v_)(n.serviceName)+" ",1),(0,t.Lk)("div",sn,(0,c.v_)(n.category),1)]),(0,t.Lk)("td",null,[(0,t.eW)((0,c.v_)(a.unixToReadable(n.date))+" ",1),(0,t.Lk)("div",null,"("+(0,c.v_)(a.unixTimeToReminder(n.date))+")",1)]),(0,t.Lk)("td",null,(0,c.v_)(a.secsToHours(n.start)),1),(0,t.Lk)("td",null,[(0,t.Lk)("div",null,(0,c.v_)((n.end-n.start)/60)+" mins",1)])],8,rn)))),128))])])],64)}o(8992),o(4520);var cn=o(3519),dn=o(6769);const pn={id:"parent"},mn={id:"window"},fn={id:"content"},vn={key:0},kn={id:"duo"};function gn(n,e,o,a,l,r){const s=(0,t.g2)("FontAwesomeIcon"),u=(0,t.g2)("AppoInfo"),i=(0,t.g2)("ConfirmDelete");return(0,t.uX)(),(0,t.CE)("div",pn,[(0,t.Lk)("div",{id:"background",onClick:e[0]||(e[0]=(...n)=>o.onCancel&&o.onCancel(...n))}),(0,t.Lk)("div",mn,[(0,t.Lk)("button",{onClick:e[1]||(e[1]=(0,I.D$)(((...n)=>o.onCancel&&o.onCancel(...n)),["prevent"])),id:"closeBtn",class:"redBtn"},[(0,t.bF)(s,{icon:a.faXmark},null,8,["icon"])]),(0,t.Lk)("div",fn,[(0,t.bF)(u,{appo:o.appo},null,8,["appo"]),a.isCancelingAppo?((0,t.uX)(),(0,t.Wv)(i,{key:0,appoId:o.appo.appoId},null,8,["appoId"])):(0,t.Q3)("",!0)]),a.isCancelingAppo?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",vn,[(0,t.Lk)("div",kn,[(0,t.Lk)("button",{class:"redBtn",onClick:e[2]||(e[2]=(...n)=>a.onCancelAppo&&a.onCancelAppo(...n))}," Cancel This Appoinment "),a.isRoleValid?((0,t.uX)(),(0,t.CE)("button",{key:0,class:"greenBtn",onClick:e[3]||(e[3]=n=>a.onOpenCalendar(o.appo.date,o.appo.appoId))}," Open Calendar ")):(0,t.Q3)("",!0)])]))])])}function Ln(n,e,o,a,l,r){return(0,t.uX)(),(0,t.CE)("table",null,[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[e[0]||(e[0]=(0,t.Lk)("th",null,"Service",-1)),(0,t.Lk)("td",null,(0,c.v_)(o.appo.serviceName)+" ("+(0,c.v_)(o.appo.category)+")",1)]),(0,t.Lk)("tr",null,[e[1]||(e[1]=(0,t.Lk)("th",null,"Date",-1)),(0,t.Lk)("td",null,[(0,t.eW)((0,c.v_)(a.unixToReadable(o.appo.date))+" ",1),(0,t.Lk)("div",null,"("+(0,c.v_)(a.unixTimeToReminder(o.appo.date))+")",1)])]),(0,t.Lk)("tr",null,[e[2]||(e[2]=(0,t.Lk)("th",null,"Time",-1)),(0,t.Lk)("td",null,(0,c.v_)(a.secsToHours(o.appo.start)),1)]),(0,t.Lk)("tr",null,[e[3]||(e[3]=(0,t.Lk)("th",null,"Duration",-1)),(0,t.Lk)("td",null,(0,c.v_)((o.appo.end-o.appo.start)/60)+" mins",1)])])])}var Cn={props:{appo:Object},setup(){return{unixTimeToReminder:cn.A,unixToReadable:v.A,secsToHours:dn.A}}};const hn=(0,b.A)(Cn,[["render",Ln],["__scopeId","data-v-3a9859d8"]]);var wn=hn;const yn={id:"main"};function bn(n,e,o,a,l,r){return(0,t.uX)(),(0,t.CE)("div",yn,[e[2]||(e[2]=(0,t.Lk)("div",{id:"title"},"Are you sure to cancel this appointment?",-1)),e[3]||(e[3]=(0,t.Lk)("label",null,'Type "yes" to confirm',-1)),(0,t.bo)((0,t.Lk)("input",{ref:"inputRef",type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>a.text=n),onInput:e[1]||(e[1]=(...n)=>a.onInput&&a.onInput(...n)),placeholder:"yes"},null,544),[[I.Jo,a.text]])])}async function An(n){try{const e="",o=await fetch(`${e}/api/appointments/cancel_appointment`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({appo_id:n})});if(o.ok)return!0;{const n=await o.json();(0,u.A)(n.message),console.log("Failed to cancel appointment, message: ",n.message)}}catch(e){console.error("Unexpected Error: ",e)}}var _n={props:{appoId:Number},setup(n){const e=(0,D.rd)(),o=(0,s.KR)(""),a=(0,s.KR)(null),l=async()=>{if("yes"===o.value.trim().toLowerCase()){const o=await An(n.appoId);o&&e.push("/refresh")}};return(0,t.sV)((()=>{a.value&&a.value.focus()})),{text:o,inputRef:a,onInput:l}}};const In=(0,b.A)(_n,[["render",bn],["__scopeId","data-v-729ea326"]]);var En=In,Nn={name:"AppoModal",components:{AppoInfo:wn,ConfirmDelete:En,FontAwesomeIcon:C.gc},props:{appo:Object,onCancel:Function},setup(){const n=(0,s.KR)(!1),e=(0,D.rd)(),o=(0,X.je)(),a=(0,t.EW)((()=>o.role)),l=["admin","owner"],r=(0,t.EW)((()=>l.includes(a.value))),u=(n,o)=>{e.push(`/calendar/${n}/${o}`)},i=()=>{n.value=!0};return{onOpenCalendar:u,isRoleValid:r,isCancelingAppo:n,onCancelAppo:i,faXmark:h.Jyw}}};const Tn=(0,b.A)(Nn,[["render",gn],["__scopeId","data-v-363f5600"]]);var Fn=Tn,On=o(445),Rn={components:{AppoModal:Fn},props:{appos:Array},setup(n){const e=(0,s.KR)(null),o=(0,On.A)(),a=(0,t.EW)((()=>n.appos.filter((n=>n.date>=o)))),l=n=>{e.value=n},r=()=>{e.value=null};return{appo:e,futureAppos:a,unixTimeToReminder:cn.A,unixToReadable:v.A,secsToHours:dn.A,onOpenAppo:l,onCancel:r}}};const xn=(0,b.A)(Rn,[["render",un],["__scopeId","data-v-7fecff5c"]]);var Pn=xn,Dn={name:"Profile-",components:{ProfileInfo:an,UserAppos:Pn},setup(){const n=(0,s.KR)({}),e=(0,s.KR)([]);return(0,t.sV)((async()=>{let o=await i();o&&(n.value=o.userInfo,e.value=o.appos)})),{appos:e,userInfo:n}}};const Xn=(0,b.A)(Dn,[["render",r]]);var $n=Xn,Bn={name:"Layout-",components:{Profile:$n}};const jn=(0,b.A)(Bn,[["render",l],["__scopeId","data-v-ca132262"]]);var Kn=jn}}]);
//# sourceMappingURL=753.5e87a408.js.map