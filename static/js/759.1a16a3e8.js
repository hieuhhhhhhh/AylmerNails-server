"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[759],{4714:function(e,n,t){function o(e){if("+1"!==e.slice(0,2))return e;if(console.log("calling"),!e)return;let n="";return e=e.slice(2),n=e.length<=3?e:e.length<=6?`${e.slice(0,3)} ${e.slice(3)}`:`${e.slice(0,3)} ${e.slice(3,6)} ${e.slice(6)}`,n}t.d(n,{A:function(){return o}})},6769:function(e,n,t){t.d(n,{A:function(){return a}});var o=t(4116);function a(e){return console.log("calling"),o.c9.fromObject({hour:0}).plus({seconds:e}).toFormat("h:mm a")}},3519:function(e,n,t){t.d(n,{A:function(){return a}});var o=t(4116);function a(e){if(console.log("calling"),!e)return;const n=o.c9.fromSeconds(e).startOf("day"),t=o.c9.local().startOf("day"),a=n.diff(t,"days").toObject(),l=Math.round(a.days);if(n.equals(t))return"Today";if(1===l)return"Tomorrow";if(-1===l)return"Yesterday";const c=l>0?"next":"last";return Math.abs(l)>=30?`${c} ${Math.abs(Math.round(l/30))}m`:Math.abs(l)>=7?`${c} ${Math.abs(Math.round(l/7))}w`:`${c} ${Math.abs(l)}d`}},8297:function(e,n,t){t.d(n,{A:function(){return l}});var o=t(4116),a=t(6156);function l(e){console.log("calling");const n=o.c9.fromSeconds(e),t=n.setZone((0,a.A)());return t.toFormat("h:mm a")}},1076:function(e,n,t){t.d(n,{A:function(){return l}});var o=t(4116),a=t(6156);function l(e){if(console.log("calling"),!e)return;const n=o.c9.fromMillis(1e3*e).setZone((0,a.A)());return n.toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}},5759:function(e,n,t){t.r(n),t.d(n,{default:function(){return $}});var o=t(6768),a=t(5130),l=t(4232);const c=["onClick"],r={class:"newCol"},s={class:"flexBox"},i={key:0,class:"newCell"},u={key:1,class:"todayCell"},d={key:0},m={class:"flex"};function f(e,n,t,f,h,p){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bo)((0,o.Lk)("input",{id:"search",type:"text",placeholder:"Search...","onUpdate:modelValue":n[0]||(n[0]=e=>f.query=e),onInput:n[1]||(n[1]=(...e)=>f.onSearchCanceled&&f.onSearchCanceled(...e))},null,544),[[a.Jo,f.query]]),(0,o.Lk)("table",null,[(0,o.Lk)("tbody",null,[n[3]||(n[3]=(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"newCol"}),(0,o.Lk)("th",null,"Canceled by"),(0,o.Lk)("th",null,"Canceled on"),(0,o.Lk)("th",null,"Service"),(0,o.Lk)("th",null,"Employee"),(0,o.Lk)("th",null,"Client"),(0,o.Lk)("th",null,"Booked for")],-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f.appos,((e,n)=>((0,o.uX)(),(0,o.CE)("tr",{class:"row",key:n,onClick:n=>f.toDate(e.date)},[(0,o.Lk)("td",r,[(0,o.Lk)("div",s,[e.cancelTime>f.lastTracked?((0,o.uX)(),(0,o.CE)("div",i,"NEW")):(0,o.Q3)("",!0),e.cancelTime>=f.today?((0,o.uX)(),(0,o.CE)("div",u,"TODAY")):(0,o.Q3)("",!0)])]),(0,o.Lk)("td",null,[(0,o.eW)((0,l.v_)(f.formatPhone(e.canceler.phoneNum))+" ",1),(0,o.Lk)("div",null,(0,l.v_)(e.canceler.contactName),1),e.canceler.profileName!=e.canceler.contactName?((0,o.uX)(),(0,o.CE)("div",d," ("+(0,l.v_)(e.canceler.profileName)+") ",1)):(0,o.Q3)("",!0)]),(0,o.Lk)("td",null,[(0,o.eW)((0,l.v_)(f.unixTimeToReminder(e.cancelTime))+" ",1),(0,o.Lk)("div",null,(0,l.v_)(f.unixToReadable(e.cancelTime)),1),(0,o.Lk)("div",null,(0,l.v_)(f.unixToHours(e.cancelTime)),1)]),(0,o.Lk)("td",null,[(0,o.eW)((0,l.v_)(e.serviceName)+" ",1),(0,o.Lk)("div",null,(0,l.v_)(e.category),1)]),(0,o.Lk)("td",{style:(0,l.Tr)({color:e.color})},(0,l.v_)(e.empAlias),5),(0,o.Lk)("td",null,[(0,o.Lk)("div",null,(0,l.v_)(f.formatPhone(e.phoneNumber)),1),(0,o.eW)(" "+(0,l.v_)(e.contactName),1)]),(0,o.Lk)("td",null,[(0,o.eW)((0,l.v_)(f.unixTimeToReminder(e.date))+" ",1),(0,o.Lk)("div",null,(0,l.v_)(f.unixToReadable(e.date)),1),(0,o.Lk)("div",null,(0,l.v_)(f.secsToHours(e.start))+" - "+(0,l.v_)(f.secsToHours(e.end)),1)])],8,c)))),128))])]),(0,o.Lk)("div",m,[f.appos?.length===f.limit?((0,o.uX)(),(0,o.CE)("button",{key:0,id:"show",class:"blueBtn",onClick:n[2]||(n[2]=(...e)=>f.showMore&&f.showMore(...e))}," Show More ")):(0,o.Q3)("",!0)])],64)}t(4114);var h=t(144),p=t(1076),k=t(3519),v=t(6769),y=t(8297),T=t(1387),L=t(4714),g=t(445),C=t(8199);async function _(e,n){try{const t="",o=await fetch(`${t}/api/appointments/search_canceled_appointments`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e.trim(),limit:n})}),a=await o.json();if(o.ok){const e=[],n=a.appos;for(let t of n){const[n,o,a,l,c,r,s]=t,i=JSON.parse(a);i.cancelId=n,i.canceler={userId:o,contactName:c,profileName:r,phoneNum:s},i.cancelTime=l,e.push(i)}return e}(0,C.A)(a.message),console.log("Failed to search canceled appointments, message: ",a.message)}catch(t){console.error("Unexpected Error: ",t)}}async function w(){try{const e="",n=await fetch(`${e}/api/appointments/get_canceled_last_tracked`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await n.json();if(n.ok){const e=t.last_tracked;return console.log("last: ",e),e}console.log("Failed to last tracked on bookings, message: ",t.message)}catch(e){console.error("Unexpected Error: ",e)}}var b=t(2405),A={name:"CanceledAppos",setup(){const e=(0,h.KR)(""),n=(0,h.KR)([]),t=(0,h.KR)(null),a=(0,h.KR)(25),l=(0,g.A)(),c=(0,T.rd)(),r=async()=>{n.value=await _(e.value,a.value)},s=e=>{c.push(`/calendar/${e}`)},i=async()=>{a.value+=25,await r()};return(0,o.sV)((async()=>{t.value=await w(),await r()})),(0,T.JZ)(((e,n,t)=>{(0,b.p3)(),t()})),{today:l,query:e,appos:n,lastTracked:t,unixToReadable:p.A,unixTimeToReminder:k.A,unixToHours:y.A,secsToHours:v.A,formatPhone:L.A,onSearchCanceled:r,toDate:s,showMore:i,limit:a}}},x=t(1241);const N=(0,x.A)(A,[["render",f],["__scopeId","data-v-5917ea71"]]);var $=N}}]);
//# sourceMappingURL=759.1a16a3e8.js.map