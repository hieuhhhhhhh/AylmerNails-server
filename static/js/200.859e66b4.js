"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[200],{6744:function(e,t,n){n.d(t,{A:function(){return l}});var o=n(4116),a=n(6156);function l(e){if(console.log("calling"),!e)return null;const t=o.c9.fromISO(e,{zone:(0,a.A)()}),n=t.toSeconds();return console.log("date to unix: ",n),n}},4961:function(e,t,n){n.d(t,{A:function(){return a}});var o=n(4116);function a(e){if(console.log("calling"),!e)return 0;const t=o.c9.fromFormat(e,"HH:mm");if(!t.isValid)throw new Error("Invalid time format");const n=3600*t.hour+60*t.minute;return n}},9049:function(e,t,n){n.d(t,{A:function(){return l}});var o=n(4116),a=n(6156);function l(e){if(console.log("calling"),!e)return;const t=o.c9.fromMillis(1e3*e),n=t.setZone((0,a.A)()),l=n.toFormat("yyyy-MM-dd");return l}},7:function(e,t,n){function o(e){if(console.log("calling"),!e)return null;const t=Math.floor(e/3600),n=Math.floor(e%3600/60),o=String(t).padStart(2,"0"),a=String(n).padStart(2,"0");return`${o}:${a}`}n.d(t,{A:function(){return o}})},7907:function(e,t,n){n.d(t,{A:function(){return l}});n(4114),n(8992),n(3949);var o=n(445),a=n(8199);async function l(){try{const e="",t=await fetch(`${e}/api/employees/get_employees/${(0,o.A)()}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),n=await t.json();if(t.ok){const e=n.all_employees,t=[];return e.forEach((e=>{const[n,o,a,l,i]=e,s={employee_id:n,alias:o,last_date:a,is_active:l,color:i};t.push(s)})),console.log("emp: ",t),t}(0,a.A)(n.message),console.log("Failed to fetch employee list, message: ",n.message)}catch(e){console.error("Unexpected Error: ",e)}}},7200:function(e,t,n){n.r(t),n.d(t,{default:function(){return eo}});var o=n(6768),a=n(5130);const l={key:0,id:"layout"},i={id:"relative"},s={id:"scroll"},r={id:"flexBox"};function c(e,t,n,c,u,d){const p=(0,o.g2)("DayInput"),v=(0,o.g2)("ScrollContent"),m=(0,o.g2)("AppoDetails"),k=(0,o.g2)("FontAwesomeIcon"),g=(0,o.g2)("EditAppo"),y=(0,o.g2)("AddAppo");return c.unixDate?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{key:c.resetMain},[(0,o.bF)(p,{unixDate:c.unixDate,onInputDate:c.onInputDate,onMoveLeft:c.onMoveLeft,onMoveRight:c.onMoveRight,isCompacting:c.isCompacting,onCompact:c.onCompact},null,8,["unixDate","onInputDate","onMoveLeft","onMoveRight","isCompacting","onCompact"]),(0,o.Lk)("div",i,[(0,o.Lk)("div",s,[(0,o.bF)(v,{unixDate:c.unixDate,isCompacting:c.isCompacting,width:c.scrollWidth,onSelectAppo:c.onSelectAppo,NAMvisible:null==c.editId||!c.isAdding,onSelectNAM:c.onSelectNAM,EZstates:c.EZstates},null,8,["unixDate","isCompacting","width","onSelectAppo","NAMvisible","onSelectNAM","EZstates"])])]),c.appoId?((0,o.uX)(),(0,o.Wv)(m,{key:0,appoId:c.appoId,onCloseAppo:c.onCloseAppo,onEditAppo:c.onEditAppo},null,8,["appoId","onCloseAppo","onEditAppo"])):(0,o.Q3)("",!0),(0,o.Lk)("div",r,[c.isAdding||c.editId?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>c.onOpenAdding&&c.onOpenAdding(...e))},[(0,o.bF)(k,{icon:c.faPlus},null,8,["icon"]),t[1]||(t[1]=(0,o.eW)(" New "))]))])])),[[a.aG,!c.isHidingMain]]),c.editId?((0,o.uX)(),(0,o.Wv)(g,{key:0,id:"edit-appo",appoId:c.editId,onCancelEdit:c.onCancelEdit,onHideMain:c.onHideMain,onDoneEdit:c.onDoneEdit,NAMvalue:c.NAMvalue,setEZstates:c.setEZstates},null,8,["appoId","onCancelEdit","onHideMain","onDoneEdit","NAMvalue","setEZstates"])):(0,o.Q3)("",!0),c.isAdding?((0,o.uX)(),(0,o.Wv)(y,{key:1,unixDate:c.unixDate,onCancelAdding:c.onCancelAdding,onHideMain:c.onHideMain,onDoneEdit:c.onDoneEdit,NAMvalue:c.NAMvalue,setEZstates:c.setEZstates},null,8,["unixDate","onCancelAdding","onHideMain","onDoneEdit","NAMvalue","setEZstates"])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)}n(4114);var u=n(4232);const d={id:"flexBox"},p=["value"],v={key:1},m={id:"main"};function k(e,t,n,l,i,s){const r=(0,o.g2)("FontAwesomeIcon");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",d,[(0,o.Lk)("input",{type:"date",id:"datePicker",value:l.date,onChange:t[0]||(t[0]=(...e)=>l.onSelect&&l.onSelect(...e))},null,40,p),(0,o.eW)(" "+(0,u.v_)(l.unixToReadable(n.unixDate))+" ("+(0,u.v_)(l.unixTimeToReminder(n.unixDate))+") ",1),null==l.note?((0,o.uX)(),(0,o.CE)("button",{key:0,id:"addNote",onClick:t[1]||(t[1]=(...e)=>l.onOpenNote&&l.onOpenNote(...e))},[(0,o.bF)(r,{icon:l.faPen},null,8,["icon"])])):(0,o.Q3)("",!0),null!=l.note?((0,o.uX)(),(0,o.CE)("div",v,[(0,o.bo)((0,o.Lk)("textarea",{ref:"noteRef",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>l.note=e),rows:"3",placeholder:"Note",onChange:t[3]||(t[3]=(...e)=>l.onInputMessage&&l.onInputMessage(...e))},null,544),[[a.Jo,l.note]])])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",m,[(0,o.Lk)("button",{onClick:t[4]||(t[4]=e=>l.moveDay(-1))},[(0,o.bF)(r,{icon:l.backIcon},null,8,["icon"])]),(0,o.Lk)("div",null,[n.isCompacting?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[5]||(t[5]=(...e)=>l.moveLeft&&l.moveLeft(...e))},[(0,o.bF)(r,{icon:l.leftIcon},null,8,["icon"])])),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>l.moveEnd&&l.moveEnd(...e))},[(0,o.bF)(r,{icon:l.expandIcon},null,8,["icon"])]),n.isCompacting?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:t[7]||(t[7]=(...e)=>l.moveRight&&l.moveRight(...e))},[(0,o.bF)(r,{icon:l.rightIcon},null,8,["icon"])]))]),(0,o.Lk)("button",{onClick:t[8]||(t[8]=e=>l.moveDay(1))},[(0,o.bF)(r,{icon:l.nextIcon},null,8,["icon"])])])],64)}n(1454);var g=n(8249),y=n(2353),h=n(6744),f=n(9049),C=n(144),S=n(1076),E=n(3519),A=n(8199);async function L(e,t){try{t.length||(t=null);const n="",o=await fetch(`${n}/api/appointments/write_daily_note`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e,note:t})});if(o.ok)return!0;{const e=await o.json();(0,A.A)(e.message),console.log("Failed to write daily note, message: ",e.message)}}catch(n){console.error("Unexpected Error: ",n)}}async function b(e){try{const t="",n=await fetch(`${t}/api/appointments/get_daily_note/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();if(n.ok)return o.note;(0,A.A)(o.message),console.log("Failed to fetch daily note, message: ",o.message)}catch(t){console.error("Unexpected Error: ",t)}}var I={components:{FontAwesomeIcon:g.gc},props:{unixDate:Number,onInputDate:Function,onMoveLeft:Function,onMoveRight:Function,isCompacting:Boolean,onCompact:Function},setup(e){const t=(0,C.KR)(null),n=(0,C.KR)(null),a=(0,C.KR)(null),l=n=>{t.value=n.target.value,e.onInputDate((0,h.A)(t.value))},i=n=>{const[o,a,l]=t.value.split("-").map(Number),i=new Date(Date.UTC(o,a-1,l));i.setUTCDate(i.getUTCDate()+n),t.value=i.toISOString().split("T")[0],e.onInputDate((0,h.A)(t.value))},s=()=>{e.onMoveLeft()},r=()=>{e.onMoveRight()},c=()=>{e.onCompact()},u=()=>{L(e.unixDate,a.value)},d=()=>{a.value="",(0,o.dY)((()=>{n.value?.focus()}))},p=()=>{n.value&&(n.value.style.height="auto",n.value.style.height=`${n.value.scrollHeight+2}px`)};return t.value=(0,f.A)(e.unixDate),(0,o.wB)((()=>e.unixDate),(async e=>{t.value=(0,f.A)(e),a.value=await b(e),(0,o.dY)((()=>{p()}))})),(0,o.wB)(a,(()=>{p()})),{date:t,note:a,noteRef:n,onSelect:l,moveDay:i,moveLeft:s,moveRight:r,moveEnd:c,backIcon:y.rCU,nextIcon:y.UHg,leftIcon:y.Uec,rightIcon:y.vmR,expandIcon:y.oZK,faPen:y.hpd,unixTimeToReminder:E.A,unixToReadable:S.A,onInputMessage:u,onOpenNote:d,autoResize:p}}},N=n(1241);const _=(0,N.A)(I,[["render",k],["__scopeId","data-v-2f33ab50"]]);var w=_;const D={key:0},O={id:"relative"},x=["onClick"],F={class:"time"},P={class:"bold"};function R(e,t,n,l,i,s){const r=(0,o.g2)("MarkingValues"),c=(0,o.g2)("GrayPart"),d=(0,o.g2)("EditingZone"),p=(0,o.g2)("VerticalTimeMarks");return l.isFetched&&l.dayEnd&&l.dayStart?((0,o.uX)(),(0,o.CE)("div",D,[(0,o.Lk)("div",{style:(0,u.Tr)({transform:`scale(${l.scaleValue})`,transformOrigin:"top left"})},[(0,o.bF)(r,{dayEnd:l.dayEnd,dayStart:l.dayStart},null,8,["dayEnd","dayStart"])],4),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.employees,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t},[(0,o.Lk)("div",O,[(0,o.Lk)("div",{id:"transform",style:(0,u.Tr)({transform:`scale(${l.scaleValue})`,marginBottom:70*-(1-l.scaleValue)+"px"})},[(0,o.bF)(c,{dayStart:l.dayStart,dayEnd:l.dayEnd,start:e.start,end:e.end},null,8,["dayStart","dayEnd","start","end"]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.appos,((t,i)=>((0,o.uX)(),(0,o.CE)("div",{id:"appo",key:i,style:(0,u.Tr)({left:l.getLeft(t)+"px",width:l.getWidth(t)+"px",backgroundColor:e.colorCode}),onClick:(0,a.D$)((e=>n.onSelectAppo(t.id)),["stop"])},[(0,o.Lk)("div",F,(0,u.v_)(l.formatTime(t.start)),1),(0,o.eW)(" "+(0,u.v_)(t.contactName)+" ",1),(0,o.Lk)("div",P,(0,u.v_)(t.serviceName),1)],12,x)))),128)),null!=n.EZstates?((0,o.uX)(),(0,o.Wv)(d,{key:0,empId:e.id,date:n.unixDate,dayStart:l.dayStart,EZstates:n.EZstates},null,8,["empId","date","dayStart","EZstates"])):(0,o.Q3)("",!0),(0,o.bF)(p,{dayStart:l.dayStart,dayEnd:l.dayEnd,NAMvisible:n.NAMvisible,onSelectNAM:t=>{n.onSelectNAM(t,e.id,e.alias,e.colorCode,n.unixDate)}},null,8,["dayStart","dayEnd","NAMvisible","onSelectNAM"])],4)]),(0,o.Lk)("div",{id:"empAlias",style:(0,u.Tr)({backgroundColor:e.colorCode,fontSize:14*l.scaleValue+"px",padding:5*l.scaleValue+"px"})},(0,u.v_)(e.alias),5)])))),128)),(0,o.Lk)("div",{style:(0,u.Tr)({transform:`scale(${l.scaleValue})`,transformOrigin:"top left"})},[(0,o.bF)(r,{dayEnd:l.dayEnd,dayStart:l.dayStart},null,8,["dayEnd","dayStart"])],4)])):(0,o.Q3)("",!0)}async function T(e){try{const t="",n=await fetch(`${t}/api/appointments/get_daily_appos/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();if(n.ok)return X(o);(0,A.A)(o.message),console.log("Failed to fetch daily appointments, message: ",o.message)}catch(t){console.error("Unexpected Error: ",t)}}function X(e){const t={};let n=null,o=null;const{employees:a,appos:l}=e;for(let i of a){const[e,a,,l,s,r]=i,c={id:e,alias:a,colorCode:l,start:s,end:r,appos:[]};t[e]=c,(s&&s<n||!n)&&(n=s),(r&&r>o||!o)&&(o=r)}for(let i of l){const[e,n,o,a,l,s,r]=i,c={id:e,start:n,end:o,empId:a,serviceName:l,phoneNum:s,contactName:r};t[a]?.appos.push(c)}return console.log("appos",l),{employees:Object.values(t),dayStart:n,dayEnd:o}}var M=n(6769);const K=140;function $(e){const t=K/60/60;return e*t}function B(e,t){console.log("oldWidth",e);const n=(t-6)/e;return n}function W(e){const t=e/K,n=60*t*60;return n}const U={id:"main"},j={};var Q=Object.assign(j,{__name:"NewAppoMark",props:{time:Number,activeKey:Number,NAMvisible:Boolean,onSelectNAM:Function},setup(e){const t=e,n=(0,C.KR)(!1),a=(0,C.KR)(null),l=(0,o.EW)((()=>$(t.time))),i=$(900);function s(){n.value=!1}return(0,o.wB)((()=>t.activeKey),(()=>{n.value=!0,(0,o.dY)((()=>{a.value?.focus()}))})),(t,r)=>((0,o.uX)(),(0,o.CE)("div",U,[n.value&&e.NAMvisible?((0,o.uX)(),(0,o.CE)("div",{key:0,id:"content",ref_key:"divRef",ref:a,tabindex:"0",onBlur:s,onClick:r[0]||(r[0]=t=>e.onSelectNAM(e.time)),style:(0,u.Tr)({left:l.value+"px",width:(0,C.R1)(i)+"px"})},(0,u.v_)((0,C.R1)(M.A)(e.time)),37)):(0,o.Q3)("",!0)]))}});const q=(0,N.A)(Q,[["__scopeId","data-v-6ed0d5c2"]]);var H=q;const V=["onClick"],Z={components:{NewAppoMark:H}};var J=Object.assign(Z,{__name:"VerticalTimeMarks",props:{dayStart:Number,dayEnd:Number,NAMvisible:Boolean,onSelectNAM:Function,EZvisible:Boolean},setup(e){const t=(0,C.KR)(0),n=(0,C.KR)(0),a=e;function l(e,o){const a=W(e.offsetX)+60*o*60;t.value=a-a%900,n.value++}const i=(0,o.EW)((()=>$(a.dayEnd||86400))),s=(0,o.EW)((()=>-$(a.dayStart||0)));return(0,o.sV)((()=>{console.log("dayEnd",a.dayEnd),console.log("dayStart",a.dayStart)})),(a,r)=>((0,o.uX)(),(0,o.CE)("div",{id:"container",style:(0,u.Tr)({width:i.value+"px",marginLeft:s.value+"px"})},[(0,o.bF)(H,{time:t.value,activeKey:n.value,NAMvisible:e.NAMvisible,onSelectNAM:e.onSelectNAM},null,8,["time","activeKey","NAMvisible","onSelectNAM"]),((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(24,(e=>(0,o.Lk)("div",{key:e,class:"verticalLine",style:(0,u.Tr)({width:(0,C.R1)($)(3600)+"px"}),onClick:t=>l(t,e-1)},null,12,V))),64))],4))}});const G=(0,N.A)(J,[["__scopeId","data-v-2fd5e6be"]]);var Y=G;const z={key:0},ee={key:1};function te(e,t,n,l,i,s){return n.start&&n.end?((0,o.uX)(),(0,o.CE)("div",z,[(0,o.Lk)("div",{id:"grayPart",style:(0,u.Tr)({width:s.getStartWidth()+"px"}),onClick:t[0]||(t[0]=(0,a.D$)((()=>{}),["stop"]))},null,4),(0,o.Lk)("div",{id:"grayPart",style:(0,u.Tr)({width:s.getEndWidth()+"px",marginLeft:s.getEndMargin()+"px"}),onClick:t[1]||(t[1]=(0,a.D$)((()=>{}),["stop"]))},null,4)])):((0,o.uX)(),(0,o.CE)("div",ee,[(0,o.Lk)("div",{id:"grayPart",style:(0,u.Tr)({width:s.getDefaultWidth()+"px"})},null,4)]))}var ne={props:{dayStart:Number,dayEnd:Number,start:Number,end:Number},methods:{getStartWidth(){return $(Math.abs(this.start-this.dayStart))},getEndWidth(){return $(Math.abs(this.dayEnd-this.end))},getEndMargin(){return $(Math.abs(this.end-this.dayStart))},getDefaultWidth(){return $(Math.abs(this.dayEnd-this.dayStart))}}};const oe=(0,N.A)(ne,[["render",te],["__scopeId","data-v-be160ff2"]]);var ae=oe;function le(e,t,n,a,l,i){return(0,o.uX)(),(0,o.CE)("div",{id:"container",style:(0,u.Tr)({width:a.width()+"px",marginLeft:a.marginLeft()+"px"})},[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(24,(e=>(0,o.Lk)("div",{key:e,class:"verticalLine",style:(0,u.Tr)({width:a.secsToLength(3600)+"px"})},(0,u.v_)(a.formatHour(e-1)),5))),64))],4)}var ie={props:{dayStart:Number,dayEnd:Number},setup(e){console.log("dayEnd",e.dayEnd),console.log("dayStart",e.dayStart);const t=()=>$(e.dayEnd||86400),n=()=>-$(e.dayStart||0),o=e=>{const t=e<12?"am":"pm",n=e%12||12;return`${n} ${t}`};return{width:t,marginLeft:n,secsToLength:$,formatHour:o}}};const se=(0,N.A)(ie,[["render",le],["__scopeId","data-v-081be6d2"]]);var re=se;const ce={key:0,id:"main"},ue={};var de=Object.assign(ue,{__name:"EditingZone",props:{empId:Number,date:Number,dayStart:Number,EZstates:Object},setup(e){const t=e,n=(0,o.EW)((()=>$(t.EZstates.start))),a=(0,o.EW)((()=>$(t.EZstates.duration))),l=(0,o.EW)((()=>-$(t.dayStart||0)));return(t,i)=>e.EZstates.date==e.date&&e.EZstates.empId==e.empId?((0,o.uX)(),(0,o.CE)("div",ce,[(0,o.Lk)("div",{id:"content",style:(0,u.Tr)({left:n.value+"px",width:a.value+"px",marginLeft:l.value+"px"})},null,4)])):(0,o.Q3)("",!0)}});const pe=(0,N.A)(de,[["__scopeId","data-v-0288c6fe"]]);var ve=pe,me={props:{unixDate:Number,isCompacting:Boolean,width:Number,onSelectAppo:Function,NAMvisible:Boolean,onSelectNAM:Function,EZstates:Object},components:{VerticalTimeMarks:Y,GrayPart:ae,MarkingValues:re,EditingZone:ve},setup(e){const t=(0,C.KR)(!1),n=(0,C.KR)([]),a=(0,C.KR)(null),l=(0,C.KR)(null),i=(0,C.KR)(1),s=(0,C.KR)(0),r=(0,C.lW)(e,"unixDate"),c=(0,C.lW)(e,"isCompacting"),u=(0,C.lW)(e,"width"),d=e=>$(e.start-a.value),p=e=>$(e.end-e.start),v=e=>(0,M.A)(e),m=e=>{if(!e)return;console.log("newWidth:",e);const t=B(s.value,e);t<1&&(i.value=t),console.log("scale:",i.value)},k=async()=>{t.value=!1;const o=await T(e.unixDate);console.log("dayInfo",o),o&&(n.value=o.employees,a.value=o.dayStart,l.value=o.dayEnd,s.value=$(l.value-a.value),t.value=!0)};return(0,o.sV)(k),(0,o.wB)(r,k),(0,o.wB)([c,u,s],(([t])=>{console.log("width",e.width),t?m(e.width):i.value=1})),{isFetched:t,employees:n,dayStart:a,dayEnd:l,scaleValue:i,getLeft:d,getWidth:p,formatTime:v}}};const ke=(0,N.A)(me,[["render",R],["__scopeId","data-v-ab669bb8"]]);var ge=ke;const ye={id:"parent"},he={id:"content"};function fe(e,t,n,a,l,i){const s=(0,o.g2)("FontAwesomeIcon"),r=(0,o.g2)("AppoInfo"),c=(0,o.g2)("DeleteBtn");return(0,o.uX)(),(0,o.CE)("div",ye,[(0,o.Lk)("div",{id:"background",onClick:t[0]||(t[0]=(...e)=>n.onCloseAppo&&n.onCloseAppo(...e))}),(0,o.Lk)("div",{id:"window",style:(0,u.Tr)({backgroundColor:a.details.color})},[(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>n.onCloseAppo&&n.onCloseAppo(...e)),id:"closeBtn",class:"redBtn"},[(0,o.bF)(s,{icon:a.faXmark},null,8,["icon"])]),(0,o.Lk)("div",he,[(0,o.bF)(r,{details:a.details},null,8,["details"]),(0,o.bF)(c,{appoId:a.details.id,onEditAppo:n.onEditAppo,savedOn:a.details.savedOn},null,8,["appoId","onEditAppo","savedOn"])])],4)])}async function Ce(e){try{const t="",n=await fetch(`${t}/api/appointments/get_appo_details/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();if(n.ok)return Se(o);(0,A.A)(o.message),console.log("Failed to fetch appo details, message: ",o.message)}catch(t){console.error("Unexpected Error: ",t)}}function Se(e){let t={};const[n,o,a,l,i,s,r,c,u,d,p,v,m,k,g,y,h,f,C,S]=e.appo_details;t={id:n,empId:o,serviceId:a,AOSOs:JSON.parse(l),date:i,start:s,end:r,message:c,note:u,color:d,empAlias:p,serviceName:v,cateName:m,phoneNumId:k,phoneNum:g,userId:y,contactName:h,savedOn:f,bookerId:C,bookerName:S,AOSOsText:[],selectedEmps:[]};const E=e.appo_emps;for(let L of E){const[e,n]=L,o={empId:e,empAlias:n};t.selectedEmps.push(o)}const A=e.AOSOs;for(let L of A){const[e,n,o,a,l]=L[0],i={id:e,question:n,optionId:o,answer:a,offset:l};t.AOSOsText.push(i)}return console.log("details",t),t}const Ee={class:"duo"},Ae={key:0,class:"duo"},Le={class:"duo"},be={key:0,class:"selected"},Ie={class:"duo"},Ne={key:0},_e={id:"message"};function we(e,t,n,l,i,s){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("table",null,[t[15]||(t[15]=(0,o.Lk)("colgroup",null,[(0,o.Lk)("col",{style:{width:"auto"}}),(0,o.Lk)("col",{style:{width:"80%"}})],-1)),(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[7]||(t[7]=(0,o.Lk)("th",null,"Date Time",-1)),(0,o.Lk)("td",null,[(0,o.eW)((0,u.v_)(l.getTime),1),t[6]||(t[6]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)((0,u.v_)(l.getDate)+" "+(0,u.v_)(l.getReminder),1)])]),(0,o.Lk)("tr",null,[t[8]||(t[8]=(0,o.Lk)("th",null,"Client",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Ee,[(0,o.Lk)("div",null,[(0,o.eW)((0,u.v_)(l.formatPhone(n.details.phoneNum))+" ",1),(0,o.Lk)("div",null,(0,u.v_)(n.details.contactName),1)]),(0,o.Lk)("div",null,[n.details.userId?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"infoBtn",onClick:t[0]||(t[0]=e=>l.toUser())}," i ")):(0,o.Q3)("",!0)])])])]),(0,o.Lk)("tr",null,[t[9]||(t[9]=(0,o.Lk)("th",null,"Service",-1)),(0,o.Lk)("td",null,[n.details.serviceName?((0,o.uX)(),(0,o.CE)("div",Ae,[(0,o.Lk)("div",null,(0,u.v_)(n.details.serviceName)+" - "+(0,u.v_)(n.details.cateName),1),(0,o.Lk)("button",{class:"infoBtn",onClick:t[1]||(t[1]=(...e)=>l.toService&&l.toService(...e))},"i")])):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.details.AOSOsText,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{id:"AOS",key:t},(0,u.v_)(e.question)+" ~ "+(0,u.v_)(e.answer)+" "+(0,u.v_)(l.formatOffset(e.offset)),1)))),128))])]),(0,o.Lk)("tr",null,[t[11]||(t[11]=(0,o.Lk)("th",null,"Duration",-1)),(0,o.Lk)("td",null,[(0,o.eW)((0,u.v_)(l.getDuration+" mins")+" ",1),t[10]||(t[10]=(0,o.Lk)("br",null,null,-1)),(0,o.eW)("(to "+(0,u.v_)(l.getEndTime)+")",1)])]),(0,o.Lk)("tr",null,[t[12]||(t[12]=(0,o.Lk)("th",null,"Employee",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Le,[(0,o.eW)((0,u.v_)(n.details.empAlias)+" ",1),n.details.empId?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"infoBtn",onClick:t[2]||(t[2]=(...e)=>l.toEmployee&&l.toEmployee(...e))}," i ")):(0,o.Q3)("",!0)]),n.details.selectedEmps?.length?((0,o.uX)(),(0,o.CE)("div",be," (client selected: "+(0,u.v_)(n.details.selectedEmps?.map((e=>e.empAlias)).join(", "))+") ",1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("tr",null,[t[13]||(t[13]=(0,o.Lk)("th",null,"Booker",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Ie,[(0,o.Lk)("div",null,(0,u.v_)(n.details.bookerName),1),(0,o.Lk)("div",null,[n.details.bookerId?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"infoBtn",onClick:t[3]||(t[3]=e=>l.toUser(n.details.bookerId))}," i ")):(0,o.Q3)("",!0)])])])]),n.details.message?((0,o.uX)(),(0,o.CE)("tr",Ne,[t[14]||(t[14]=(0,o.Lk)("th",null,"Message",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",_e,(0,u.v_)(n.details.message),1)])])):(0,o.Q3)("",!0)])]),(0,o.bo)((0,o.Lk)("textarea",{id:"note",ref:"noteRef",type:"text",rows:"3","onUpdate:modelValue":t[4]||(t[4]=e=>l.note=e),onChange:t[5]||(t[5]=(...e)=>l.onInputNote&&l.onInputNote(...e)),placeholder:"Note (not visible to client)"},null,544),[[a.Jo,l.note]])],64)}var De=n(4714),Oe=n(1387);async function xe(e,t){try{t.length||(t=null);const n="",o=await fetch(`${n}/api/appointments/write_appointment_note`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({appo_id:e,note:t})});if(o.ok)return!0;{const e=await o.json();(0,A.A)(e.message),console.log("Failed to write appo note, message: ",e.message)}}catch(n){console.error("Unexpected Error: ",n)}}var Fe={props:{details:Object},setup(e){const t=(0,Oe.rd)(),n=(0,C.KR)(""),a=(0,C.KR)(null),l=e=>{if(0===e)return;let t=e>=0?"+":"-",n=Math.abs(Math.floor(e/60));return`(${t}${n} mins)`},i=(0,o.EW)((()=>(0,M.A)(e.details.start))),s=(0,o.EW)((()=>{const t=e.details.date+43200;return(0,S.A)(t)})),r=(0,o.EW)((()=>{const t=e.details.date+43200,n=(0,E.A)(t);return n?`(${n})`:""})),c=(0,o.EW)((()=>{const t=e.details.end-e.details.start;return t/60})),u=(0,o.EW)((()=>{const t=e.details.end;return(0,M.A)(t)})),d=()=>{t.push(`/services/details/${e.details.serviceId}`)},p=()=>{t.push(`/employees/details/${e.details.empId}`)},v=(n=e.details.userId)=>{t.push(`/users/${n}`)},m=()=>{xe(e.details.id,n.value)},k=()=>{a.value&&(a.value.style.height="auto",a.value.style.height=`${a.value.scrollHeight+2}px`)};return(0,o.wB)((()=>e.details.note),(e=>{n.value=e,(0,o.dY)((()=>{k()}))})),(0,o.wB)(n,(()=>{k()})),{note:n,noteRef:a,formatOffset:l,formatPhone:De.A,getTime:i,getDate:s,getDuration:c,getEndTime:u,getReminder:r,toService:d,toEmployee:p,toUser:v,onInputNote:m}}};const Pe=(0,N.A)(Fe,[["render",we],["__scopeId","data-v-16e05d7c"]]);var Re=Pe;const Te={key:0,id:"flexBox"};function Xe(e,t,n,a,l,i){const s=(0,o.g2)("FontAwesomeIcon"),r=(0,o.g2)("ConfirmDelete");return a.isDeletingAppo?((0,o.uX)(),(0,o.Wv)(r,{key:1,appoId:n.appoId},null,8,["appoId"])):((0,o.uX)(),(0,o.CE)("div",Te,[null==n.savedOn?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"btn",onClick:t[0]||(t[0]=e=>a.onSaveUnsaveAppo())},[(0,o.bF)(s,{icon:a.faBookmark},null,8,["icon"]),t[4]||(t[4]=(0,o.eW)(" Save "))])):((0,o.uX)(),(0,o.CE)("button",{key:1,class:"btn",onClick:t[1]||(t[1]=e=>a.onSaveUnsaveAppo())},[(0,o.bF)(s,{icon:a.regularBM},null,8,["icon"]),t[5]||(t[5]=(0,o.eW)(" Unsave "))])),(0,o.Lk)("button",{class:"btn",onClick:t[2]||(t[2]=e=>n.onEditAppo(n.appoId))},[(0,o.bF)(s,{icon:a.faPen},null,8,["icon"]),t[6]||(t[6]=(0,o.eW)(" Edit "))]),(0,o.Lk)("button",{id:"delete",class:"btn",onClick:t[3]||(t[3]=(...e)=>a.onDelete&&a.onDelete(...e))},[(0,o.bF)(s,{icon:a.faTrash},null,8,["icon"]),t[7]||(t[7]=(0,o.eW)(" Delete "))])]))}const Me={id:"main"};function Ke(e,t,n,l,i,s){return(0,o.uX)(),(0,o.CE)("div",Me,[t[2]||(t[2]=(0,o.Lk)("div",{id:"title"},"Permanently remove this appointment?",-1)),t[3]||(t[3]=(0,o.Lk)("label",null,'Type "yes" to confirm',-1)),(0,o.bo)((0,o.Lk)("input",{ref:"inputRef",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.text=e),onInput:t[1]||(t[1]=(...e)=>l.onInput&&l.onInput(...e)),placeholder:"yes"},null,544),[[a.Jo,l.text]])])}async function $e(e){try{const t="",n=await fetch(`${t}/api/appointments/admin_remove_appointment`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({appo_id:e})});if(n.ok)return!0;{const e=await n.json();(0,A.A)(e.message),console.log("Failed to remove appointment, message: ",e.message)}}catch(t){console.error("Unexpected Error: ",t)}}var Be={props:{appoId:Number},setup(e){const t=(0,Oe.rd)(),n=(0,Oe.lq)(),a=(0,C.KR)(""),l=(0,C.KR)(null),i=async()=>{if("yes"===a.value.trim().toLowerCase()){const o=await $e(e.appoId);o&&(await t.push(n.path.split("/").slice(0,-1).join("/")||"/"),t.push("/refresh"))}};return(0,o.sV)((()=>{l.value&&l.value.focus()})),{text:a,inputRef:l,onInput:i}}};const We=(0,N.A)(Be,[["render",Ke],["__scopeId","data-v-3273f055"]]);var Ue=We,je=n(92);async function Qe(e,t){try{const n="",o=await fetch(`${n}/api/appointments/save_unsave_appo`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({appo_id:e,boolean:t})});if(o.ok)return!0;{const e=await o.json();(0,A.A)(e.message),console.log("Failed to save/unsave appointment, message: ",e.message)}}catch(n){console.error("Unexpected Error: ",n)}}var qe={components:{ConfirmDelete:Ue,FontAwesomeIcon:g.gc},props:{appoId:Number,onEditAppo:Function,savedOn:Number},setup(e){const t=(0,C.KR)(!1),n=(0,Oe.rd)(),o=()=>{t.value=!0},a=async()=>{const t=await Qe(e.appoId,null==e.savedOn);t&&n.push("/refresh")};return{isDeletingAppo:t,onDelete:o,faTrash:y.yLS,faPen:y.hpd,faBookmark:y.G06,regularBM:je.G06,onSaveUnsaveAppo:a}}};const He=(0,N.A)(qe,[["render",Xe],["__scopeId","data-v-6a650cf2"]]);var Ve=He,Ze={name:"AppoDetails",components:{AppoInfo:Re,DeleteBtn:Ve,FontAwesomeIcon:g.gc},props:{appoId:Number,onCloseAppo:Function,onEditAppo:Function},setup(e){const t=(0,C.KR)({}),n=async()=>{t.value=await Ce(e.appoId),t.value||e.onCloseAppo()};return(0,o.sV)(n),(0,o.wB)((()=>e.appoId),(()=>{n()})),{details:t,faXmark:y.Jyw}}};const Je=(0,N.A)(Ze,[["render",fe],["__scopeId","data-v-13eef5cc"]]);var Ge=Je;const Ye={class:"flexBox"},ze={id:"box"},et={id:"closeBox"},tt={class:"flexBox"},nt={id:"save"};function ot(e,t,n,l,i,s){const r=(0,o.g2)("AppoEdit"),c=(0,o.g2)("FontAwesomeIcon"),d=(0,o.g2)("EmployeePicker"),p=(0,o.g2)("ServicePicker"),v=(0,o.g2)("ContactPicker");return(0,o.uX)(),(0,o.CE)("div",null,[l.isPickingEmp||l.isPickingService||l.isPickingContact?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("form",{key:0,onSubmit:t[1]||(t[1]=(0,a.D$)(((...e)=>l.onSubmit&&l.onSubmit(...e)),["prevent"])),id:"container"},[(0,o.Lk)("div",Ye,[(0,o.Lk)("div",ze,[(0,o.Lk)("div",et,[(0,o.Lk)("button",{class:"redBtn",onClick:t[0]||(t[0]=(0,a.D$)(((...e)=>n.onCancelEdit&&n.onCancelEdit(...e)),["prevent"]))},"X")]),t[3]||(t[3]=(0,o.Lk)("div",{id:"top"},[(0,o.Lk)("div",{id:"title"},"Editing")],-1)),(0,o.Lk)("div",{id:"content",style:(0,u.Tr)({backgroundColor:l.color})},[(0,o.bF)(r,{contactName:l.contactName,phoneNum:l.phoneNum,serviceName:l.serviceName,AOSOs:l.AOSOsText,category:l.category,empAlias:l.empAlias,selectedEmps:l.selectedEmps,date:l.date,start:l.start,duration:l.duration,message:l.message,note:l.note,setDate:l.setDate,setStart:l.setStart,setDuration:l.setDuration,setNote:l.setNote,resetEmp:l.resetEmp,resetService:l.resetService,onOpenEmpPicker:l.onOpenEmpPicker,onOpenServicePicker:l.onOpenServicePicker,onSelectContact:l.onSelectContact,onClearContact:l.onClearContact,onClearService:l.onClearService},null,8,["contactName","phoneNum","serviceName","AOSOs","category","empAlias","selectedEmps","date","start","duration","message","note","setDate","setStart","setDuration","setNote","resetEmp","resetService","onOpenEmpPicker","onOpenServicePicker","onSelectContact","onClearContact","onClearService"])],4),(0,o.Lk)("div",tt,[(0,o.Lk)("button",nt,[(0,o.bF)(c,{icon:l.faCheck},null,8,["icon"]),t[2]||(t[2]=(0,o.eW)(" Finish "))])])])])],32)),l.isPickingEmp?((0,o.uX)(),(0,o.Wv)(d,{key:1,date:l.date,setEmp:l.setEmp,onStopPicking:l.onStopPicking},null,8,["date","setEmp","onStopPicking"])):(0,o.Q3)("",!0),l.isPickingService?((0,o.uX)(),(0,o.Wv)(p,{key:2,date:l.date,setService:l.setService,onStopPicking:l.onStopPicking},null,8,["date","setService","onStopPicking"])):(0,o.Q3)("",!0),l.isPickingContact?((0,o.uX)(),(0,o.Wv)(v,{key:3,_phoneNum:l.phoneNum,_name:l.contactName,setContact:l.setContact,onStopPicking:l.onStopPicking},null,8,["_phoneNum","_name","setContact","onStopPicking"])):(0,o.Q3)("",!0)])}async function at(e,t,n,o,a,l,i,s,r,c,u,d){try{const p="",v=await fetch(`${p}/api/appointments/update_appointment`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({appo_id:e,phone_num:t,name:n,service_id:o,AOSOs:a,emp_id:l,date:i,start:s,end:s+r,selected_emps:c,message:u,note:d})}),m=await v.json();if(v.ok)return m.appo_id;{let e="An error occurred";1==m.error_type?e=`Overlapping appointment ${(0,M.A)(m.start)} to ${(0,M.A)(m.end)}`:2==m.error_type&&(e=`Schedule is from ${(0,M.A)(m.start)} to ${(0,M.A)(m.end)}`),(0,A.A)(e),console.log("Failed to add appointment, message: ",m.message)}}catch(p){console.error("Unexpected Error: ",p)}}async function lt(e,t,n){try{if(!e||!t)return;const o="",a=await fetch(`${o}/api/appointments/get_appo_length`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_id:e,employee_id:t,AOSOs:n})}),l=await a.json();if(a.ok)return l.length;console.log("Failed to fetch appointment length, message: ",l.message)}catch(o){console.error("Unexpected Error: ",o)}}const it={class:"center"},st=["value"],rt={class:"center"},ct=["value"],ut={class:"center"},dt=["value"],pt={class:"duo"},vt={class:"duo"},mt={key:0},kt={class:"duo"},gt={key:0,class:"selected"},yt={key:0},ht=["value"];function ft(e,t,n,l,i,s){return(0,o.uX)(),(0,o.CE)("table",null,[t[22]||(t[22]=(0,o.Lk)("colgroup",null,[(0,o.Lk)("col",{style:{width:"auto"}}),(0,o.Lk)("col",{style:{width:"80%"}})],-1)),(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[15]||(t[15]=(0,o.Lk)("th",null,"Date",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",it,[(0,o.Lk)("div",null,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(0,a.D$)((e=>l.onIncreaseDate(!1)),["prevent"]))},"-"),(0,o.Lk)("input",{type:"date",value:l.parseUT(n.date),onChange:t[1]||(t[1]=(...e)=>l.onInputDate&&l.onInputDate(...e)),required:""},null,40,st),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(0,a.D$)((e=>l.onIncreaseDate(!0)),["prevent"]))},"+")]),(0,o.eW)(" "+(0,u.v_)(l.getReminder),1)])])]),(0,o.Lk)("tr",null,[t[16]||(t[16]=(0,o.Lk)("th",null,"Time",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",rt,[(0,o.Lk)("div",null,[(0,o.Lk)("button",{onClick:t[3]||(t[3]=(0,a.D$)((e=>l.onIncreaseTime(!1)),["prevent"]))},"-"),(0,o.Lk)("input",{type:"time",value:l.parseUnixHours(n.start),onChange:t[4]||(t[4]=(...e)=>l.onInputStart&&l.onInputStart(...e)),required:""},null,40,ct),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(0,a.D$)((e=>l.onIncreaseTime(!0)),["prevent"]))},"+")])])])]),(0,o.Lk)("tr",null,[t[17]||(t[17]=(0,o.Lk)("th",null,"Duration (mins)",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",ut,[(0,o.Lk)("div",null,[(0,o.Lk)("button",{onClick:t[6]||(t[6]=(0,a.D$)((e=>l.onIncreaseDuration(!1)),["prevent"]))},"-"),(0,o.Lk)("input",{type:"number",value:n.duration/60,onInput:t[7]||(t[7]=(...e)=>l.onInputDuration&&l.onInputDuration(...e)),onFocus:t[8]||(t[8]=e=>{e.target.select()}),required:"",min:5,step:"1"},null,40,dt),(0,o.Lk)("button",{onClick:t[9]||(t[9]=(0,a.D$)((e=>l.onIncreaseDuration(!0)),["prevent"]))},"+")]),(0,o.eW)(" to "+(0,u.v_)(l.secsToHours(n.start+n.duration)),1)])])]),(0,o.Lk)("tr",null,[t[18]||(t[18]=(0,o.Lk)("th",null,"Client",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",pt,[(0,o.Lk)("div",null,[(0,o.eW)((0,u.v_)(l.formatPhone(n.phoneNum))+" ",1),(0,o.Lk)("div",null,(0,u.v_)(n.contactName),1)]),(0,o.Lk)("div",null,[n.phoneNum?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[10]||(t[10]=(...e)=>n.onClearContact&&n.onClearContact(...e))},"X")):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>n.onSelectContact&&n.onSelectContact(...e))},"Select")])])])]),(0,o.Lk)("tr",null,[t[19]||(t[19]=(0,o.Lk)("th",null,"Service",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",vt,[(0,o.Lk)("div",null,[n.serviceName?((0,o.uX)(),(0,o.CE)("div",mt,(0,u.v_)(n.serviceName)+" - "+(0,u.v_)(n.category),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",null,[n.serviceName?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[12]||(t[12]=(...e)=>n.onClearService&&n.onClearService(...e))},"X")):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>n.onOpenServicePicker&&n.onOpenServicePicker(...e))},"Select")])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.AOSOs,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{id:"AOS",key:t},(0,u.v_)(e.question)+" ~ "+(0,u.v_)(e.answer)+" "+(0,u.v_)(l.formatOffset(e.offset)),1)))),128))])]),(0,o.Lk)("tr",null,[t[20]||(t[20]=(0,o.Lk)("th",null,"Employee",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",kt,[(0,o.eW)((0,u.v_)(n.empAlias)+" ",1),(0,o.Lk)("div",null,[(0,o.Lk)("button",{onClick:t[14]||(t[14]=(0,a.D$)(((...e)=>n.onOpenEmpPicker&&n.onOpenEmpPicker(...e)),["prevent"]))},"Select")])]),n.selectedEmps?.length?((0,o.uX)(),(0,o.CE)("div",gt," (client selected: "+(0,u.v_)(n.selectedEmps?.map((e=>e.empAlias)).join(", "))+") ",1)):(0,o.Q3)("",!0)])]),n.message?((0,o.uX)(),(0,o.CE)("tr",yt,[t[21]||(t[21]=(0,o.Lk)("th",null,"Message",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("textarea",{id:"message",value:n.message,rows:"3",disabled:""},null,8,ht)])])):(0,o.Q3)("",!0)])])}var Ct=n(4961),St=n(7),Et={props:{contactName:String,phoneNum:String,serviceName:String,category:String,AOSOs:Array,empAlias:String,selectedEmps:Array,date:Number,start:Number,duration:Number,message:String,note:String,setDate:Function,setStart:Function,setDuration:Function,setNote:Function,onOpenEmpPicker:Function,onOpenServicePicker:Function,onSelectContact:Function,onClearService:Function,onClearContact:Function},setup(e){const t=t=>{const n=(0,Ct.A)(t.target.value);e.setStart(n)},n=t=>{const n=(0,h.A)(t.target.value);e.setDate(n)},a=t=>{const n=60*t.target.value;e.setDuration(n)},l=t=>{const n=t.target.value;e.setNote(n),p()},i=t=>{const n=t?900:-900;e.setStart(e.start+n)},s=t=>{const n=t?900:-900;e.setDuration(e.duration+n)},r=t=>{const n=t?86400:-86400;e.setDate(e.date+n)},c=e=>{if(0===e)return;let t=e>=0?"+":"-",n=Math.abs(Math.floor(e/60));return`(${t}${n} mins)`},u=(0,o.EW)((()=>{const t=e.date+43200,n=(0,E.A)(t);return`${n}`})),d=(0,C.KR)(null),p=()=>{(0,o.dY)((()=>{const e=d.value;e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")}))};return(0,o.sV)((()=>{p()})),{TAref:d,formatOffset:c,formatPhone:De.A,onInputDate:n,onInputStart:t,onInputDuration:a,onInputNote:l,parseUT:f.A,parseUnixHours:St.A,secsToHours:M.A,getReminder:u,onIncreaseDuration:s,onIncreaseTime:i,onIncreaseDate:r}}};const At=(0,N.A)(Et,[["render",ft],["__scopeId","data-v-37c681fa"]]);var Lt=At;const bt={id:"category"},It=["onClick"];function Nt(e,t,n,a,l,i){const s=(0,o.g2)("FontAwesomeIcon");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.onStopPicking&&n.onStopPicking(...e)),class:"orangeBtn"},[(0,o.bF)(s,{icon:a.faLeftLong},null,8,["icon"]),t[1]||(t[1]=(0,o.eW)(" Back "))]),(0,o.Lk)("div",bt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.employees,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t},[!e.last_date||n.date<=e.last_date?((0,o.uX)(),(0,o.CE)("div",{key:0,id:"service",style:(0,u.Tr)({background:e.color}),onClick:t=>a.onSelectEmp(e.employee_id,e.alias,e.color)},(0,u.v_)(e.alias),13,It)):(0,o.Q3)("",!0)])))),128))])],64)}var _t=n(7907),wt={name:"Employees-",components:{FontAwesomeIcon:g.gc},props:{date:Number,setEmp:Function,onStopPicking:Function},setup(e){const t=(0,C.KR)([]),n=(t,n,o)=>{e.setEmp(t,n,o)};return(0,o.sV)((async()=>{t.value=await(0,_t.A)(),console.log("employees: ",t.value)})),{employees:t,onSelectEmp:n,faLeftLong:y.NDX}}};const Dt=(0,N.A)(wt,[["render",Nt],["__scopeId","data-v-71f59f67"]]);var Ot=Dt;const xt={id:"flexBox"};function Ft(e,t,n,a,l,i){const s=(0,o.g2)("FontAwesomeIcon"),r=(0,o.g2)("Category"),c=(0,o.g2)("SelectAOSOs");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.onStopPicking&&n.onStopPicking(...e)),class:"orangeBtn"},[(0,o.bF)(s,{icon:a.faLeftLong},null,8,["icon"]),t[1]||(t[1]=(0,o.eW)(" Back "))]),(0,o.Lk)("div",xt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.categories,((e,t)=>((0,o.uX)(),(0,o.Wv)(r,{key:t,category:e,onInputService:a.onInputService},null,8,["category","onInputService"])))),128))]),a.isOpenAOSs?((0,o.uX)(),(0,o.Wv)(c,{key:0,serviceId:a.serviceId,onClose:a.onCancelAOSs,onInputAOSOs:a.onInputAOSOs},null,8,["serviceId","onClose","onInputAOSOs"])):(0,o.Q3)("",!0)],64)}n(8992),n(3949);async function Pt(e){try{const t="",n=await fetch(`${t}/api/services/get_services/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();if(n.ok){const e=Rt(o.services,o.categories);return e}(0,A.A)(o.message),console.log("Failed to fetch employee list, message: ",o.message)}catch(t){console.error("Unexpected Error: ",t)}}function Rt(e,t){const n={null:{cate_id:null,cate_name:"Others",services:[]}};t.forEach((e=>{const[t,o,a]=e;n[t]={cate_id:t,cate_name:o,sort_order:a,services:[]}})),e.forEach((e=>{const[t,o,a,l,i]=e;l&&n[i].services.push({service_id:t,service_name:o,last_date:a})})),!n[null].services.length>0&&delete n[null];const o=Object.values(n).sort(((e,t)=>e.sort_order-t.sort_order));return o}const Tt={key:0,id:"category"},Xt={id:"title"},Mt=["onClick"];function Kt(e,t,n,a,l,i){return n.category.services.length?((0,o.uX)(),(0,o.CE)("div",Tt,[(0,o.Lk)("div",Xt,(0,u.v_)(n.category.cate_name),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.category.services,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{id:"service",key:t,onClick:t=>i.onSelectService(e.service_id,e.service_name,n.category.cate_name)},(0,u.v_)(e.service_name),9,Mt)))),128))])):(0,o.Q3)("",!0)}var $t={name:"Category-",props:{category:Object,onInputService:Function},methods:{formatDate(e){return(0,S.A)(e)},onSelectService(e,t,n){this.onInputService(e,t,n)}}};const Bt=(0,N.A)($t,[["render",Kt],["__scopeId","data-v-44b3dcf3"]]);var Wt=Bt;const Ut={id:"parent"},jt={id:"window"},Qt={key:0},qt={id:"title"},Ht={id:"description"},Vt={class:"question"},Zt={class:"optionBox"},Jt=["value","onUpdate:modelValue"],Gt={key:0,id:"msg"},Yt={key:1,id:"notAvail"};function zt(e,t,n,l,i,s){const r=(0,o.g2)("FontAwesomeIcon");return(0,o.uX)(),(0,o.CE)("div",Ut,[(0,o.Lk)("div",{id:"background",onClick:t[0]||(t[0]=(...e)=>s.handleClose&&s.handleClose(...e))}),(0,o.Lk)("div",jt,[(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>s.handleClose&&s.handleClose(...e)),id:"closeBtn",class:"redBtn"},[(0,o.bF)(r,{icon:i.faXmark},null,8,["icon"])]),i.fetched?((0,o.uX)(),(0,o.CE)("div",Qt,[(0,o.Lk)("div",qt,[(0,o.eW)((0,u.v_)(i.serviceInfo.name)+" ",1),(0,o.Lk)("div",Ht,(0,u.v_)(i.serviceInfo.description),1)]),i.serviceInfo.client_can_book?((0,o.uX)(),(0,o.CE)("form",{key:0,onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>s.onSubmit&&s.onSubmit(...e)),["prevent"])),id:"content"},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.questions,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:"questionBox"},[(0,o.Lk)("span",Vt,(0,u.v_)(t+1)+". "+(0,u.v_)(e.questionText),1),(0,o.Lk)("div",Zt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,((t,n)=>((0,o.uX)(),(0,o.CE)("div",{key:n,class:"options"},[(0,o.Lk)("label",null,[(0,o.bo)((0,o.Lk)("input",{type:"radio",value:t.optionId,"onUpdate:modelValue":t=>i.answers[e.questionId]=t,required:""},null,8,Jt),[[a.XL,i.answers[e.questionId]]]),(0,o.eW)(" "+(0,u.v_)(t.optionText)+" "+(0,u.v_)(s.formatOffset(t.optionOffset)),1)])])))),128))])])))),128)),i.msg?((0,o.uX)(),(0,o.CE)("div",Gt,(0,u.v_)(i.msg),1)):(0,o.Q3)("",!0),t[3]||(t[3]=(0,o.Lk)("div",{id:"btnBox"},[(0,o.Lk)("button",{id:"confirm",class:"blueBtn"},"Confirm")],-1))],32)):((0,o.uX)(),(0,o.CE)("div",Yt," This service is not available for online booking, please contact us to book "))])):(0,o.Q3)("",!0)])])}async function en(e){try{const t="",n=await fetch(`${t}/api/services/get_add_on_services/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();if(n.ok){const e=tn(o.add_on_services),t=nn(o.service_info);return{questions:e,serviceInfo:t}}(0,A.A)(o.message),console.log("Failed to fetch add-on services, message: ",o.message)}catch(t){console.error("Unexpected Error: ",t)}}function tn(e){let t=[],n=-1,o=null;for(let a of e){const[e,l,i,s,r]=a;if(o!==s){const e={questionId:s,questionText:r,options:[]};t.push(e),o=s,n++}const c={optionId:e,optionText:l,optionOffset:i};t[n].options.push(c)}return t}function nn(e){const[t,n,o,a,l]=e;return{name:t,description:n,duration:o,price:a,client_can_book:l}}var on={props:{serviceId:Number,onClose:Function,onInputAOSOs:Function},data(){return{faXmark:y.Jyw,questions:[],serviceInfo:{},msg:"",answers:{},fetched:!1}},components:{FontAwesomeIcon:g.gc},methods:{onSubmit(){const e=[];for(let t in this.answers)e.push(Number(t)),e.push(this.answers[t]);e.length/2===this.questions.length?(this.onInputAOSOs(e),this.onClose()):this.msg="Please provide answers to all questions"},handleClose(){this.onClose()},formatOffset(e){if(0===e)return;let t=e>=0?"+":"-",n=Math.abs(Math.floor(e/60));return`(${t}${n} mins)`},onInputAnswer(){}},async created(){const{questions:e,serviceInfo:t}=await en(this.serviceId);this.questions=e,this.serviceInfo=t,this.fetched=!0}};const an=(0,N.A)(on,[["render",zt],["__scopeId","data-v-5cff2cb4"]]);var ln=an,sn={components:{Category:Wt,SelectAOSOs:ln,FontAwesomeIcon:g.gc},props:{date:Number,setService:Function,onStopPicking:Function},setup(e){const t=(0,C.KR)(!1),n=(0,C.KR)([]),a=(0,C.KR)(null),l=(0,C.KR)(""),i=(0,C.KR)(""),s=(e,n,o)=>{a.value=e,l.value=n,i.value=o,t.value=!0},r=(t,n)=>{e.setService(a.value,l.value,i.value,t,n)},c=()=>{t.value=!1};return(0,o.sV)((async()=>{n.value=await Pt(e.date),console.log("categories",n.value)})),{isOpenAOSs:t,categories:n,serviceId:a,onInputService:s,onInputAOSOs:r,onCancelAOSs:c,faLeftLong:y.NDX}}};const rn=(0,N.A)(sn,[["render",Ft],["__scopeId","data-v-2a3a3182"]]);var cn=rn;const un={id:"flexBox"},dn=["value"];function pn(e,t,n,l,i,s){const r=(0,o.g2)("FontAwesomeIcon"),c=(0,o.g2)("ContactSearch");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("button",{class:"orangeBtn",onClick:t[0]||(t[0]=(0,a.D$)(((...e)=>n.onStopPicking&&n.onStopPicking(...e)),["prevent"]))},[(0,o.bF)(r,{icon:l.faLeftLong},null,8,["icon"]),t[6]||(t[6]=(0,o.eW)(" Back "))]),(0,o.Lk)("form",{onSubmit:t[5]||(t[5]=(0,a.D$)(((...e)=>l.onSubmit&&l.onSubmit(...e)),["prevent"]))},[(0,o.Lk)("div",un,[(0,o.Lk)("div",null,[(0,o.Lk)("input",{type:"tel",value:l.phoneNum,onInput:t[1]||(t[1]=(...e)=>l.onInputPhone&&l.onInputPhone(...e)),placeholder:"Enter Phone Number",maxlength:"15"},null,40,dn)]),(0,o.Lk)("div",null,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>l.name=e),placeholder:"Enter Name",onInput:t[3]||(t[3]=(...e)=>l.onInputName&&l.onInputName(...e))},null,544),[[a.Jo,l.name]])]),(0,o.Lk)("div",null,[(0,o.Lk)("button",{class:"blueBtn",onClick:t[4]||(t[4]=(0,a.D$)(((...e)=>l.onClear&&l.onClear(...e)),["prevent"]))},"Clear"),t[7]||(t[7]=(0,o.Lk)("button",{class:"greenBtn"},"Submit",-1))])]),(0,o.bF)(c,{_query:l.query,onSelectContact:l.onSelectContact},null,8,["_query","onSelectContact"])],32)],64)}const vn={id:"flexBox"},mn={key:0},kn=["onClick"],gn={key:1};function yn(e,t,n,l,i,s){return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",vn,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.query=e),onInput:t[1]||(t[1]=(...e)=>l.onSearch&&l.onSearch(...e)),placeholder:"Search..."},null,544),[[a.Jo,l.query]])]),(0,o.Lk)("table",null,[t[3]||(t[3]=(0,o.Lk)("colgroup",null,[(0,o.Lk)("col",{style:{width:"auto"}}),(0,o.Lk)("col",{style:{width:"auto"}})],-1)),l.contacts.length?((0,o.uX)(),(0,o.CE)("tbody",mn,[t[2]||(t[2]=(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Client Name"),(0,o.Lk)("th",null,"Phone Number"),(0,o.Lk)("th",null,"Last Used")],-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.contacts,((e,t)=>((0,o.uX)(),(0,o.CE)("tr",{class:"row",key:t,onClick:t=>l.onClickContact(e.phoneNum,e.name)},[(0,o.Lk)("td",null,(0,u.v_)(e.name),1),(0,o.Lk)("td",null,(0,u.v_)(l.formatPhone(e.phoneNum)),1),(0,o.Lk)("td",null,(0,u.v_)(l.unixTimeToReminder(e.lastUsed)),1)],8,kn)))),128))])):((0,o.uX)(),(0,o.CE)("th",gn,"No Results"))])])}async function hn(e,t){try{const n="",o=await fetch(`${n}/api/appointments/search_contacts`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:e.trim(),limit:t})}),a=await o.json();if(o.ok){let e=[];const t=a.contacts;for(let n of t){const[t,,o,a,l,i]=n,s={phoneNum:t,name:o,lastUsed:a,firstName:l,lastName:i};e.push(s)}return e}(0,A.A)(a.message),console.log("Failed to search contacts, message: ",a.message)}catch(n){console.error("Unexpected Error: ",n)}}var fn={props:{_query:String,onSelectContact:Function},setup(e){const t=(0,C.KR)(""),n=(0,C.KR)([]),a=async()=>{n.value=await hn(t.value,25)},l=(t,n)=>{e.onSelectContact(t,n)};return(0,o.wB)((()=>e._query),(async e=>{t.value=e,await a()})),{query:t,contacts:n,onSearch:a,onClickContact:l,formatPhone:De.A,unixTimeToReminder:E.A}}};const Cn=(0,N.A)(fn,[["render",yn],["__scopeId","data-v-2ef01b3a"]]);var Sn=Cn,En={components:{ContactSearch:Sn,FontAwesomeIcon:g.gc},props:{_phoneNum:String,_name:String,onStopPicking:Function,setContact:Function},setup(e){const t=(0,C.KR)(""),n=(0,C.KR)(""),a=(0,C.KR)(null),l=async()=>{let o=null;""!==t.value.trim()&&(o="+1"+t.value.replace(/\D/g,"")),e.setContact(o,n.value)},i=e=>{let n=e.target.value.replace(/\D/g,"");const o=d(n);t.value=o,r(n)},s=()=>{r(n.value)},r=e=>{a.value=e},c=(e,o)=>{t.value=d(e.slice(2)),n.value=o},u=()=>{t.value="",n.value="",a.value=""};(0,o.sV)((()=>{t.value=(0,De.A)(e._phoneNum),n.value=e._name,r("")}));const d=e=>{let t="";return t=e.length<=3?e:e.length<=6?`${e.slice(0,3)} ${e.slice(3)}`:`${e.slice(0,3)} ${e.slice(3,6)} ${e.slice(6)}`,t};return{phoneNum:t,name:n,query:a,onSubmit:l,onInputPhone:i,onInputName:s,onSearch:r,onSelectContact:c,onClear:u,faLeftLong:y.NDX}}};const An=(0,N.A)(En,[["render",pn],["__scopeId","data-v-786c7c9c"]]);var Ln=An,bn={name:"EditAppo",components:{FontAwesomeIcon:g.gc,AppoEdit:Lt,EmployeePicker:Ot,ServicePicker:cn,ContactPicker:Ln},props:{appoId:Number,onCancelEdit:Function,onSelectAppo:Function,onHideMain:Function,onDoneEdit:Function,NAMvalue:Object,setEZstates:Function},setup(e){const t=(0,Oe.lq)(),n=(0,Oe.rd)(),a=(0,C.KR)(!1),l=(0,C.KR)(!1),i=(0,C.KR)(!1),s=(0,C.KR)(""),r=(0,C.KR)(""),c=(0,C.KR)([]),u=(0,C.KR)(""),d=(0,C.KR)([]),p=(0,C.KR)(""),v=(0,C.KR)(""),m=(0,C.KR)(""),k=(0,C.KR)(""),g=(0,C.KR)(null),h=(0,C.KR)([]),f=(0,C.KR)(null),S=(0,C.KR)(null),E=(0,C.KR)(null),A=(0,C.KR)(null),L=(0,C.KR)(""),b=()=>{u.value="",f.value=null,p.value="white"},I=()=>{s.value="",g.value=null,r.value="",c.value=[],h.value=[],p.value="white"},N=(e,t)=>{v.value=e,m.value=t,K()},_=async(e,t,n,o,a)=>{g.value=e,s.value=t,r.value=n,h.value=o,c.value=a,await U(),K()},w=async(e,t,n)=>{f.value=e,u.value=t,p.value=n,console.log("empId",f.value),await U(),K()},D=e=>{S.value=e},O=e=>{E.value=e},x=e=>{A.value=e},F=e=>{L.value=e,console.log("new Note",e)},P=()=>{e.setEZstates(S.value,f.value,E.value,A.value)},R=()=>{n.push(`/calendar/${t.params.unixDate}/selecting`)},T=()=>{e.onHideMain(!0),i.value=!0,R()},X=()=>{e.onHideMain(!0),a.value=!0,R()},M=()=>{e.onHideMain(!0),l.value=!0,R()},K=()=>{$(),n.push(`/calendar/${t.params.unixDate}`)},$=()=>{a.value=!1,l.value=!1,i.value=!1,e.onHideMain(!1)},B=()=>{N(null,null)},W=()=>{_(null,"","",[],[])},U=async()=>{g.value&&(A.value=await lt(g.value,f.value,h.value))},j=async()=>{if(!e.appoId)return;const t=await Ce(e.appoId);console.log("Fetched details:",t),v.value=t.phoneNum,m.value=t.contactName,s.value=t.serviceName,r.value=t.cateName,h.value=t.AOSOs,c.value=t.AOSOsText,u.value=t.empAlias,g.value=t.serviceId,f.value=t.empId,d.value=t.selectedEmps,S.value=t.date,E.value=t.start,A.value=t.end-t.start,k.value=t.message,L.value=t.note,p.value=t.color},Q=async()=>{const t=await at(e.appoId,v.value,m.value,g.value,h.value,f.value,S.value,E.value,A.value,d.value.map((e=>e.empId)),k.value,L.value);t&&e.onDoneEdit(S.value,t)};return(0,o.wB)((()=>e.appoId),j),(0,o.wB)((()=>t.path),(e=>{e.endsWith("selecting")||$()})),(0,o.wB)((()=>e.NAMvalue),(e=>{E.value=e.start,w(e.empId,e.empAlias,e.color),D(e.date)})),(0,o.wB)([S,f,E,A],(()=>{P()})),(0,o.sV)(j),{faCheck:y.e68,isPickingEmp:a,isPickingService:l,isPickingContact:i,setContact:N,setService:_,setEmp:w,setDate:D,setStart:O,setDuration:x,setNote:F,resetEmp:b,resetService:I,contactName:m,phoneNum:v,serviceName:s,AOSOsText:c,category:r,empAlias:u,selectedEmps:d,date:S,start:E,duration:A,message:k,note:L,color:p,onSubmit:Q,onSelectContact:T,onOpenEmpPicker:X,onOpenServicePicker:M,onStopPicking:K,onClearContact:B,onClearService:W}}};const In=(0,N.A)(bn,[["render",ot],["__scopeId","data-v-2e17f5f4"]]);var Nn=In;const _n={class:"flexBox"},wn={id:"box"},Dn={id:"closeBox"},On={id:"note"},xn={class:"flexBox"},Fn={id:"save"};function Pn(e,t,n,l,i,s){const r=(0,o.g2)("AddForm"),c=(0,o.g2)("FontAwesomeIcon"),d=(0,o.g2)("EmployeePicker"),p=(0,o.g2)("ServicePicker"),v=(0,o.g2)("ContactPicker");return(0,o.uX)(),(0,o.CE)("div",null,[l.isPickingEmp||l.isPickingService||l.isPickingContact?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("form",{key:0,onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>l.onSubmit&&l.onSubmit(...e)),["prevent"])),id:"container"},[(0,o.Lk)("div",_n,[(0,o.Lk)("div",wn,[(0,o.Lk)("div",Dn,[(0,o.Lk)("button",{class:"redBtn",onClick:t[0]||(t[0]=(0,a.D$)(((...e)=>n.onCancelAdding&&n.onCancelAdding(...e)),["prevent"]))},"X")]),t[4]||(t[4]=(0,o.Lk)("div",{id:"top"},[(0,o.Lk)("div",{id:"title"},"New Appointment")],-1)),(0,o.Lk)("div",{id:"content",style:(0,u.Tr)({backgroundColor:l.color})},[(0,o.bF)(r,{clientName:l.clientName,phoneNum:l.phoneNum,serviceName:l.serviceName,AOSOs:l.AOSOsText,category:l.category,empAlias:l.empAlias,date:n.unixDate,start:l.start,duration:l.duration,note:l.note,setStart:l.setStart,setDuration:l.setDuration,setNote:l.setNote,resetEmp:l.resetEmp,resetService:l.resetService,onOpenEmpPicker:l.onOpenEmpPicker,onOpenServicePicker:l.onOpenServicePicker,onSelectContact:l.onSelectContact,onClearContact:l.onClearContact,onClearService:l.onClearService},null,8,["clientName","phoneNum","serviceName","AOSOs","category","empAlias","date","start","duration","note","setStart","setDuration","setNote","resetEmp","resetService","onOpenEmpPicker","onOpenServicePicker","onSelectContact","onClearContact","onClearService"])],4),(0,o.Lk)("div",On,[(0,o.bo)((0,o.Lk)("textarea",{ref:"noteRef","onUpdate:modelValue":t[1]||(t[1]=e=>l.note=e),type:"text",rows:"3",placeholder:"Note (not visible to client)"},null,512),[[a.Jo,l.note]])]),(0,o.Lk)("div",xn,[(0,o.Lk)("button",Fn,[(0,o.bF)(c,{icon:l.faCheck},null,8,["icon"]),t[3]||(t[3]=(0,o.eW)(" Finish "))])])])])],32)),l.isPickingEmp?((0,o.uX)(),(0,o.Wv)(d,{key:1,date:n.unixDate,setEmp:l.setEmp,onStopPicking:l.onStopPicking},null,8,["date","setEmp","onStopPicking"])):(0,o.Q3)("",!0),l.isPickingService?((0,o.uX)(),(0,o.Wv)(p,{key:2,date:n.unixDate,setService:l.setService,onStopPicking:l.onStopPicking},null,8,["date","setService","onStopPicking"])):(0,o.Q3)("",!0),l.isPickingContact?((0,o.uX)(),(0,o.Wv)(v,{key:3,setContact:l.setContact,onStopPicking:l.onStopPicking},null,8,["setContact","onStopPicking"])):(0,o.Q3)("",!0)])}const Rn={class:"center"},Tn=["value"],Xn={class:"center"},Mn=["value"],Kn={class:"center"},$n=["value"],Bn={class:"duo"},Wn={class:"duo"},Un={class:"duo"};function jn(e,t,n,l,i,s){return(0,o.uX)(),(0,o.CE)("table",null,[t[18]||(t[18]=(0,o.Lk)("colgroup",null,[(0,o.Lk)("col",{style:{width:"auto"}}),(0,o.Lk)("col",{style:{width:"80%"}})],-1)),(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[12]||(t[12]=(0,o.Lk)("th",null,"Date",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Rn,[(0,o.Lk)("div",null,(0,u.v_)(l.getReminder),1),(0,o.Lk)("div",null,[(0,o.Lk)("input",{type:"date",value:l.parseUT(n.date),disabled:""},null,8,Tn)])])])]),(0,o.Lk)("tr",null,[t[13]||(t[13]=(0,o.Lk)("th",null,"Time",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Xn,[(0,o.Lk)("div",null,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(0,a.D$)((e=>l.onIncreaseTime(!1)),["prevent"]))},"-"),(0,o.Lk)("input",{type:"time",value:l.parseUnixHours(n.start),onChange:t[1]||(t[1]=(...e)=>l.onInputStart&&l.onInputStart(...e)),required:""},null,40,Mn),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(0,a.D$)((e=>l.onIncreaseTime(!0)),["prevent"]))},"+")])])])]),(0,o.Lk)("tr",null,[t[14]||(t[14]=(0,o.Lk)("th",null,"Duration (mins)",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Kn,[(0,o.Lk)("div",null,[(0,o.Lk)("button",{onClick:t[3]||(t[3]=(0,a.D$)((e=>l.onIncreaseDuration(!1)),["prevent"]))},"-"),(0,o.Lk)("input",{type:"number",value:n.duration/60,onInput:t[4]||(t[4]=(...e)=>l.onInputDuration&&l.onInputDuration(...e)),onFocus:t[5]||(t[5]=e=>{e.target.select()}),required:"",min:5,step:"1"},null,40,$n),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(0,a.D$)((e=>l.onIncreaseDuration(!0)),["prevent"]))},"+")]),(0,o.Lk)("div",null,(0,u.v_)(l.getEndTime),1)])])]),(0,o.Lk)("tr",null,[t[15]||(t[15]=(0,o.Lk)("th",null,"Client",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Bn,[(0,o.Lk)("div",null,[(0,o.eW)((0,u.v_)(l.formatPhone(n.phoneNum))+" ",1),(0,o.Lk)("div",null,(0,u.v_)(n.clientName),1)]),(0,o.Lk)("div",null,[n.phoneNum?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[7]||(t[7]=(...e)=>n.onClearContact&&n.onClearContact(...e))},"X")):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>n.onSelectContact&&n.onSelectContact(...e))},"Select")])])])]),(0,o.Lk)("tr",null,[t[16]||(t[16]=(0,o.Lk)("th",null,"Service",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Wn,[(0,o.Lk)("div",null,[(0,o.eW)((0,u.v_)(n.serviceName)+" "+(0,u.v_)(l.getCate)+" ",1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.AOSOs,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{id:"AOS",key:t},(0,u.v_)(e.question)+" ~ "+(0,u.v_)(e.answer)+" "+(0,u.v_)(l.formatOffset(e.offset)),1)))),128))]),(0,o.Lk)("div",null,[n.serviceName?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[9]||(t[9]=(...e)=>n.onClearService&&n.onClearService(...e))},"X")):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>n.onOpenServicePicker&&n.onOpenServicePicker(...e))},"Select")])])])]),(0,o.Lk)("tr",null,[t[17]||(t[17]=(0,o.Lk)("th",null,"Employee",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",Un,[(0,o.Lk)("div",null,(0,u.v_)(n.empAlias),1),(0,o.Lk)("button",{onClick:t[11]||(t[11]=(0,a.D$)(((...e)=>n.onOpenEmpPicker&&n.onOpenEmpPicker(...e)),["prevent"]))},"Select")])])])])])}var Qn={props:{clientName:String,phoneNum:String,serviceName:String,category:String,AOSOs:Array,empAlias:String,date:Number,start:Number,duration:Number,note:String,setStart:Function,setDuration:Function,setNote:Function,onOpenEmpPicker:Function,onOpenServicePicker:Function,onSelectContact:Function,onClearService:Function,onClearContact:Function},setup(e){const t=t=>{const n=(0,Ct.A)(t.target.value);e.setStart(n)},n=t=>{const n=60*t.target.value;e.setDuration(n)},a=t=>{const n=t.target.value;e.setNote(n),p()},l=t=>{const n=t?900:-900;e.setStart(e.start+n)},i=t=>{const n=t?900:-900;e.setDuration(e.duration+n)},s=e=>{if(0===e)return;let t=e>=0?"+":"-",n=Math.abs(Math.floor(e/60));return`(${t}${n} mins)`},r=(0,o.EW)((()=>{if(!e.date)return;const t=e.date+43200,n=(0,E.A)(t);return`${n}`})),c=(0,o.EW)((()=>{const t=e.category;return t?`(${t})`:""})),u=(0,o.EW)((()=>{if(!e.start||!e.duration)return;const t=e.start+e.duration;return`to ${(0,M.A)(t)}`})),d=(0,C.KR)(null),p=()=>{(0,o.dY)((()=>{const e=d.value;e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px")}))};return(0,o.sV)((()=>{p()})),{TAref:d,formatOffset:s,formatPhone:De.A,onInputStart:t,onInputDuration:n,onInputNote:a,parseUT:f.A,parseUnixHours:St.A,secsToHours:M.A,getReminder:r,getCate:c,getEndTime:u,onIncreaseDuration:i,onIncreaseTime:l}}};const qn=(0,N.A)(Qn,[["render",jn],["__scopeId","data-v-55033192"]]);var Hn=qn;async function Vn(e,t,n,o,a,l,i,s,r){try{console.log("note",r);const c="",u=await fetch(`${c}/api/appointments/admin_add_appo`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone_num:e,name:t,service_id:n,AOSOs:o,emp_id:a,date:l,start:i,end:i+s,note:r})}),d=await u.json();if(u.ok)return d.appo_id;{let e="An error occurred";1==d.error_type?e=`Overlapping appointment ${(0,M.A)(d.start)} to ${(0,M.A)(d.end)}`:2==d.error_type&&(e=`Schedule is from ${(0,M.A)(d.start)} to ${(0,M.A)(d.end)}`),(0,A.A)(e),console.log("Failed to add appointment, message: ",d.message)}}catch(c){console.error("Unexpected Error: ",c)}}var Zn={name:"EditAppo",components:{FontAwesomeIcon:g.gc,AddForm:Hn,EmployeePicker:Ot,ServicePicker:cn,ContactPicker:Ln},props:{unixDate:Number,onCancelAdding:Function,onSelectAppo:Function,onHideMain:Function,onDoneEdit:Function,NAMvalue:Object,setEZstates:Function},setup(e){const t=(0,Oe.lq)(),n=(0,Oe.rd)(),a=(0,C.KR)(!1),l=(0,C.KR)(!1),i=(0,C.KR)(!1),s=(0,C.KR)(""),r=(0,C.KR)(""),c=(0,C.KR)([]),u=(0,C.KR)(""),d=(0,C.KR)("white"),p=(0,C.KR)(""),v=(0,C.KR)(""),m=(0,C.KR)(null),k=(0,C.KR)([]),g=(0,C.KR)(null),h=(0,C.KR)(null),f=(0,C.KR)(null),S=(0,C.KR)(""),E=(0,C.KR)(null),A=()=>{u.value="",g.value=null,d.value="white"},L=()=>{s.value="",m.value=null,r.value="",c.value=[],k.value=[],d.value="white"},b=(e,t)=>{p.value=e,v.value=t,X()},I=async(e,t,n,o,a)=>{m.value=e,s.value=t,r.value=n,k.value=o,c.value=a,await B(),X()},N=async(e,t,n)=>{g.value=e,u.value=t,d.value=n,console.log("empId",g.value),await B(),X()},_=e=>{h.value=e},w=e=>{f.value=e},D=e=>{S.value=e,console.log("new Note",e)},O=()=>{e.setEZstates(e.unixDate,g.value,h.value,f.value)},x=()=>{n.push(`/calendar/${t.params.unixDate}/selecting`)},F=()=>{e.onHideMain(!0),a.value=!0,x()},P=()=>{e.onHideMain(!0),l.value=!0,x()},R=()=>{e.onHideMain(!0),i.value=!0,x()},T=()=>{a.value=!1,l.value=!1,i.value=!1,e.onHideMain(!1)},X=()=>{T(),n.push(`/calendar/${t.params.unixDate}`)},M=()=>{b(null,null)},K=()=>{I(null,"","",[],[])},$=()=>{E.value&&(E.value.style.height="auto",E.value.style.height=`${E.value.scrollHeight+2}px`)},B=async()=>{m.value&&(f.value=await lt(m.value,g.value,k.value))},W=async()=>{console.log("note",S.value);const t=await Vn(p.value,v.value,m.value,k.value,g.value,e.unixDate,h.value,f.value,S.value);t&&e.onDoneEdit(e.unixDate,t)};return(0,o.wB)((()=>t.path),(e=>{e.endsWith("selecting")||T()})),(0,o.wB)((()=>e.NAMvalue),(e=>{h.value=e.start,N(e.empId,e.empAlias,e.color)})),(0,o.wB)([()=>e.unixDate,g,h,f],(()=>{O()})),(0,o.wB)(S,(()=>{$()})),{faCheck:y.e68,isPickingEmp:a,isPickingService:l,isPickingContact:i,setContact:b,setService:I,setEmp:N,setStart:_,setDuration:w,setNote:D,resetEmp:A,resetService:L,phoneNum:p,clientName:v,serviceName:s,AOSOsText:c,category:r,empAlias:u,start:h,duration:f,note:S,noteRef:E,color:d,onSubmit:W,onOpenEmpPicker:F,onOpenServicePicker:P,onSelectContact:R,onStopPicking:X,onClearContact:M,onClearService:K}}};const Jn=(0,N.A)(Zn,[["render",Pn],["__scopeId","data-v-d07b9d98"]]);var Gn=Jn,Yn={name:"Calendar-",components:{FontAwesomeIcon:g.gc,DayInput:w,ScrollContent:ge,AppoDetails:Ge,EditAppo:Nn,AddAppo:Gn},setup(){const e=(0,C.KR)(!0),t=(0,C.KR)(!1),n=(0,C.KR)(!1),a=(0,C.KR)(0),l=(0,C.KR)(null),i=(0,C.KR)(null),s=(0,C.KR)(null),r=(0,C.KR)(null),c=(0,C.KR)(0),u=(0,C.KR)({}),d=(0,C.KR)(null),p=(0,Oe.rd)(),v=(0,Oe.lq)(),m=()=>{d.value=null},k=(e,t,n,o)=>{d.value={date:e,empId:t,start:n,duration:o}},g=()=>{const e=document.getElementById("scroll");e&&(e.scrollLeft+=140)},h=()=>{const e=document.getElementById("scroll");e&&(e.scrollLeft-=140)},f=async e=>{p.push(`/calendar/${e}`),l.value=e},S=()=>{e.value=!e.value},E=e=>{e&&(c.value=window.scrollY,console.log("lastScroll.value",c.value)),t.value=e},A=e=>{console.log("appoId",e),p.push(`/calendar/${l.value}/${e}`),s.value=e},L=(e,t,a,l,i)=>{r.value||(n.value=!0),(0,o.dY)((()=>{u.value={start:e,empId:t,empAlias:a,color:l,date:i}}))},b=()=>{p.push(`/calendar/${l.value}`),s.value=null},I=e=>{s.value=null,r.value=e,n.value=!1,p.push(`/calendar/${l.value}`)},N=()=>{t.value=!1,r.value=null,m()},_=(e,t)=>{a.value++,r.value=null,n.value=!1,p.push(`/calendar/${e}/${t}`),m()},w=()=>{r.value=null,n.value=!0},D=()=>{n.value=!1,m()};(0,o.wB)(r,(async e=>{if(e){await(0,o.dY)();const e=document.querySelector("#edit-appo");e&&e.scrollIntoView({block:"end"})}})),(0,o.wB)(t,(async e=>{e||(await(0,o.dY)(),window.scrollTo(0,c.value),console.log("scrolling"))})),(0,o.wB)((()=>v.path),(()=>{l.value=Number(v.params.unixDate),s.value=Number(v.params.appoId)}));const O=()=>{const e=document.getElementById("scroll");e&&(i.value=e.offsetWidth)};return(0,o.sV)((async()=>{l.value=Number(v.params.unixDate),s.value=Number(v.params.appoId),await(0,o.dY)(),O(),window.addEventListener("resize",O)})),(0,o.xo)((()=>{window.removeEventListener("resize",O)})),{faPlus:y.QLR,NAMvalue:u,resetMain:a,unixDate:l,scrollWidth:i,appoId:s,editId:r,isCompacting:e,isHidingMain:t,isAdding:n,EZstates:d,setEZstates:k,onMoveRight:g,onMoveLeft:h,onInputDate:f,onCompact:S,onSelectAppo:A,onSelectNAM:L,onCloseAppo:b,onEditAppo:I,onCancelEdit:N,onDoneEdit:_,onHideMain:E,onOpenAdding:w,onCancelAdding:D}}};const zn=(0,N.A)(Yn,[["render",c],["__scopeId","data-v-2876be33"]]);var eo=zn}}]);
//# sourceMappingURL=200.859e66b4.js.map