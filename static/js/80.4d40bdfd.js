"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[80],{6744:function(e,t,n){n.d(t,{A:function(){return o}});var l=n(4116),s=n(6156);function o(e){if(console.log("calling"),!e)return null;const t=l.c9.fromISO(e,{zone:(0,s.A)()}),n=t.toSeconds();return console.log("date to unix: ",n),n}},4961:function(e,t,n){n.d(t,{A:function(){return s}});var l=n(4116);function s(e){if(console.log("calling"),!e)return 0;const t=l.c9.fromFormat(e,"HH:mm");if(!t.isValid)throw new Error("Invalid time format");const n=3600*t.hour+60*t.minute;return n}},9049:function(e,t,n){n.d(t,{A:function(){return o}});var l=n(4116),s=n(6156);function o(e){if(console.log("calling"),!e)return;const t=l.c9.fromMillis(1e3*e),n=t.setZone((0,s.A)()),o=n.toFormat("yyyy-MM-dd");return o}},7:function(e,t,n){function l(e){if(console.log("calling"),!e)return null;const t=Math.floor(e/3600),n=Math.floor(e%3600/60),l=String(t).padStart(2,"0"),s=String(n).padStart(2,"0");return`${l}:${s}`}n.d(t,{A:function(){return l}})},1076:function(e,t,n){n.d(t,{A:function(){return o}});var l=n(4116),s=n(6156);function o(e){if(console.log("calling"),!e)return;const t=l.c9.fromMillis(1e3*e).setZone((0,s.A)());return t.toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}},5868:function(e,t,n){n.d(t,{A:function(){return s}});n(4114);var l=n(8199);async function s(){try{const e="",t=await fetch(`${e}/api/employees/get_colors`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),n=await t.json();if(t.ok){const e=[],t=n.colors;for(const n of t){const[t,l,s]=n,o={colorId:t,name:l,code:s};e.push(o)}return e}(0,l.A)(n.message),console.log("Failed to fetch color list, message: ",n.message)}catch(e){console.error("Unexpected Error: ",e)}}},179:function(e,t,n){n.d(t,{A:function(){return o}});n(4114),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(8992),n(3949);var l=n(445),s=n(8199);async function o(e){try{const t="",n=await fetch(`${t}/api/employees/get_employee_services/${e}/${(0,l.A)()}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();if(n.ok){const e=i(o.services,o.categories),t=c(o.services);return console.log("categories: ",e),console.log("ES_ids: ",t),{categories:e,ES_ids:t}}(0,s.A)(o.message),console.log("Failed to fetch employee's services, message: ",o.message)}catch(t){console.error("Unexpected Error: ",t)}}function i(e,t){const n={null:{cate_id:null,cate_name:"Unclassified",services:[]}};t.forEach((e=>{const[t,l]=e;n[t]={cate_id:t,cate_name:l,services:[]}})),e.forEach((e=>{const[t,l,s,o]=e;n[s].services.push({service_id:t,service_name:l,cate_id:s,employee_id:o})})),!n[null].services.length>0&&delete n[null];const l=Object.values(n).sort(((e,t)=>t.services.length-e.services.length));return l}function c(e){const t=new Set;return e.forEach((e=>{const[n,,,l]=e;l&&t.add(n)})),t}},4417:function(e,t,n){n.d(t,{A:function(){return d}});var l=n(6768);const s={id:"na"};function o(e,t){return(0,l.uX)(),(0,l.CE)("span",s,"empty")}var i=n(1241);const c={},a=(0,i.A)(c,[["render",o],["__scopeId","data-v-f67a6f6c"]]);var d=a},80:function(e,t,n){n.r(t),n.d(t,{default:function(){return ut}});var l=n(6768);const s={id:"parent"},o={key:0,id:"warning"};function i(e,t,n,i,c,a){const d=(0,l.g2)("EmployeeInfo"),r=(0,l.g2)("Schedule");return(0,l.uX)(),(0,l.CE)("div",s,[i.showWarning?((0,l.uX)(),(0,l.CE)("div",o," Warning: No schedules have been set ")):(0,l.Q3)("",!0),(0,l.bF)(d),t[0]||(t[0]=(0,l.Lk)("br",null,null,-1)),(0,l.bF)(r,{showScheduleWarning:i.showScheduleWarning},null,8,["showScheduleWarning"])])}var c=n(144),a=n(4232),d=n(5130);const r={key:0},u={key:1},h={key:3,id:"duo"},p={class:"greenBtn"};function k(e,t,n,s,o,i){const c=(0,l.g2)("DeleteBtn"),k=(0,l.g2)("NA"),m=(0,l.g2)("EditEmpInfo"),g=(0,l.g2)("Category"),v=(0,l.g2)("FontAwesomeIcon");return(0,l.uX)(),(0,l.CE)(l.FK,null,[o.deletable?((0,l.uX)(),(0,l.Wv)(c,{key:0,empId:o.emp_id},null,8,["empId"])):(0,l.Q3)("",!0),o.lastDateCC>0?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"warning",onClick:t[0]||(t[0]=(...e)=>i.toConflictPage&&i.toConflictPage(...e))},[(0,l.eW)(" Warning: Availability has "+(0,a.v_)(o.lastDateCC)+" ",1),t[5]||(t[5]=(0,l.Lk)("u",null,"conflicting appointment(s)",-1))])):(0,l.Q3)("",!0),o.scheduleCC>0?((0,l.uX)(),(0,l.CE)("div",{key:2,class:"warning",onClick:t[1]||(t[1]=(...e)=>i.toScheduleConflictPage&&i.toScheduleConflictPage(...e))},[(0,l.eW)(" Warning: Schedule(s) have "+(0,a.v_)(o.scheduleCC)+" ",1),t[6]||(t[6]=(0,l.Lk)("u",null,"conflicting appointment(s)",-1))])):(0,l.Q3)("",!0),o.isFetched?((0,l.uX)(),(0,l.CE)("form",{key:3,onSubmit:t[4]||(t[4]=(0,d.D$)(((...e)=>i.onSubmit&&i.onSubmit(...e)),["prevent"]))},[o.isEditing?((0,l.uX)(),(0,l.CE)("div",u,[(0,l.bF)(m,{alias:o.alias,colorId:o.colorId,last_date:o.last_date,interval_percent:o.intervalPercent,setAlias:i.setAlias,setColorId:i.setColorId,setLastDate:i.setLastDate,setIntervalPercent:i.setIntervalPercent},null,8,["alias","colorId","last_date","interval_percent","setAlias","setColorId","setLastDate","setIntervalPercent"])])):((0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("table",null,[t[13]||(t[13]=(0,l.Lk)("colgroup",null,[(0,l.Lk)("col",{style:{width:"auto"}}),(0,l.Lk)("col",{style:{width:"80%"}})],-1)),(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[t[7]||(t[7]=(0,l.Lk)("th",null,"Name:",-1)),(0,l.Lk)("td",null,(0,a.v_)(o.alias),1)]),(0,l.Lk)("tr",null,[t[8]||(t[8]=(0,l.Lk)("th",null,"Color:",-1)),(0,l.Lk)("td",{style:(0,a.Tr)({color:o.colorCode})},(0,a.v_)(o.colorName),5)]),(0,l.Lk)("tr",null,[t[9]||(t[9]=(0,l.Lk)("th",null,"Available Until:",-1)),(0,l.Lk)("td",null,[o.formattedDate?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(k,{key:0})),(0,l.eW)(" "+(0,a.v_)(o.formattedDate),1)])]),(0,l.Lk)("tr",null,[t[10]||(t[10]=(0,l.Lk)("th",null,[(0,l.eW)("Ideal Lengths:"),(0,l.Lk)("br"),(0,l.eW)("(minutes)")],-1)),(0,l.Lk)("td",null,(0,a.v_)(i.formattedIntervals(o.intervals)),1)]),(0,l.Lk)("tr",null,[t[11]||(t[11]=(0,l.Lk)("th",null,"Ideal Percentage:",-1)),(0,l.Lk)("td",null,(0,a.v_)(o.intervalPercent)+"%",1)]),(0,l.Lk)("tr",null,[t[12]||(t[12]=(0,l.Lk)("th",null,"Services:",-1)),(0,l.Lk)("td",null,[o.categories.length?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(k,{key:0}))])])])])])),((0,l.uX)(),(0,l.CE)("div",{id:"categories",key:o.resetCheckers},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.categories,((e,t)=>((0,l.uX)(),(0,l.Wv)(g,{key:t,isEditing:o.isEditing,category:e,checkService:i.checkService,uncheckService:i.uncheckService,uncheckedAll:!1},null,8,["isEditing","category","checkService","uncheckService"])))),128))])),t[17]||(t[17]=(0,l.Lk)("br",null,null,-1)),o.isEditing?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.Lk)("button",{class:"redBtn",onClick:t[3]||(t[3]=(0,d.D$)(((...e)=>i.closeEditForm&&i.closeEditForm(...e)),["prevent"]))},[(0,l.bF)(v,{icon:o.cancelIcon},null,8,["icon"]),t[15]||(t[15]=(0,l.eW)(" Cancel "))]),(0,l.Lk)("button",p,[(0,l.bF)(v,{icon:o.saveIcon},null,8,["icon"]),t[16]||(t[16]=(0,l.eW)(" Save Changes "))])])):((0,l.uX)(),(0,l.CE)("button",{key:2,class:"blueBtn",onClick:t[2]||(t[2]=(0,d.D$)(((...e)=>i.openEditForm&&i.openEditForm(...e)),["prevent"]))},[(0,l.bF)(v,{icon:o.editIcon},null,8,["icon"]),t[14]||(t[14]=(0,l.eW)(" Edit Employee Details "))]))],32)):(0,l.Q3)("",!0)],64)}n(4114),n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698);var m=n(4417),g=n(8264);const v={id:"flexBox"},L=["value"],y={id:"flexBox"},b=["value"],C=["value"],f={id:"flexBox"},I=["value"];function _(e,t,n,s,o,i){return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("table",null,[t[11]||(t[11]=(0,l.Lk)("colgroup",null,[(0,l.Lk)("col",{style:{width:"auto"}}),(0,l.Lk)("col",{style:{width:"80%"}})],-1)),(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[t[5]||(t[5]=(0,l.Lk)("th",null,"Name:",-1)),(0,l.Lk)("td",v,[(0,l.Lk)("input",{id:"textInput",type:"text",value:n.alias,onInput:t[0]||(t[0]=(...e)=>i.onInputAlias&&i.onInputAlias(...e)),required:""},null,40,L)])]),(0,l.Lk)("tr",null,[t[6]||(t[6]=(0,l.Lk)("th",null,"Color:",-1)),(0,l.Lk)("td",y,[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.colorId_=e),onChange:t[2]||(t[2]=(...e)=>i.onInputColor&&i.onInputColor(...e)),style:(0,a.Tr)({backgroundColor:i.getColor(),color:"black"}),required:""},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.colors,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.colorId,value:e.colorId,style:(0,a.Tr)({backgroundColor:e.code,color:"black"})},(0,a.v_)(e.name),13,b)))),128))],36),[[d.u1,o.colorId_]])])]),(0,l.Lk)("tr",null,[t[7]||(t[7]=(0,l.Lk)("th",null,"Available Until:",-1)),(0,l.Lk)("td",null,[(0,l.Lk)("input",{id:"date",type:"date",value:n.last_date,onChange:t[3]||(t[3]=(...e)=>i.onInputLastDate&&i.onInputLastDate(...e))},null,40,C)])]),t[9]||(t[9]=(0,l.Lk)("tr",null,[(0,l.Lk)("td",{colspan:"2"},[(0,l.Lk)("div",{id:"note"}," *Ideal Lengths are not editable, recreate employee if you need to change it ")])],-1)),(0,l.Lk)("tr",null,[t[8]||(t[8]=(0,l.Lk)("th",null,[(0,l.eW)(" Ideal Percentage:"),(0,l.Lk)("br"),(0,l.eW)(" (should be > 40) ")],-1)),(0,l.Lk)("td",f,[(0,l.Lk)("input",{type:"number",value:n.interval_percent,onChange:t[4]||(t[4]=(...e)=>i.onInputIntervalPercent&&i.onInputIntervalPercent(...e)),required:"",min:10,max:100,step:"1"},null,40,I)])]),t[10]||(t[10]=(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"Services:")],-1))])]),t[12]||(t[12]=(0,l.Lk)("br",null,null,-1))],64)}n(8992),n(2577);var E=n(5868),S={props:{alias:String,colorId:Number,last_date:String,interval_percent:Number,setAlias:Function,setColorId:Function,setLastDate:Function,setIntervalPercent:Function},data(){return{colorId_:this.colorId,colors:[]}},methods:{getColor(){const e=this.colors.find((e=>e.colorId===this.colorId_));return e?e.code:"gray"},onInputAlias(e){this.setAlias(e.target.value)},onInputLastDate(e){this.setLastDate(e.target.value)},onInputIntervalPercent(e){this.setIntervalPercent(e.target.value)},onInputColor(e){this.setColorId(Number(e.target.value))}},async created(){this.colors=await(0,E.A)()}},A=n(1241);const F=(0,A.A)(S,[["render",_],["__scopeId","data-v-121058c8"]]);var w=F,D=n(8249),T=n(2353),x=n(1387),X=n(8199);async function W(e){try{const t="",n=await fetch(`${t}/api/employees/delete_employee`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({emp_id:e})});if(n.ok)return!0;{const e=await n.json();(0,X.A)(e.message),console.log("Failed to delete employee, message: ",e.message)}}catch(t){console.error("Unexpected Error: ",t)}}const $={id:"parent"},B={id:"window"},P={id:"content"},N={};var j=Object.assign(N,{__name:"ConfirmDelete",props:{onClose:Function,empId:Number},setup(e){const t=e,n=(0,x.rd)(),s=(0,c.KR)(""),o=(0,c.KR)(null),i=async()=>{if("yes"===s.value.trim().toLowerCase()){const e=await W(t.empId);t.onClose(),e&&n.push("/employees")}};return(e,n)=>((0,l.uX)(),(0,l.CE)("div",$,[(0,l.Lk)("div",{id:"background",onClick:n[0]||(n[0]=e=>t.onClose())}),(0,l.Lk)("div",B,[(0,l.Lk)("button",{onClick:n[1]||(n[1]=e=>t.onClose()),id:"closeBtn",class:"redBtn"},[(0,l.bF)((0,c.R1)(D.gc),{icon:(0,c.R1)(T.Jyw)},null,8,["icon"])]),(0,l.Lk)("div",P,[n[3]||(n[3]=(0,l.Lk)("div",null,"Permanently delete this employee?",-1)),n[4]||(n[4]=(0,l.Lk)("label",null,'Type "yes" to confirm ',-1)),(0,l.bo)((0,l.Lk)("input",{ref_key:"inputRef",ref:o,type:"text","onUpdate:modelValue":n[2]||(n[2]=e=>s.value=e),onInput:i,placeholder:"yes"},null,544),[[d.Jo,s.value]])])])]))}});const O=(0,A.A)(j,[["__scopeId","data-v-68337c7d"]]);var K=O;const U={class:"flex"};var Q={__name:"DeleteBtn",props:{empId:Number},setup(e){const t=e,n=(0,c.KR)(!1);function s(){n.value=!0}return(e,o)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",U,[(0,l.Lk)("button",{id:"delete",class:"redBtn",onClick:s},[(0,l.bF)((0,c.R1)(D.gc),{icon:(0,c.R1)(T.yLS)},null,8,["icon"]),o[0]||(o[0]=(0,l.eW)(" Delete Employee "))])]),n.value?((0,l.uX)(),(0,l.Wv)(K,{key:0,empId:t.empId,onClose:()=>n.value=!1},null,8,["empId","onClose"])):(0,l.Q3)("",!0)],64))}};const q=(0,A.A)(Q,[["__scopeId","data-v-56fb4d64"]]);var R=q;async function M(e){try{const t="",n=await fetch(`${t}/api/employees/get_employee_details/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),l=await n.json();if(n.ok){const e=l.emp_info;console.log("raw: ",e);const[t,n,s,o,i,c,a,d]=e,r=JSON.parse(c),u=[r[1]/60,(r[2]-r[1])/60],h=l.schedule_conflicts,p=l.ld_conflicts,k={emp_id:t,alias:n,colorId:s,colorName:o,colorCode:i,key_intervals:u,interval_percent:a,last_date:d,scheduleCC:h,lastDateCC:p};return console.log("details: ",k),k}(0,X.A)(l.message),console.log("Failed to fetch employee details, message: ",l.message)}catch(t){console.error("Unexpected Error: ",t)}}var J=n(179),H=n(9049);async function G(e,t,n,l,s,o){try{const i="",c=await fetch(`${i}/api/employees/update_employee_info`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({employee_id:e,alias:t,color_id:n,interval_percent:l,last_date:s,service_ids:o})}),a=await c.json();if(c.ok)return!0;(0,X.A)(a.message),console.log("Failed to update employee information, message: ",a.message)}catch(i){console.error("Unexpected Error: ",i)}}var V=n(1076),z=n(6744),Z=n(445),Y={components:{NA:m.A,FontAwesomeIcon:D.gc,Category:g.A,EditEmpInfo:w,DeleteBtn:R},data(){return{editIcon:T.LFz,cancelIcon:T.cUe,saveIcon:T.e68,isFetched:!1,isEditing:!1,resetCheckers:0,deletable:!1,formattedDate:"",colorName:"",colorCode:null,emp_id:null,categories:[],alias:"",colorId:null,last_date:null,ESs:new Set,intervals:[],intervalPercent:null,lastDateCC:0,scheduleCC:0}},methods:{async fetchData(){this.emp_id=this.$route.params.id;const[e,{categories:t,ES_ids:n}]=await Promise.all([M(this.emp_id),(0,J.A)(this.emp_id)]);e&&(this.categories=t,this.ESs=n,this.alias=e.alias,this.colorId=e.colorId,this.colorName=e.colorName,this.colorCode=e.colorCode,this.last_date=(0,H.A)(e.last_date),e.last_date&&(this.deletable=e.last_date<(0,Z.A)()),this.formattedDate=(0,V.A)(e.last_date),this.intervals=e.key_intervals,this.intervalPercent=e.interval_percent,this.lastDateCC=e.lastDateCC,this.scheduleCC=e.scheduleCC,this.isFetched=!0,this.resetCheckers++)},toConflictPage(){this.$router.push(`/conflicts/employee_ld/${this.emp_id}`)},toScheduleConflictPage(){this.$router.push(`/conflicts/schedule/${this.emp_id}`)},checkService(e){this.ESs.add(e)},uncheckService(e){this.ESs.delete(Number(e)),console.log("ESs",this.ESs)},openEditForm(){this.isEditing=!0},async closeEditForm(){this.isEditing=!1,await this.fetchData()},formattedIntervals(e){const t=e[0],n=e[1];let l="";return l=t!=n?`${t} and ${n}`:`${t}`,l},setAlias(e){this.alias=e},setColorId(e){this.colorId=e},setLastDate(e){this.last_date=e},setIntervalPercent(e){this.intervalPercent=e},async onSubmit(){const e=await G(this.emp_id,this.alias,this.colorId,this.intervalPercent,(0,z.A)(this.last_date),[...this.ESs]);e&&this.$router.push("/employees/refresh")}},async created(){await this.fetchData()}};const ee=(0,A.A)(Y,[["render",k],["__scopeId","data-v-062d3917"]]);var te=ee;const ne={key:0},le={key:0},se={id:"highlight"};function oe(e,t,n,s,o,i){const c=(0,l.g2)("Schedule"),a=(0,l.g2)("AddSchedule");return(0,l.uX)(),(0,l.CE)(l.FK,null,[o.isFetched?((0,l.uX)(),(0,l.CE)("div",ne,[t[2]||(t[2]=(0,l.Lk)("div",{id:"title"},"Schedules:",-1)),o.schedules.length?((0,l.uX)(),(0,l.CE)("div",le,[(0,l.Lk)("div",se,[(0,l.bF)(c,{schedule:o.schedules[0]},null,8,["schedule"])])])):(0,l.Q3)("",!0),(0,l.Lk)("div",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.schedules.slice(1),((e,t)=>((0,l.uX)(),(0,l.Wv)(c,{key:t,schedule:e},null,8,["schedule"])))),128)),t[0]||(t[0]=(0,l.Lk)("br",null,null,-1)),t[1]||(t[1]=(0,l.Lk)("br",null,null,-1))])])):(0,l.Q3)("",!0),(0,l.bF)(a)],64)}const ie={id:"scroll"},ce={colspan:"7"},ae={id:"title"},de={id:"duo"},re={class:"greenBtn"};function ue(e,t,n,s,o,i){const c=(0,l.g2)("FontAwesomeIcon"),a=(0,l.g2)("HoursInputs"),r=(0,l.g2)("DayCheckers");return o.isAdding?((0,l.uX)(),(0,l.CE)("form",{key:1,onSubmit:t[3]||(t[3]=(0,d.D$)(((...e)=>i.onSubmit&&i.onSubmit(...e)),["prevent"]))},[(0,l.Lk)("div",ie,[(0,l.Lk)("table",null,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("td",ce,[(0,l.Lk)("div",ae,[t[5]||(t[5]=(0,l.eW)(" Effective Date: ")),(0,l.bo)((0,l.Lk)("input",{type:"date",id:"datePicker","onUpdate:modelValue":t[1]||(t[1]=e=>o.date=e),required:""},null,512),[[d.Jo,o.date]])])])]),t[6]||(t[6]=(0,l.Lk)("tr",null,[(0,l.Lk)("th"),(0,l.Lk)("th",null,"Mon"),(0,l.Lk)("th",null,"Tue"),(0,l.Lk)("th",null,"Wed"),(0,l.Lk)("th",null,"Thu"),(0,l.Lk)("th",null,"Fri"),(0,l.Lk)("th",null,"Sar"),(0,l.Lk)("th",null,"Sun")],-1))]),(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[t[7]||(t[7]=(0,l.Lk)("td",null,"Open",-1)),(0,l.bF)(a,{times:o.openings,setTime:i.setOpeningTime},null,8,["times","setTime"])]),(0,l.Lk)("tr",null,[t[8]||(t[8]=(0,l.Lk)("td",null,"Close",-1)),(0,l.bF)(a,{times:o.closings,setTime:i.setClosingTime},null,8,["times","setTime"])]),(0,l.Lk)("tr",null,[t[9]||(t[9]=(0,l.Lk)("td",null,null,-1)),(0,l.bF)(r,{checked:o.checked,updateCheck:i.updateCheck},null,8,["checked","updateCheck"])])])])]),t[12]||(t[12]=(0,l.Lk)("br",null,null,-1)),(0,l.Lk)("div",de,[(0,l.Lk)("button",{class:"redBtn",onClick:t[2]||(t[2]=(0,d.D$)(((...e)=>i.closeInput&&i.closeInput(...e)),["prevent"]))},[(0,l.bF)(c,{icon:o.cancelIcon},null,8,["icon"]),t[10]||(t[10]=(0,l.eW)(" Cancel "))]),(0,l.Lk)("button",re,[(0,l.bF)(c,{icon:o.saveIcon},null,8,["icon"]),t[11]||(t[11]=(0,l.eW)(" Add Schedule "))])])],32)):((0,l.uX)(),(0,l.CE)("button",{key:0,class:"blueBtn",onClick:t[0]||(t[0]=(...e)=>i.openInput&&i.openInput(...e))},[(0,l.bF)(c,{icon:o.plusIcon},null,8,["icon"]),t[4]||(t[4]=(0,l.eW)(" Add New Schedule "))]))}const he=["value","disabled"],pe=["value","disabled"],ke=["value","disabled"],me=["value","disabled"],ge=["value","disabled"],ve=["value","disabled"],Le=["value","disabled"];function ye(e,t,n,s,o,i){return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("td",null,[(0,l.Lk)("input",{type:"time",value:n.times[0],onInput:t[0]||(t[0]=e=>i.onInputTime(0,e)),disabled:null==n.times[0]||n.disabled,required:""},null,40,he)]),(0,l.Lk)("td",null,[(0,l.Lk)("input",{type:"time",value:n.times[1],onInput:t[1]||(t[1]=e=>i.onInputTime(1,e)),disabled:null==n.times[1]||n.disabled,required:""},null,40,pe)]),(0,l.Lk)("td",null,[(0,l.Lk)("input",{type:"time",value:n.times[2],onInput:t[2]||(t[2]=e=>i.onInputTime(2,e)),disabled:null==n.times[2]||n.disabled,required:""},null,40,ke)]),(0,l.Lk)("td",null,[(0,l.Lk)("input",{type:"time",value:n.times[3],onInput:t[3]||(t[3]=e=>i.onInputTime(3,e)),disabled:null==n.times[3]||n.disabled,required:""},null,40,me)]),(0,l.Lk)("td",null,[(0,l.Lk)("input",{type:"time",value:n.times[4],onInput:t[4]||(t[4]=e=>i.onInputTime(4,e)),disabled:null==n.times[4]||n.disabled,required:""},null,40,ge)]),(0,l.Lk)("td",null,[(0,l.Lk)("input",{type:"time",value:n.times[5],onInput:t[5]||(t[5]=e=>i.onInputTime(5,e)),disabled:null==n.times[5]||n.disabled,required:""},null,40,ve)]),(0,l.Lk)("td",null,[(0,l.Lk)("input",{type:"time",value:n.times[6],onInput:t[6]||(t[6]=e=>i.onInputTime(6,e)),disabled:null==n.times[6]||n.disabled,required:""},null,40,Le)])],64)}var be={props:{times:Array,setTime:Function,disabled:Boolean},methods:{onInputTime(e,t){this.setTime(e,t.target.value)}}};const Ce=(0,A.A)(be,[["render",ye],["__scopeId","data-v-6776ce0f"]]);var fe=Ce;const Ie={id:"flexBox"},_e=["checked","disabled"],Ee={id:"flexBox"},Se=["checked","disabled"],Ae={id:"flexBox"},Fe=["checked","disabled"],we={id:"flexBox"},De=["checked","disabled"],Te={id:"flexBox"},xe=["checked","disabled"],Xe={id:"flexBox"},We=["checked","disabled"],$e={id:"flexBox"},Be=["checked","disabled"];function Pe(e,t,n,s,o,i){return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("td",null,[(0,l.Lk)("div",Ie,[(0,l.Lk)("input",{type:"checkbox",checked:n.checked[0],onChange:t[0]||(t[0]=e=>i.onCheckDay(0,e)),disabled:n.disabled},null,40,_e)])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",Ee,[(0,l.Lk)("input",{type:"checkbox",checked:n.checked[1],onChange:t[1]||(t[1]=e=>i.onCheckDay(1,e)),disabled:n.disabled},null,40,Se)])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",Ae,[(0,l.Lk)("input",{type:"checkbox",checked:n.checked[2],onChange:t[2]||(t[2]=e=>i.onCheckDay(2,e)),disabled:n.disabled},null,40,Fe)])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",we,[(0,l.Lk)("input",{type:"checkbox",checked:n.checked[3],onChange:t[3]||(t[3]=e=>i.onCheckDay(3,e)),disabled:n.disabled},null,40,De)])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",Te,[(0,l.Lk)("input",{type:"checkbox",checked:n.checked[4],onChange:t[4]||(t[4]=e=>i.onCheckDay(4,e)),disabled:n.disabled},null,40,xe)])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",Xe,[(0,l.Lk)("input",{type:"checkbox",checked:n.checked[5],onChange:t[5]||(t[5]=e=>i.onCheckDay(5,e)),disabled:n.disabled},null,40,We)])]),(0,l.Lk)("td",null,[(0,l.Lk)("div",$e,[(0,l.Lk)("input",{type:"checkbox",checked:n.checked[6],onChange:t[6]||(t[6]=e=>i.onCheckDay(6,e)),disabled:n.disabled},null,40,Be)])])],64)}var Ne={props:{checked:Array,updateCheck:Function,disabled:Boolean},methods:{onCheckDay(e,t){this.updateCheck(e,t.target.checked)}}};const je=(0,A.A)(Ne,[["render",Pe],["__scopeId","data-v-bc2838b2"]]);var Oe=je,Ke=(n(1454),n(4961));async function Ue(e,t,n,l){try{n=n.map((e=>(0,Ke.A)(e))),l=l.map((e=>(0,Ke.A)(e)));const s="",o=await fetch(`${s}/api/employees/add_schedule`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({employee_id:e,effective_from:t,opening_times:n,closing_times:l})}),i=await o.json();if(o.ok)return i.added_schedule_id;(0,X.A)(i.message),console.log("Failed to add schedule, message: ",i.message)}catch(s){console.error("Unexpected Error: ",s)}}var Qe={components:{FontAwesomeIcon:D.gc,HoursInputs:fe,DayCheckers:Oe},data(){return{plusIcon:T.QLR,cancelIcon:T.cUe,saveIcon:T.e68,isAdding:!1,date:null,closings:["14:00","14:00","14:00","14:00","14:00","14:00",null],openings:["14:00","14:00","14:00","14:00","14:00","14:00",null],checked:[!0,!0,!0,!0,!0,!0,!1],empId:this.$route.params.id}},methods:{openInput(){this.isAdding=!0},closeInput(){this.isAdding=!1},setOpeningTime(e,t){this.openings[e]=t},setClosingTime(e,t){this.closings[e]=t},updateCheck(e,t){this.checked[e]=t,t?(this.openings[e]="14:00",this.closings[e]="14:00"):(this.openings[e]=null,this.closings[e]=null)},async onSubmit(){const e=await Ue(this.empId,(0,z.A)(this.date),this.openings,this.closings);e&&this.$router.push("/employees/refresh")}}};const qe=(0,A.A)(Qe,[["render",ue],["__scopeId","data-v-f8d1ad5e"]]);var Re=qe,Me=(n(3949),n(7));async function Je(e){try{const t="",n=await fetch(`${t}/api/employees/get_employee_schedules/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),l=await n.json();if(n.ok){const e=l.schedules;return He(e)}(0,X.A)(l.message),console.log("Failed to fetch employee list, message: ",l.message)}catch(t){console.error("Unexpected Error: ",t)}}function He(e){let t={};e.forEach((e=>{const[n,l,s,o,i]=e;"Monday"===n&&(i<=(0,Z.A)()&&(t={}),t[o]={schedule_id:o,date:i,openings:[],closings:[],checked:[]},t[o].openings=[],t[o].closings=[]),t[o].openings.push((0,Me.A)(l)),t[o].closings.push((0,Me.A)(s)),t[o].checked.push(!(!s||!l))}));const n=Object.values(t).sort(((e,t)=>e.date-t.date));return console.log("sorted: ",n),n}const Ge={id:"scroll"},Ve={colspan:"4"},ze={id:"date"},Ze={colspan:"4"},Ye={id:"edit"},et={key:1},tt={class:"greenBtn",id:"smallBtn"};function nt(e,t,n,s,o,i){const c=(0,l.g2)("FontAwesomeIcon"),r=(0,l.g2)("HoursInputs"),u=(0,l.g2)("DayCheckers");return(0,l.uX)(),(0,l.CE)("form",{onSubmit:t[2]||(t[2]=(0,d.D$)(((...e)=>i.onSubmit&&i.onSubmit(...e)),["prevent"]))},[(0,l.Lk)("div",Ge,[(0,l.Lk)("table",null,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("td",Ve,[(0,l.Lk)("span",ze,"From "+(0,a.v_)(i.formattedDate())+" ~",1)]),(0,l.Lk)("td",Ze,[(0,l.Lk)("div",Ye,[o.isEditing?((0,l.uX)(),(0,l.CE)("div",et,[(0,l.Lk)("button",{class:"redBtn",id:"smallBtn",onClick:t[1]||(t[1]=(0,d.D$)(((...e)=>i.closeEdit&&i.closeEdit(...e)),["prevent"]))},[(0,l.bF)(c,{icon:o.cancelIcon},null,8,["icon"]),t[4]||(t[4]=(0,l.eW)(" Cancel "))]),(0,l.Lk)("button",tt,[(0,l.bF)(c,{icon:o.saveIcon},null,8,["icon"]),t[5]||(t[5]=(0,l.eW)(" Save "))])])):((0,l.uX)(),(0,l.CE)("button",{key:0,class:"blueBtn",id:"smallBtn",onClick:t[0]||(t[0]=(0,d.D$)(((...e)=>i.openEdit&&i.openEdit(...e)),["prevent"]))},[(0,l.bF)(c,{icon:o.editIcon},null,8,["icon"]),t[3]||(t[3]=(0,l.eW)(" Edit "))]))])])]),t[6]||(t[6]=(0,l.Lk)("tr",null,[(0,l.Lk)("th"),(0,l.Lk)("th",null,"Mon"),(0,l.Lk)("th",null,"Tue"),(0,l.Lk)("th",null,"Wed"),(0,l.Lk)("th",null,"Thu"),(0,l.Lk)("th",null,"Fri"),(0,l.Lk)("th",null,"Sar"),(0,l.Lk)("th",null,"Sun")],-1))]),((0,l.uX)(),(0,l.CE)("tbody",{key:o.resetKey},[(0,l.Lk)("tr",null,[t[7]||(t[7]=(0,l.Lk)("td",null,"Open",-1)),(0,l.bF)(r,{times:o.openings,setTime:i.setOpeningTime,disabled:!o.isEditing},null,8,["times","setTime","disabled"])]),(0,l.Lk)("tr",null,[t[8]||(t[8]=(0,l.Lk)("td",null,"Close",-1)),(0,l.bF)(r,{times:o.closings,setTime:i.setClosingTime,disabled:!o.isEditing},null,8,["times","setTime","disabled"])]),(0,l.Lk)("tr",null,[t[9]||(t[9]=(0,l.Lk)("td",null,null,-1)),(0,l.bF)(u,{checked:o.checked,updateCheck:i.updateCheck,disabled:!o.isEditing},null,8,["checked","updateCheck","disabled"])])]))])])],32)}var lt={name:"Schedule-",props:{schedule:Object},components:{FontAwesomeIcon:D.gc,HoursInputs:fe,DayCheckers:Oe},data(){return{editIcon:T.LFz,cancelIcon:T.cUe,saveIcon:T.e68,isEditing:!1,resetKey:0,date:null,closings:[],openings:[],checked:[],empId:this.$route.params.id}},methods:{openEdit(){this.isEditing=!0},closeEdit(){this.fetchStates(),this.resetKey+=1,this.isEditing=!1},formattedDate(){return(0,V.A)(this.date)},setOpeningTime(e,t){this.openings[e]=t},setClosingTime(e,t){this.closings[e]=t},updateCheck(e,t){this.checked[e]=t,t?(this.openings[e]="14:00",this.closings[e]="14:00"):(this.openings[e]=null,this.closings[e]=null)},fetchStates(){this.date=this.schedule.date,this.closings=[...this.schedule.closings],this.openings=[...this.schedule.openings],this.checked=[...this.schedule.checked]},async onSubmit(){const e=await Ue(this.empId,this.date,this.openings,this.closings);e&&this.$router.push("/employees/refresh")}},created(){this.fetchStates()}};const st=(0,A.A)(lt,[["render",nt],["__scopeId","data-v-54b48af6"]]);var ot=st,it={components:{AddSchedule:Re,Schedule:ot},props:{showScheduleWarning:Function},name:"SchedulesParent",data(){return{schedules:[],isFetched:!1}},async created(){const e=this.$route.params.id;this.schedules=await Je(e),this.schedules.length||this.showScheduleWarning(),console.log("schedules: ",this.schedules),this.isFetched=!0}};const ct=(0,A.A)(it,[["render",oe],["__scopeId","data-v-5a903aab"]]);var at=ct,dt={components:{EmployeeInfo:te,Schedule:at},setup(){const e=(0,c.KR)(!1),t=()=>{e.value=!0};return{showScheduleWarning:t,showWarning:e}}};const rt=(0,A.A)(dt,[["render",i],["__scopeId","data-v-942c73e4"]]);var ut=rt},8264:function(e,t,n){n.d(t,{A:function(){return h}});var l=n(6768),s=n(4232);const o={key:0,id:"category"},i={id:"title"},c=["value","checked","disabled"];function a(e,t,n,a,d,r){return n.category.services.length?((0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("div",i,(0,s.v_)(n.category.cate_name),1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.category.services,((e,o)=>((0,l.uX)(),(0,l.CE)("div",{key:o},[(0,l.Lk)("div",null,[(0,l.Lk)("label",null,[(0,l.Lk)("input",{id:"check",type:"checkbox",value:e.service_id,checked:e.employee_id&&!n.uncheckedAll,onChange:t[0]||(t[0]=(...e)=>r.updateChecked&&r.updateChecked(...e)),disabled:!n.isEditing},null,40,c),(0,l.eW)(" "+(0,s.v_)(e.service_name),1)])])])))),128))])):(0,l.Q3)("",!0)}var d={name:"Category-",props:{category:Object,isEditing:Boolean,uncheckedAll:Boolean,checkService:Function,uncheckService:Function},methods:{updateChecked(e){const t=e.target.value;!0===e.target.checked?this.checkService(t):this.uncheckService(t)}}},r=n(1241);const u=(0,r.A)(d,[["render",a],["__scopeId","data-v-7e188470"]]);var h=u}}]);
//# sourceMappingURL=80.4d40bdfd.js.map