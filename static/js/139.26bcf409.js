"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[139],{6744:function(e,t,n){n.d(t,{A:function(){return s}});var o=n(4116),i=n(6156);function s(e){if(console.log("calling"),!e)return null;const t=o.c9.fromISO(e,{zone:(0,i.A)()}),n=t.toSeconds();return console.log("date to unix: ",n),n}},9049:function(e,t,n){n.d(t,{A:function(){return s}});var o=n(4116),i=n(6156);function s(e){if(console.log("calling"),!e)return;const t=o.c9.fromMillis(1e3*e),n=t.setZone((0,i.A)()),s=n.toFormat("yyyy-MM-dd");return s}},1076:function(e,t,n){n.d(t,{A:function(){return s}});var o=n(4116),i=n(6156);function s(e){if(console.log("calling"),!e)return;const t=o.c9.fromMillis(1e3*e).setZone((0,i.A)());return t.toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}},7907:function(e,t,n){n.d(t,{A:function(){return s}});n(4114),n(8992),n(3949);var o=n(445),i=n(8199);async function s(){try{const e="",t=await fetch(`${e}/api/employees/get_employees/${(0,o.A)()}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),n=await t.json();if(t.ok){const e=n.all_employees,t=[];return e.forEach((e=>{const[n,o,i,s,a]=e,l={employee_id:n,alias:o,last_date:i,is_active:s,color:a};t.push(l)})),console.log("emp: ",t),t}(0,i.A)(n.message),console.log("Failed to fetch employee list, message: ",n.message)}catch(e){console.error("Unexpected Error: ",e)}}},1001:function(e,t,n){n.d(t,{A:function(){return i}});n(4114),n(8992),n(3949);var o=n(8199);async function i(){try{const e="",t=await fetch(`${e}/api/services/get_categories`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),n=await t.json();if(t.ok){const e=n.categories,t=[];return e.forEach((e=>{const[n,o]=e,i={cate_id:n,name:o};t.push(i)})),t}(0,o.A)(n.message),console.log("Failed to fetch categories list, message: ",n.message)}catch(e){console.error("Unexpected Error: ",e)}}},4417:function(e,t,n){n.d(t,{A:function(){return c}});var o=n(6768);const i={id:"na"};function s(e,t){return(0,o.uX)(),(0,o.CE)("span",i,"empty")}var a=n(1241);const l={},r=(0,a.A)(l,[["render",s],["__scopeId","data-v-f67a6f6c"]]);var c=r},139:function(e,t,n){n.r(t),n.d(t,{default:function(){return Pe}});var o=n(6768),i=n(4232);const s={id:"parent"};function a(e,t,n,a,l,r){const c=(0,o.g2)("DeleteBtn"),d=(0,o.g2)("ServiceInfo"),u=(0,o.g2)("EmployeeChecker"),p=(0,o.g2)("DurationDemo"),v=(0,o.g2)("NA"),m=(0,o.g2)("ServiceAOSs");return(0,o.uX)(),(0,o.CE)("div",s,[l.deletable?((0,o.uX)(),(0,o.Wv)(c,{key:0,serviceId:l.service_id},null,8,["serviceId"])):(0,o.Q3)("",!0),l.lastDateCC>0?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"warning",onClick:t[0]||(t[0]=(...e)=>r.toConflictPage&&r.toConflictPage(...e))},[(0,o.eW)(" Warning: Availability has "+(0,i.v_)(l.lastDateCC)+" ",1),t[2]||(t[2]=(0,o.Lk)("u",null,"conflicting appointment(s)",-1))])):(0,o.Q3)("",!0),l.durationCC>0?((0,o.uX)(),(0,o.CE)("div",{key:2,class:"warning",onClick:t[1]||(t[1]=(...e)=>r.toDurationConflictPage&&r.toDurationConflictPage(...e))},[(0,o.eW)(" Warning: Duration settings have "+(0,i.v_)(l.durationCC)+" ",1),t[3]||(t[3]=(0,o.Lk)("u",null,"conflicting appointment(s)",-1))])):(0,o.Q3)("",!0),(0,o.bF)(d,{isFetched:l.isFetched,serviceInfo:l.serviceInfo,serviceId:l.service_id},null,8,["isFetched","serviceInfo","serviceId"]),t[4]||(t[4]=(0,o.Lk)("br",null,null,-1)),t[5]||(t[5]=(0,o.Lk)("div",{class:"section"},"Technicians",-1)),(0,o.bF)(u,{serviceId:l.service_id},null,8,["serviceId"]),t[6]||(t[6]=(0,o.Lk)("br",null,null,-1)),t[7]||(t[7]=(0,o.Lk)("div",{class:"section"},"Duration Settings",-1)),l.isFetched?((0,o.uX)(),(0,o.Wv)(p,{key:3,serviceId:l.service_id,duration:l.duration,empDurations:l.empDurations},null,8,["serviceId","duration","empDurations"])):(0,o.Q3)("",!0),t[8]||(t[8]=(0,o.Lk)("br",null,null,-1)),t[9]||(t[9]=(0,o.Lk)("br",null,null,-1)),t[10]||(t[10]=(0,o.Lk)("div",{class:"section"},"Question List",-1)),!l.AOSs.length&&l.isFetched?((0,o.uX)(),(0,o.Wv)(v,{key:4})):(0,o.Q3)("",!0),(0,o.bF)(m,{AOSs:l.AOSs},null,8,["AOSs"]),t[11]||(t[11]=(0,o.Lk)("div",{id:"note"}," *question list can not be edited, recreate the service if you have to change it ",-1))])}n(4114),n(8992),n(3949);var l=n(8199);async function r(e){try{const t="",n=await fetch(`${t}/api/services/get_service_details/${e}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await n.json();if(n.ok)return c(o);(0,l.A)(o.message),console.log("Failed to fetch employee list, message: ",o.message)}catch(t){console.error("Unexpected Error: ",t)}}function c(e){const t=e.info,[n,o,i,s,a,l,r,c,d,u]=t,p=e.durations;let v=[];for(let _ of p){const[e,t,n]=_;v.push({empId:e,alias:t,duration:n})}let m={};const k=e.AOSs;k.forEach((e=>{const[t,n,o,i,s]=e;m[i]||(m[i]={AOS_id:i,prompt:s,options:[]}),m[i].options.push({option_id:t,name:n,length_offset:o})})),m=Object.values(m);const h=e.duration_conflicts,f=e.ld_conflicts;let g={service_id:n,name:o,description:i,first_date:s,last_date:a,cate_id:r,cate_name:c,duration:l,empDurations:v,AOSs:m,durationCC:h,lastDateCC:f,price:d,client_can_book:u};return console.log("detaills: ",g),g}var d=n(1076),u=n(445),p=n(4417);const v={key:0},m={class:"highlight"},k={id:"description"},h={key:0},f=["checked"],g={key:0},_={key:0},y={key:1};function L(e,t,n,s,a,l){const r=(0,o.g2)("NA"),c=(0,o.g2)("FontAwesomeIcon"),d=(0,o.g2)("EditServiceInfo");return a.isEditing?((0,o.uX)(),(0,o.CE)("div",y,[(0,o.bF)(d,{serviceId:n.serviceId,onClose:l.closeEditFrom,_name:n.serviceInfo.name,_description:n.serviceInfo.description,_category:n.serviceInfo.cate_id,_date:n.serviceInfo.last_date,_price:n.serviceInfo.price,_clientCanBook:n.serviceInfo.client_can_book},null,8,["serviceId","onClose","_name","_description","_category","_date","_price","_clientCanBook"])])):((0,o.uX)(),(0,o.CE)("div",v,[(0,o.Lk)("table",null,[(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[1]||(t[1]=(0,o.Lk)("th",null,"Name:",-1)),(0,o.Lk)("td",m,(0,i.v_)(n.serviceInfo.name),1)]),(0,o.Lk)("tr",null,[t[2]||(t[2]=(0,o.Lk)("th",null,"Description:",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",k,(0,i.v_)(n.serviceInfo.description),1),!n.serviceInfo.description&&n.isFetched?((0,o.uX)(),(0,o.Wv)(r,{key:0})):(0,o.Q3)("",!0)])]),(0,o.Lk)("tr",null,[t[3]||(t[3]=(0,o.Lk)("th",null,"Starting Price:",-1)),n.serviceInfo.price?((0,o.uX)(),(0,o.CE)("td",h,"$ "+(0,i.v_)(n.serviceInfo.price),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("tr",null,[t[4]||(t[4]=(0,o.Lk)("th",null,[(0,o.eW)(" Available for "),(0,o.Lk)("br"),(0,o.eW)(" online booking: ")],-1)),(0,o.Lk)("td",null,[(0,o.Lk)("input",{id:"check",type:"checkbox",disabled:"",checked:n.serviceInfo.client_can_book},null,8,f)])]),(0,o.Lk)("tr",null,[t[5]||(t[5]=(0,o.Lk)("th",null,"Starting From:",-1)),(0,o.Lk)("td",null,[n.isFetched?((0,o.uX)(),(0,o.CE)("div",g,(0,i.v_)(l.formatDate(n.serviceInfo.first_date)),1)):((0,o.uX)(),(0,o.Wv)(r,{key:1}))])]),(0,o.Lk)("tr",null,[t[6]||(t[6]=(0,o.Lk)("th",null,"Available Until:",-1)),(0,o.Lk)("td",null,[n.serviceInfo.last_date&&n.isFetched?((0,o.uX)(),(0,o.CE)("div",_,(0,i.v_)(l.formatDate(n.serviceInfo.last_date)),1)):((0,o.uX)(),(0,o.Wv)(r,{key:1}))])]),(0,o.Lk)("tr",null,[t[7]||(t[7]=(0,o.Lk)("th",null,"Category:",-1)),(0,o.Lk)("td",null,[(0,o.eW)((0,i.v_)(n.serviceInfo.cate_name),1),!n.serviceInfo.cate_id&&n.isFetched?((0,o.uX)(),(0,o.Wv)(r,{key:0})):(0,o.Q3)("",!0)])])])]),(0,o.Lk)("button",{class:"blueBtn",onClick:t[0]||(t[0]=(...e)=>l.openEditForm&&l.openEditForm(...e))},[(0,o.bF)(c,{icon:a.editIcon},null,8,["icon"]),t[8]||(t[8]=(0,o.eW)(" Edit Service Details "))])]))}var I=n(8249),b=n(2353),C=n(5130);const E={id:"flexBox"},A={id:"flexBox"},F={id:"flexBox"},D=["checked"],S={id:"flexBox"},w=["value"],X=["value"],B={id:"duo"},x={class:"greenBtn"};function O(e,t,n,s,a,l){const r=(0,o.g2)("FontAwesomeIcon");return(0,o.uX)(),(0,o.CE)("form",{id:"esi",onSubmit:t[7]||(t[7]=(0,C.D$)(((...e)=>l.onSubmit&&l.onSubmit(...e)),["prevent"]))},[(0,o.Lk)("table",null,[t[15]||(t[15]=(0,o.Lk)("colgroup",null,[(0,o.Lk)("col",{style:{width:"auto"}}),(0,o.Lk)("col",{style:{width:"80%"}})],-1)),(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[8]||(t[8]=(0,o.Lk)("th",null,"Name:",-1)),(0,o.Lk)("td",E,[(0,o.bo)((0,o.Lk)("input",{class:"info",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.name=e),required:""},null,512),[[C.Jo,a.name]])])]),(0,o.Lk)("tr",null,[t[9]||(t[9]=(0,o.Lk)("th",null,"Description:",-1)),(0,o.Lk)("td",A,[(0,o.bo)((0,o.Lk)("textarea",{id:"description",type:"text",rows:"3","onUpdate:modelValue":t[1]||(t[1]=e=>a.description=e)},null,512),[[C.Jo,a.description]])])]),(0,o.Lk)("tr",null,[t[10]||(t[10]=(0,o.Lk)("th",null,"Starting Price $:",-1)),(0,o.Lk)("td",F,[(0,o.bo)((0,o.Lk)("input",{class:"info",type:"number",step:"0.01","onUpdate:modelValue":t[2]||(t[2]=e=>a.price=e),min:1},null,512),[[C.Jo,a.price]])])]),(0,o.Lk)("tr",null,[t[11]||(t[11]=(0,o.Lk)("th",null,[(0,o.eW)(" Available for "),(0,o.Lk)("br"),(0,o.eW)(" online booking: ")],-1)),(0,o.Lk)("td",null,[(0,o.bo)((0,o.Lk)("input",{id:"check",type:"checkbox",checked:a.clientCanBook,"onUpdate:modelValue":t[3]||(t[3]=e=>a.clientCanBook=e)},null,8,D),[[C.lH,a.clientCanBook]])])]),(0,o.Lk)("tr",null,[t[12]||(t[12]=(0,o.Lk)("th",null,"Available Until:",-1)),(0,o.Lk)("td",null,[(0,o.bo)((0,o.Lk)("input",{id:"date",type:"date","onUpdate:modelValue":t[4]||(t[4]=e=>a.date=e)},null,512),[[C.Jo,a.date]])])]),(0,o.Lk)("tr",null,[t[14]||(t[14]=(0,o.Lk)("th",null,"Category:",-1)),(0,o.Lk)("td",S,[(0,o.Lk)("select",{value:a.categoryId,onChange:t[5]||(t[5]=(...e)=>l.setCategory&&l.setCategory(...e)),required:""},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.categories,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.cate_id,value:e.cate_id},(0,i.v_)(e.name),9,X)))),128)),t[13]||(t[13]=(0,o.Lk)("option",{value:"null"},"none",-1))],40,w)])])])]),(0,o.Lk)("div",B,[(0,o.Lk)("button",{class:"redBtn",onClick:t[6]||(t[6]=(0,C.D$)(((...e)=>n.onClose&&n.onClose(...e)),["prevent"]))},[(0,o.bF)(r,{icon:a.cancelIcon},null,8,["icon"]),t[16]||(t[16]=(0,o.eW)(" Cancel "))]),(0,o.Lk)("button",x,[(0,o.bF)(r,{icon:a.saveIcon},null,8,["icon"]),t[17]||(t[17]=(0,o.eW)(" Save Changes "))])])],32)}var $=n(9049),T=n(6744);async function W(e,t,n,o,i,s,a){try{const r="",c=await fetch(`${r}/api/services/update_service_info`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_id:e,name:t,description:n,category_id:o,last_date:i,price:s,client_can_book:a})}),d=await c.json();if(c.ok)return!0;(0,l.A)(d.message),console.log("Failed to update service information, message: ",d.message)}catch(r){console.error("Unexpected Error: ",r)}}var N=n(1001),U={props:{onClose:Function,serviceId:Number,_name:String,_description:String,_category:Number,_date:Number,_price:String,_clientCanBook:Number},components:{FontAwesomeIcon:I.gc},data(){return{editIcon:b.LFz,cancelIcon:b.cUe,saveIcon:b.e68,name:"",description:"",date:null,categoryId:null,price:null,clientCanBook:!0,categories:[]}},methods:{setCategory(e){this.categoryId=e.target.value},async onSubmit(){"null"==this.categoryId&&(this.categoryId=null);const e=await W(this.serviceId,this.name,this.description,this.categoryId,(0,T.A)(this.date),this.price,this.clientCanBook);e&&this.$router.push("/services/refresh")}},async created(){this.categories=await(0,N.A)(),this.name=this._name,this.description=this._description,this.price=this._price,this.clientCanBook=this._clientCanBook,this.categoryId=this._category??"null",this.date=this._date?(0,$.A)(this._date):null}},j=n(1241);const K=(0,j.A)(U,[["render",O],["__scopeId","data-v-ed209850"]]);var R=K,P={props:{serviceInfo:Object,isFetched:Boolean,serviceId:Number},components:{NA:p.A,FontAwesomeIcon:I.gc,EditServiceInfo:R},data(){return{editIcon:b.LFz,cancelIcon:b.cUe,saveIcon:b.e68,isEditing:!1}},methods:{formatDate(e){return(0,d.A)(e)},openEditForm(){this.isEditing=!0},closeEditFrom(){this.isEditing=!1}}};const Q=(0,j.A)(P,[["render",L],["__scopeId","data-v-1339e1de"]]);var J=Q;const M={id:"title"},V={border:"1"};function q(e,t,n,s,a,l){return(0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.AOSs,((e,n)=>((0,o.uX)(),(0,o.CE)("div",{key:n},[(0,o.Lk)("div",M,(0,i.v_)(n+1)+". "+(0,i.v_)(e.prompt),1),(0,o.Lk)("table",V,[t[0]||(t[0]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Answer"),(0,o.Lk)("th",null,[(0,o.eW)("Length Increase (minutes) "),(0,o.Lk)("br")])])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.options,((e,t)=>((0,o.uX)(),(0,o.CE)("tr",{key:t},[(0,o.Lk)("td",null,(0,i.v_)(e.name),1),(0,o.Lk)("td",null,(0,i.v_)(e.length_offset/60),1)])))),128))])])])))),128)}var z={props:{AOSs:Object}};const G=(0,j.A)(z,[["render",q],["__scopeId","data-v-6aa3389d"]]);var H=G;const Z=["value","disabled"],Y={key:1,id:"duo"},ee={class:"greenBtn"};function te(e,t,n,s,a,l){const r=(0,o.g2)("FontAwesomeIcon");return(0,o.uX)(),(0,o.CE)("form",{onSubmit:t[3]||(t[3]=(0,C.D$)(((...e)=>l.onSubmit&&l.onSubmit(...e)),["prevent"]))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.employees,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.employee_id},[(0,o.Lk)("label",null,[(0,o.bo)((0,o.Lk)("input",{id:"check",type:"checkbox",value:e.employee_id,disabled:!a.isEditing,"onUpdate:modelValue":t[0]||(t[0]=e=>a.checked=e)},null,8,Z),[[C.lH,a.checked]]),(0,o.eW)(" "+(0,i.v_)(e.alias),1)])])))),128)),a.isEditing?((0,o.uX)(),(0,o.CE)("div",Y,[(0,o.Lk)("button",{class:"redBtn",onClick:t[2]||(t[2]=(0,C.D$)(((...e)=>l.closeEditMode&&l.closeEditMode(...e)),["prevent"]))},[(0,o.bF)(r,{icon:a.cancelIcon},null,8,["icon"]),t[5]||(t[5]=(0,o.eW)(" Cancel "))]),(0,o.Lk)("button",ee,[(0,o.bF)(r,{icon:a.saveIcon},null,8,["icon"]),t[6]||(t[6]=(0,o.eW)(" Save Changes "))])])):((0,o.uX)(),(0,o.CE)("button",{key:0,class:"blueBtn",onClick:t[1]||(t[1]=(...e)=>l.openEditMode&&l.openEditMode(...e))},[(0,o.bF)(r,{icon:a.editIcon},null,8,["icon"]),t[4]||(t[4]=(0,o.eW)(" Edit Technicians "))]))],32)}async function ne(e,t=(0,u.A)()){try{const n="",o=await fetch(`${n}/api/services/get_service_employees/${e}/${t}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),i=await o.json();if(o.ok){const e=i.employees,t=[];return e.forEach((e=>{const[n,o,i,s]=e,a={employee_id:n,alias:o,service_id:s,last_date:i};t.push(a)})),t}(0,l.A)(i.message),console.log("Failed to fetch service's employees, message: ",i.message)}catch(n){console.error("Unexpected Error: ",n)}}async function oe(e,t){try{console.log(t);const n="",o=await fetch(`${n}/api/services/update_service_employees`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_id:e,employee_ids:t})});if(o.ok)return!0;const i=await o.json();(0,l.A)(i.message),console.log("Failed to update technicians, message: ",i.message)}catch(n){console.error("Unexpected Error: ",n)}}var ie={props:{serviceId:Number},components:{FontAwesomeIcon:I.gc},data(){return{editIcon:b.LFz,cancelIcon:b.cUe,saveIcon:b.e68,isEditing:!1,employees:[],checked:[]}},methods:{openEditMode(){this.isEditing=!0},async closeEditMode(){this.isEditing=!1,await this.fetchData()},async onSubmit(){const e=await oe(this.serviceId,this.checked);e&&this.$router.push("/services/refresh")},async fetchData(){this.employees=await ne(this.serviceId),this.employees.forEach((e=>{e.service_id&&this.checked.push(e.employee_id)}))}},async created(){await this.fetchData()}};const se=(0,j.A)(ie,[["render",te],["__scopeId","data-v-781827d6"]]);var ae=se;const le={key:0},re={border:"1"};function ce(e,t,n,s,a,l){const r=(0,o.g2)("DurationsEdit"),c=(0,o.g2)("FontAwesomeIcon");return(0,o.uX)(),(0,o.CE)(o.FK,null,[a.isEditing?((0,o.uX)(),(0,o.Wv)(r,{key:1,serviceId:n.serviceId,duration:n.duration,empDurations:n.empDurations,onToogleEdit:l.onToogleEdit},null,8,["serviceId","duration","empDurations","onToogleEdit"])):((0,o.uX)(),(0,o.CE)("div",le,[(0,o.Lk)("table",re,[t[1]||(t[1]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Employee"),(0,o.Lk)("th",null,"Duration (minutes)")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.rows,((e,t)=>((0,o.uX)(),(0,o.CE)("tr",{key:t},[(0,o.Lk)("td",null,(0,i.v_)(e.name),1),(0,o.Lk)("td",null,(0,i.v_)(e.duration/60),1)])))),128))])])])),a.isEditing?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:2,class:"blueBtn",onClick:t[0]||(t[0]=(0,C.D$)(((...e)=>l.onToogleEdit&&l.onToogleEdit(...e)),["prevent"]))},[(0,o.bF)(c,{icon:a.editIcon},null,8,["icon"]),t[2]||(t[2]=(0,o.eW)(" Edit Durations "))]))],64)}const de={border:"1"},ue={id:"flexBox"},pe=["value"],ve={id:"flexBox"},me=["value","onInput"],ke={colspan:"2"},he=["value"],fe={id:"duo"};function ge(e,t,n,s,a,l){return(0,o.uX)(),(0,o.CE)("form",{onSubmit:t[4]||(t[4]=(0,C.D$)(((...e)=>s.onSubmit&&s.onSubmit(...e)),["prevent"]))},[(0,o.Lk)("table",de,[t[7]||(t[7]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"Employee"),(0,o.Lk)("th",null,"Duration (minutes)")])],-1)),(0,o.Lk)("tbody",null,[(0,o.Lk)("tr",null,[t[5]||(t[5]=(0,o.Lk)("td",null,"ALL",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("div",ue,[(0,o.Lk)("input",{type:"number",value:n.duration/60,onInput:t[0]||(t[0]=e=>s.onInputDuration(0,e)),required:"",min:"5",step:"1"},null,40,pe)])])]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.rows.slice(1),((e,t)=>((0,o.uX)(),(0,o.CE)("tr",{key:t},[(0,o.Lk)("td",null,(0,i.v_)(e.name),1),(0,o.Lk)("td",null,[(0,o.Lk)("div",ve,[(0,o.Lk)("input",{type:"number",value:e.duration/60,onInput:e=>s.onInputDuration(t+1,e),required:"",min:"5",step:"1"},null,40,me)])])])))),128)),(0,o.Lk)("tr",null,[(0,o.Lk)("td",ke,[(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,C.D$)(((...e)=>s.onAddRow&&s.onAddRow(...e)),["prevent"]))},[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.seEmp=e),required:""},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.employees,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.employee_id,value:{empId:e.employee_id,alias:e.alias}},(0,i.v_)(e.alias),9,he)))),128))],512),[[C.u1,s.seEmp]]),t[6]||(t[6]=(0,o.Lk)("button",{class:"orangeBtn",id:"smallBtn"},"Add",-1))],32)])])])]),(0,o.Lk)("div",fe,[(0,o.Lk)("button",{class:"redBtn",onClick:t[3]||(t[3]=(0,C.D$)(((...e)=>n.onToogleEdit&&n.onToogleEdit(...e)),["prevent"]))},"Cancel"),t[8]||(t[8]=(0,o.Lk)("button",{class:"greenBtn",type:"submit"},"Save",-1))])],32)}var _e=n(144),ye=n(7907);async function Le(e,t){try{let n=0,o=[];n=t[0].duration;for(let e of t.slice(1)){const{empId:t,duration:n}=e;o.push(t),o.push(n)}console.log("durations",t);const i="",s=await fetch(`${i}/api/services/update_durations`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_id:e,default_duration:n,durations:o})}),a=await s.json();if(s.ok)return!0;(0,l.A)(a.message),console.log("Failed to update durations, message: ",a.message)}catch(n){console.error("Unexpected Error: ",n)}}var Ie=n(1387),be={props:{serviceId:Number,duration:Number,onToogleEdit:Function,empDurations:Array},setup(e){const t=(0,Ie.rd)(),n=(0,_e.KR)([]),i=(0,_e.KR)(null),s=(0,_e.KR)([]),a=(e,t)=>{const o=60*t.target.value;n.value[e].duration=o},l=()=>{for(let e of n.value)if(e.empId===i.value.empId)return;n.value.push({empId:i.value.empId,name:i.value.alias,duration:null})},r=async()=>{const o=await Le(e.serviceId,n.value);o&&t.push("/services/refresh")};return(0,o.sV)((async()=>{n.value.push({name:"ALL",duration:e.duration});for(let t of e.empDurations)n.value.push({empId:t.empId,name:t.alias,duration:t.duration});s.value=await(0,ye.A)(),console.log("employees",s.value)})),{rows:n,seEmp:i,employees:s,onInputDuration:a,onAddRow:l,onSubmit:r}}};const Ce=(0,j.A)(be,[["render",ge],["__scopeId","data-v-2819cfdd"]]);var Ee=Ce,Ae={props:{duration:Number,empDurations:Array,serviceId:Number},components:{FontAwesomeIcon:I.gc,DurationsEdit:Ee},data(){return{editIcon:b.LFz,rows:[],isEditing:!1}},methods:{onToogleEdit(){this.isEditing=!this.isEditing}},created(){this.rows.push({name:"ALL",duration:this.duration});for(let e of this.empDurations)this.rows.push({id:e.empId,name:e.alias,duration:e.duration})}};const Fe=(0,j.A)(Ae,[["render",ce],["__scopeId","data-v-6dd383da"]]);var De=Fe;async function Se(e){try{const t="",n=await fetch(`${t}/api/services/delete_service`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({service_id:e})});if(n.ok)return!0;{const e=await n.json();(0,l.A)(e.message),console.log("Failed to delete service, message: ",e.message)}}catch(t){console.error("Unexpected Error: ",t)}}const we={id:"parent"},Xe={id:"window"},Be={id:"content"},xe={};var Oe=Object.assign(xe,{__name:"ConfirmDelete",props:{onClose:Function,serviceId:Number},setup(e){const t=e,n=(0,Ie.rd)(),i=(0,_e.KR)(""),s=(0,_e.KR)(null),a=async()=>{if("yes"===i.value.trim().toLowerCase()){const e=await Se(t.serviceId);t.onClose(),e&&n.push("/services")}};return(e,n)=>((0,o.uX)(),(0,o.CE)("div",we,[(0,o.Lk)("div",{id:"background",onClick:n[0]||(n[0]=e=>t.onClose())}),(0,o.Lk)("div",Xe,[(0,o.Lk)("button",{onClick:n[1]||(n[1]=e=>t.onClose()),id:"closeBtn",class:"redBtn"},[(0,o.bF)((0,_e.R1)(I.gc),{icon:(0,_e.R1)(b.Jyw)},null,8,["icon"])]),(0,o.Lk)("div",Be,[n[3]||(n[3]=(0,o.Lk)("div",null,"Permanently delete this service?",-1)),n[4]||(n[4]=(0,o.Lk)("label",null,'Type "yes" to confirm ',-1)),(0,o.bo)((0,o.Lk)("input",{ref_key:"inputRef",ref:s,type:"text","onUpdate:modelValue":n[2]||(n[2]=e=>i.value=e),onInput:a,placeholder:"yes"},null,544),[[C.Jo,i.value]])])])]))}});const $e=(0,j.A)(Oe,[["__scopeId","data-v-7aae9def"]]);var Te=$e;const We={class:"flex"};var Ne={__name:"DeleteBtn",props:{serviceId:Number},setup(e){const t=e,n=(0,_e.KR)(!1);function i(){n.value=!0}return(e,s)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",We,[(0,o.Lk)("button",{id:"delete",class:"redBtn",onClick:i},[(0,o.bF)((0,_e.R1)(I.gc),{icon:(0,_e.R1)(b.yLS)},null,8,["icon"]),s[0]||(s[0]=(0,o.eW)(" Delete Employee "))])]),n.value?((0,o.uX)(),(0,o.Wv)(Te,{key:0,serviceId:t.serviceId,onClose:()=>n.value=!1},null,8,["serviceId","onClose"])):(0,o.Q3)("",!0)],64))}};const Ue=(0,j.A)(Ne,[["__scopeId","data-v-699e3abe"]]);var je=Ue,Ke={components:{NA:p.A,ServiceInfo:J,ServiceAOSs:H,EmployeeChecker:ae,DurationDemo:De,DeleteBtn:je},data(){return{deletable:!1,service_id:null,AOSs:[],serviceInfo:{},duration:null,empDurations:[],isFetched:!1,isAddingLength:!1,durationCC:0,lastDateCC:0}},methods:{formatDate(e){return(0,d.A)(e)},toConflictPage(){this.$router.push(`/conflicts/service_ld/${this.service_id}`)},toDurationConflictPage(){this.$router.push(`/conflicts/service_duration/${this.service_id}`)}},async created(){this.service_id=Number(this.$route.params.id);const e=await r(this.service_id);e&&(this.serviceInfo={service_id:e.service_id,name:e.name,description:e.description,first_date:e.first_date,last_date:e.last_date,cate_name:e.cate_name,cate_id:e.cate_id,price:e.price,client_can_book:e.client_can_book},e.last_date&&(this.deletable=e.last_date<(0,u.A)()),this.AOSs=e.AOSs,console.log("AOSs: ",this.AOSs),this.duration=e.duration,this.empDurations=e.empDurations,this.durationCC=e.durationCC,this.lastDateCC=e.lastDateCC,this.isFetched=!0)}};const Re=(0,j.A)(Ke,[["render",a],["__scopeId","data-v-37449d13"]]);var Pe=Re}}]);
//# sourceMappingURL=139.26bcf409.js.map