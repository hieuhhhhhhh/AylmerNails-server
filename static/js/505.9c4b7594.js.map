{"version":3,"file":"js/505.9c4b7594.js","mappings":"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","sources":["webpack://frontend/./src/views/book_now/comps/welcome_modal/apis/logIn.js","webpack://frontend/./src/views/authentication/apis/requestSignUp.js","webpack://frontend/./src/views/authentication/sign_up/Credentials.vue","webpack://frontend/./src/views/authentication/sign_up/Credentials.vue?f35f","webpack://frontend/./src/views/authentication/apis/signUp.js","webpack://frontend/./src/views/authentication/sign_up/OTPverify.vue","webpack://frontend/./src/views/authentication/sign_up/OTPverify.vue?b4b8","webpack://frontend/./src/views/authentication/sign_up/SignUp.vue","webpack://frontend/./src/views/authentication/sign_up/SignUp.vue?7183"],"sourcesContent":["import { useMyProfile } from \"@/stores/myProfile\";\r\nimport { parsePhoneNumberFromString } from \"libphonenumber-js\";\r\n\r\nexport default async function logIn(phoneNum, password, rememberMe) {\r\n  try {\r\n    try {\r\n      // parse phone number to E.164\r\n      phoneNum = parsePhoneNumberFromString(phoneNum, \"CA\").number; // E.164 format\r\n      console.log(\"phoneNum: \", phoneNum);\r\n    } catch (e) {\r\n      return { message: \"Invalid phone number\" };\r\n    }\r\n\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(`${baseURL}/api/authentication/log_in`, {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        phone_num: phoneNum,\r\n        password,\r\n        remember_me: rememberMe,\r\n      }),\r\n    });\r\n\r\n    // fetch json\r\n    const json = await res.json();\r\n\r\n    // read status and process response\r\n    if (res.ok) {\r\n      // update pinia states\r\n      const store = useMyProfile();\r\n\r\n      store.setMyProfile({\r\n        token: json.token,\r\n        role: json.user_role,\r\n      });\r\n\r\n      return true;\r\n    } else {\r\n      console.log(\"Failed to log in, message: \", json.message);\r\n      return { message: json.message };\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n    return { message: \"Unexpected Error\" };\r\n  }\r\n}\r\n","import { parsePhoneNumberFromString } from \"libphonenumber-js\";\r\n\r\nexport default async function requestSignUp(phoneNum, firstName, lastName) {\r\n  try {\r\n    try {\r\n      // parse phone number to E.164\r\n      phoneNum = parsePhoneNumberFromString(phoneNum, \"CA\").number; // E.164 format\r\n    } catch (e) {\r\n      return { message: \"Invalid phone number\" };\r\n    }\r\n\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(`${baseURL}/api/authentication/request_sign_up`, {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        phone_num: phoneNum,\r\n        first_name: firstName,\r\n        last_name: lastName,\r\n      }),\r\n    });\r\n\r\n    // fetch json return message\r\n    const json = await res.json();\r\n    const codeId = json.code_id;\r\n    const message = json.message;\r\n    const waitTime = json.wait_time;\r\n\r\n    // return results\r\n    return { codeId, message, waitTime };\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n    return { message: \"Unexpected Error\" };\r\n  }\r\n}\r\n","<template>\r\n  <form @submit.prevent=\"onSubmit\">\r\n    <div>\r\n      <input\r\n        type=\"text\"\r\n        v-model=\"firstName\"\r\n        placeholder=\"First Name\"\r\n        required\r\n      />\r\n      <input type=\"text\" v-model=\"lastName\" placeholder=\"Last Name\" required />\r\n    </div>\r\n    <div>\r\n      <input\r\n        type=\"tel\"\r\n        v-model=\"phoneNum\"\r\n        placeholder=\"Phone Number\"\r\n        required\r\n      />\r\n    </div>\r\n    <div>\r\n      <input\r\n        type=\"password\"\r\n        v-model=\"password\"\r\n        placeholder=\"New Password\"\r\n        minlength=\"6\"\r\n        required\r\n      />\r\n    </div>\r\n    <div id=\"msg\">{{ msg }}</div>\r\n    <button class=\"greenBtn\">Sign up</button>\r\n    <div>\r\n      <router-link to=\"/login\">I already have an account</router-link>\r\n    </div>\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\n// apis\r\nimport requestSignUp from \"../apis/requestSignUp\";\r\n\r\n// PROPS\r\nconst props = defineProps({\r\n  onNext: Function,\r\n});\r\n\r\n// PAYLOAD\r\nconst phoneNum = ref(\"\");\r\nconst password = ref(\"\");\r\nconst firstName = ref(\"\");\r\nconst lastName = ref(\"\");\r\n\r\n// OUTPUT\r\nconst msg = ref(\"\");\r\n\r\n// APIS\r\nasync function onSubmit() {\r\n  const { codeId, message, waitTime } = await requestSignUp(\r\n    phoneNum.value,\r\n    firstName.value,\r\n    lastName.value\r\n  );\r\n\r\n  //   if fail\r\n  if (!codeId) {\r\n    msg.value = message;\r\n    return;\r\n  }\r\n\r\n  // if succesful\r\n  props.onNext(\r\n    codeId,\r\n    phoneNum.value,\r\n    password.value,\r\n    firstName.value,\r\n    lastName.value,\r\n    waitTime\r\n  );\r\n}\r\n</script>\r\n\r\n\r\n<script>\r\nexport default { name: \"Credentials-\" };\r\n</script>\r\n\r\n<style scoped>\r\nform {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\na {\r\n  font-size: 15px;\r\n  text-decoration: none;\r\n  color: rgb(0, 153, 255);\r\n}\r\n\r\na:hover,\r\na:active {\r\n  text-decoration: underline;\r\n}\r\nbutton {\r\n  font-size: 20px;\r\n  padding-inline: 50px;\r\n  border-radius: 20px;\r\n  margin-bottom: 50px;\r\n}\r\n\r\ninput {\r\n  padding: 6px 10px;\r\n  width: 280px;\r\n}\r\n\r\ninput[type=\"text\"] {\r\n  width: 123px;\r\n  margin-inline: 5px;\r\n  /* margin-bottom: 10px; */\r\n}\r\n#msg {\r\n  color: red;\r\n  font-size: 15px;\r\n}\r\n</style>","import script from \"./Credentials.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Credentials.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Credentials.vue?vue&type=style&index=0&id=319faed9&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-319faed9\"]])\n\nexport default __exports__","import logIn from \"@/views/book_now/comps/welcome_modal/apis/logIn\";\r\n\r\nexport default async function signUp(\r\n  codeId,\r\n  code,\r\n  phoneNum,\r\n  password,\r\n  firstName,\r\n  lastName\r\n) {\r\n  try {\r\n    // get app path\r\n    const baseURL = process.env.VUE_APP_BASE_URL;\r\n\r\n    // start requesting server\r\n    const res = await fetch(`${baseURL}/api/authentication/sign_up`, {\r\n      method: \"POST\",\r\n      credentials: \"include\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        code_id: codeId,\r\n        code,\r\n        password,\r\n        first_name: firstName,\r\n        last_name: lastName,\r\n      }),\r\n    });\r\n\r\n    // read status and process response\r\n    if (res.ok) {\r\n      // if sign up succesful, log in\r\n      await logIn(phoneNum, password);\r\n    } else {\r\n      // fetch json\r\n      const json = await res.json();\r\n      console.log(\"Failed to sign up, message: \", json.message);\r\n\r\n      // return the message upon failure\r\n      return json.message;\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Unexpected Error: \", e);\r\n    return e.message;\r\n  }\r\n}\r\n","<template>\r\n  <form @submit.prevent=\"onSubmit\">\r\n    <div>Please enter the one time code sent to {{ phoneNum }} by text</div>\r\n    <div>\r\n      <input type=\"text\" v-model=\"code\" placeholder=\"Verification Code\" />\r\n    </div>\r\n    <div id=\"msg\">{{ msg }}</div>\r\n    <button class=\"greenBtn\">Verify</button>\r\n    <a v-if=\"wait > 0\" class=\"disabled\"> Resend Code (Wait {{ wait }}s)</a>\r\n    <a v-else @click=\"onResend\"> Resend Code </a>\r\n  </form>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, onUnmounted, ref } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\n// apis\r\nimport signUp from \"../apis/signUp\";\r\nimport requestSignUp from \"../apis/requestSignUp\";\r\n\r\n// params\r\nconst props = defineProps({\r\n  codeId: Number,\r\n  phoneNum: String,\r\n  password: String,\r\n  firstName: String,\r\n  lastName: String,\r\n  waitTime: Number,\r\n});\r\n\r\n// payload\r\nconst codeId = ref(props.codeId);\r\nconst code = ref(\"\");\r\nconst msg = ref(\"\");\r\nconst router = useRouter();\r\nconst wait = ref(props.waitTime);\r\n\r\n// APIS\r\nasync function onSubmit() {\r\n  const message = await signUp(\r\n    codeId.value,\r\n    code.value,\r\n    props.phoneNum,\r\n    props.password,\r\n    props.firstName,\r\n    props.lastName\r\n  );\r\n\r\n  //   if fail\r\n  if (message) {\r\n    msg.value = message;\r\n    code.value = \"\";\r\n    return;\r\n  }\r\n\r\n  // if succesful\r\n  router.push(\"/\");\r\n}\r\n\r\nasync function onResend() {\r\n  const {\r\n    codeId: _codeId,\r\n    message,\r\n    waitTime,\r\n  } = await requestSignUp(props.phoneNum, props.firstName, props.lastName);\r\n  console.log(_codeId);\r\n\r\n  //   if fail\r\n  if (!_codeId) {\r\n    msg.value = message;\r\n    return;\r\n  }\r\n\r\n  codeId.value = _codeId;\r\n  wait.value = waitTime;\r\n}\r\n\r\n// LIFECYCLE\r\nlet interval;\r\n\r\nonMounted(() => {\r\n  interval = setInterval(() => {\r\n    wait.value--;\r\n  }, 1000); // count down every 1 second\r\n});\r\n\r\nonUnmounted(() => {\r\n  clearInterval(interval);\r\n});\r\n</script>\r\n\r\n<style scoped>\r\nform {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\nbutton {\r\n  font-size: 20px;\r\n  padding-inline: 50px;\r\n  border-radius: 20px;\r\n  margin-bottom: 50px;\r\n}\r\ninput {\r\n  padding: 6px 10px;\r\n  width: 250px;\r\n}\r\na {\r\n  font-size: 15px;\r\n  text-decoration: none;\r\n  color: rgb(0, 153, 255);\r\n  cursor: pointer;\r\n}\r\n\r\na:hover,\r\na:active {\r\n  text-decoration: underline;\r\n}\r\n\r\n.disabled {\r\n  color: gray;\r\n  pointer-events: none;\r\n}\r\n#msg {\r\n  color: red;\r\n  font-size: 15px;\r\n}\r\n</style>","import script from \"./OTPverify.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./OTPverify.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./OTPverify.vue?vue&type=style&index=0&id=bc92058e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bc92058e\"]])\n\nexport default __exports__","<template>\r\n  <div id=\"layout\">\r\n    <div id=\"title\">Create new account</div>\r\n    <div v-if=\"page === 1\"><Credentials :onNext=\"onRequestCode\" /></div>\r\n    <div v-if=\"page === 2\">\r\n      <OTPverify\r\n        :codeId=\"codeId\"\r\n        :phoneNum=\"phoneNum\"\r\n        :password=\"password\"\r\n        :firstName=\"firstName\"\r\n        :lastName=\"lastName\"\r\n        :waitTime=\"waitTime\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\n// comps\r\nimport Credentials from \"./Credentials.vue\";\r\nimport OTPverify from \"./OTPverify.vue\";\r\n\r\n// RESOURCES\r\nconst page = ref(1);\r\n// PAYLOAD\r\nconst codeId = ref();\r\nconst phoneNum = ref(\"\");\r\nconst password = ref(\"\");\r\nconst firstName = ref(\"\");\r\nconst lastName = ref(\"\");\r\nconst waitTime = ref(0);\r\n\r\n// HANDLERS\r\nfunction onRequestCode(\r\n  _codeId,\r\n  _phoneNum,\r\n  _password,\r\n  _firstName,\r\n  _lastName,\r\n  _waitTime\r\n) {\r\n  codeId.value = _codeId;\r\n  phoneNum.value = _phoneNum;\r\n  password.value = _password;\r\n  firstName.value = _firstName;\r\n  lastName.value = _lastName;\r\n  waitTime.value = _waitTime;\r\n  // to next page\r\n  page.value++;\r\n}\r\n</script>\r\n\r\n<script>\r\nexport default {};\r\n</script>\r\n\r\n<style scoped>\r\n#layout {\r\n  background-color: var(--background-i1);\r\n  padding: 10px;\r\n  width: 900px;\r\n  max-width: 100vw;\r\n  margin-inline: auto;\r\n  flex-grow: 1;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n}\r\n#title {\r\n  text-align: center;\r\n  margin: 10px;\r\n  font-size: 25px;\r\n  margin-bottom: 20px;\r\n}\r\n</style>","import script from \"./SignUp.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SignUp.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./SignUp.vue?vue&type=style&index=0&id=ca12e8fc&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ca12e8fc\"]])\n\nexport default __exports__"],"names":["async","logIn","phoneNum","password","rememberMe","parsePhoneNumberFromString","number","console","log","e","message","baseURL","process","res","fetch","method","credentials","headers","body","JSON","stringify","phone_num","remember_me","json","ok","store","useMyProfile","setMyProfile","token","role","user_role","error","requestSignUp","firstName","lastName","first_name","last_name","codeId","code_id","waitTime","wait_time","__default__","name","props","__props","ref","msg","onSubmit","value","onNext","__exports__","signUp","code","router","useRouter","wait","push","onResend","_codeId","interval","onMounted","setInterval","onUnmounted","clearInterval","page","onRequestCode","_phoneNum","_password","_firstName","_lastName","_waitTime"],"sourceRoot":""}